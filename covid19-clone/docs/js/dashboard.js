const t="https://raw.githubusercontent.com/cagov/covid-static/staging/data/infections-by-group/infections-by-group-california.json",e="https://raw.githubusercontent.com/cagov/covid-static-data/CovidStateDashboardTables_Staging/data/dashboard/",i="https://raw.githubusercontent.com/cagov/covid-static-data/CovidStateDashboardPostvax_Staging/data/dashboard/";class a{constructor(t){let e={label:"Unknown data",value:"Unknown data"};"string"==typeof t?e={label:t,value:t}:Array.isArray(t)?e={label:t[0],value:t[1]}:"object"==typeof t&&("label"in t||"value"in t)&&(e=t),this.label=e.label||e.value,this.value=e.value,"userData"in e&&(this.userData=e.userData)}get length(){return this.label.length}toString(){return`${this.label}`}valueOf(){return this.toString()}}class s{constructor(t,e){s.all=[];const i=this;s.count=(s.count||0)+1,this.count=s.count,this.isOpened=!1,this.input=s.query(t),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-owns",`awesomplete_list_${this.count}`),this.input.setAttribute("role","combobox"),this.options=e||{},this.configure({minChars:2,maxItems:10,autoFirst:!1,data:s.DATA,filter:s.FILTER_CONTAINS,sort:!1!==e.sort&&s.SORT_BYLENGTH,container:s.CONTAINER,item:s.ITEM,replace:s.REPLACE,tabSelect:!1},e),this.index=-1,this.container=this.container(t),this.ul=s.create("ul",{hidden:"hidden",role:"listbox",id:`awesomplete_list_${this.count}`,inside:this.container}),this.status=s.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-atomic":!0,inside:this.container,textContent:0!==this.minChars?`Type ${this.minChars} or more characters for results.`:"Begin typing for results."}),this.events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown(t){const e=t.keyCode;i.opened&&(13===e&&i.selected?(t.preventDefault(),t.stopImmediatePropagation(),i.select()):9===e&&i.selected&&i.tabSelect?i.select():27===e?i.close({reason:"esc"}):38!==e&&40!==e||(t.preventDefault(),i[38===e?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown(t){t.preventDefault()},click(t){let e=t.target;if(e!==this){for(;e&&!/li/i.test(e.nodeName);)e=e.parentNode;e&&0===t.button&&(t.preventDefault(),i.select(e,t.target))}}}},s.bind(this.input,this.events.input),s.bind(this.input.form,this.events.form),s.bind(this.ul,this.events.ul),this.input.hasAttribute("list")?(this.list=`#${this.input.getAttribute("list")}`,this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||e.list||[],s.all.push(this)}configure(t,e){Object.keys(t).forEach((i=>{const a=t[i],s=this.input.getAttribute(`data-${i.toLowerCase()}`);this[i]="number"==typeof a?parseInt(s,10):!1===a?null!==s:a instanceof Function?null:s,this[i]||0===this[i]||(this[i]=i in e?e[i]:a)}))}set list(t){if(Array.isArray(t))this.dataList=t;else if("string"==typeof t&&t.indexOf(",")>-1)this.dataList=t.split(/\s*,\s*/);else{const e=s.query(t);if(e&&e.children){const t=[],i=e=>{if(!e.disabled){const i=e.textContent.trim(),a=e.value||i,s=e.label||i;""!==a&&t.push({label:s,value:a})}};Array.prototype.slice.apply(e.children).forEach(i),this.dataList=t}}document.activeElement===this.input&&this.evaluate()}get list(){return this.dataList}get selected(){return this.index>-1}get opened(){return this.isOpened}close(t){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,this.status.setAttribute("hidden",""),s.fire(this.input,"awesomplete-close",t||{}))}open(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.status.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this.goto(0),s.fire(this.input,"awesomplete-open")}destroy(){if(s.unbind(this.input,this.events.input),s.unbind(this.input.form,this.events.form),!this.options.container){const{parentNode:t}=this.container;t.insertBefore(this.input,this.container),t.removeChild(this.container)}this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");const t=s.all.indexOf(this);-1!==t&&s.all.splice(t,1)}next(){const t=this.ul.children.length;let e=0;e=this.index<t-1?this.index+1:t?0:-1,this.goto(e)}previous(){const t=this.ul.children.length,e=this.index-1;this.goto(this.selected&&-1!==e?e:t-1)}goto(t){const e=this.ul.children;if(this.selected&&e[this.index].setAttribute("aria-selected","false"),this.index=t,t>-1&&e.length>0){e[t].setAttribute("aria-selected","true"),this.status.textContent=`${e[t].textContent}, list item ${t+1} of ${e.length}`,this.input.setAttribute("aria-activedescendant",`${this.ul.id}_item_${this.index}`),this.ul.scrollTop=e[t].offsetTop-this.ul.clientHeight+e[t].clientHeight;const i=this.suggestions[this.index];s.fire(this.input,"awesomplete-highlight",{selectedIndex:this.index,selectedText:`${i}`,selectedSuggestion:i})}}select(t,e){let i=t;if(t?this.index=s.siblingIndex(t):i=this.ul.children[this.index],i){const t=this.index,a=this.suggestions[t];s.fire(this.input,"awesomplete-select",{selectedIndex:t,selectedText:`${a}`,selectedSuggestion:a,origin:e||i})&&(this.replace(a),this.close({reason:"select"}),s.fire(this.input,"awesomplete-selectcomplete",{selectedIndex:t,selectedText:`${a}`,selectedSuggestion:a}))}}evaluate(){const t=this,{value:e}=this.input;if(e.length>=this.minChars&&this.dataList&&this.dataList.length>0){this.index=-1,this.ul.innerHTML="";const i=i=>new a(t.data(i,e)),s=i=>t.filter(i,e);this.suggestions=this.dataList.map(i).filter(s),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems);const n=(i,a)=>{t.ul.appendChild(t.item(i,e,a))};this.suggestions.forEach(n),0===this.ul.children.length?(this.status.textContent="No results found",this.close({reason:"nomatches"})):(this.open(),this.status.textContent=`${this.ul.children.length} results found`)}else this.close({reason:"nomatches"}),this.status.textContent="No results found"}static FILTER_CONTAINS(t,e){return RegExp(s.regExpEscape(e.trim()),"i").test(t)}static FILTER_STARTSWITH(t,e){return RegExp(`^${s.regExpEscape(e.trim())}`,"i").test(t)}static SORT_BYLENGTH(t,e){return t.length!==e.length?t.length-e.length:t<e?-1:1}static CONTAINER(t){return s.create("div",{className:"awesomplete",around:t})}static ITEM(t,e,i){const a=""===e.trim()?t:`${t}`.replace(RegExp(s.regExpEscape(e.trim()),"gi"),"<mark>$&</mark>");return s.create("li",{innerHTML:a,"aria-selected":"false",id:`awesomplete_list_${this.count}_item_${i}`})}static REPLACE(t){this.input.value=t.value||t.label}static DATA(t){return t}static query(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}static queryAll(t,e){return Array.prototype.slice.call((e||document).querySelectorAll(t))}static create(t,e){const i=document.createElement(t);return Object.keys(e).forEach((t=>{const a=e[t];if("inside"===t)s.query(a).appendChild(i);else if("around"===t){const t=s.query(a);t.parentNode.insertBefore(i,t),i.appendChild(t),null!=t.getAttribute("autofocus")&&t.focus()}else t in i?i[t]=a:i.setAttribute(t,a)})),i}static bind(t,e){if(t){const i=i=>{const a=e[i];i.split(/\s+/).forEach((e=>{t.addEventListener(e,a)}))};Object.keys(e).forEach(i)}}static unbind(t,e){if(t){const i=i=>{const a=e[i];i.split(/\s+/).forEach((e=>{t.removeEventListener(e,a)}))};Object.keys(e).forEach(i)}}static fire(t,e,i){const a=document.createEvent("HTMLEvents"),s=t=>{a[t]=i[t]};return a.initEvent(e,!0,!0),"object"==typeof i&&Object.keys(i).forEach(s),t.dispatchEvent(a)}static regExpEscape(t){return t.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}static siblingIndex(t){let e=0,i=t;for(;i;)i=i.previousElementSibling,i&&(e+=1);return e}}function n(t,e=".svg-holder",i="ltr"){let a=t.querySelector(e);null!=a&&a.setAttribute("dir",i)}class r extends window.HTMLElement{processCountySearchInput(t){let e="";""==t&&(this.state.county="California",this.state.statewide=!0),this.countyList.forEach((i=>{i.toLowerCase()==t.toLowerCase()&&(e=i)})),e?(this.state.county=e,this.state.statewide=!1,document.querySelector("#location-query").value=e,console.log("emitCounty via search:",e),this.emitCounty(),document.querySelector("#county-query-error").style.display="none"):document.querySelector("#county-query-error").style.display="block"}handleURLPayload(){let t=document.location.href;if(-1!=t.indexOf("#location-")){let e=t.split("#location-")[1].replace("_"," ").replace("-"," "),i=document.querySelector("#location-query");"california"!=e&&(console.log("Triggering county search",e,i),this.processCountySearchInput(e))}}connectedCallback(){this.dataset.countyLabel&&this.dataset.countyLabel,this.state={},this.state.statewide=!1,this.innerHTML='\n    <div class="row d-flex justify-content-md-center">\n      <form class="form-inline" id="county-form">\n        <div class="form-group mx-sm-3 mb-2 pos-rel autocomplete-inline">\n          <label for="location-query" class="sr-only">County</label>\n          <div class="awesomplete">\n            <input aria-expanded="false" aria-owns="awesomplete_list_1"  aria-controls="awesomplete_list_1"  autocomplete="off" class="form-control form-control-lg" data-list="" data-multiple="" id="location-query" role="combobox" type="text" placeholder="Enter a county">\n            <button class="clear d-none" id="clearCounty"><span class="ca-gov-icon-close-line" aria-hidden="true"></span> <span class="underline">Clear</span></button>\n            <span class="visually-hidden" role="status" aria-live="assertive" aria-atomic="true">Type 2 or more characters for results.</span>\n          </div>\n        </div>\n      <button type="submit" class="btn btn-lightbg btn-bigger mb-2">Get county data</button>\n      </form>\n    </div>\n    <div class="row d-flex justify-content-md-center">\n      <span id="county-query-error" class="error-text d-none">County not found</span>\n    </div>',this.addListeners(),this.countyList=["Alameda","Alpine","Amador","Butte","Calaveras","Colusa","Contra Costa","Del Norte","El Dorado","Fresno","Glenn","Humboldt","Imperial","Inyo","Kern","Kings","Lake","Lassen","Los Angeles","Madera","Marin","Mariposa","Mendocino","Merced","Modoc","Mono","Monterey","Napa","Nevada","Orange","Placer","Plumas","Riverside","Sacramento","San Benito","San Bernardino","San Diego","San Francisco","San Joaquin","San Luis Obispo","San Mateo","Santa Barbara","Santa Clara","Santa Cruz","Shasta","Sierra","Siskiyou","Solano","Sonoma","Stanislaus","Sutter","Tehama","Trinity","Tulare","Tuolumne","Ventura","Yolo","Yuba"],this.setupAutoComp("#location-query","county",this.countyList);let t=this;document.querySelector("#county-form").addEventListener("submit",(function(e){e.preventDefault(),document.querySelector("#county-query-error").style.display="none";let i=document.querySelector("#location-query").value.trim();t.processCountySearchInput(i)})),this.handleURLPayload(),n(this,"div","ltr")}setupAutoComp(t,e,i){let a=this;const n={autoFirst:!0,filter:function(t,e){return s.FILTER_CONTAINS(t,e.match(/[^,]*$/)[0])},item:function(t,e){return s.ITEM(t,e.match(/[^,]*$/)[0])},replace:function(t){let e=t.value;a.processCountySearchInput(e)},list:i};new s(t,n)}emitCounty(){const t=new window.CustomEvent("county-selected",{detail:{county:this.state.county,statewide:this.state.statewide,reset:this.state.statewide,how:"emitCounty"}});this.dispatchEvent(t)}addListeners(){let t=this.querySelector("#location-query"),e=this.querySelector("#clearCounty");function i(){t&&t.value?e.classList.remove("d-none"):e.classList.add("d-none")}t.addEventListener("focus",i),t.addEventListener("input",i),t.addEventListener("blur",i),e.addEventListener("blur",i),e.addEventListener("click",function(i){i.preventDefault(),t.value="",this.state.county="California",this.state.statewide=!0,console.log("Emit county via clearbutton"),this.emitCounty(),e.classList.add("d-none"),document.querySelector("#county-query-error").style.display="none"}.bind(this))}}window.customElements.define("cagov-county-search",r);class o extends window.HTMLElement{connectedCallback(){this.resetText="Statewide",this.county="";let t=document.querySelector("cagov-county-search");t.addEventListener("county-selected",function(t){console.log("County-selected event: ",t.detail),t.detail.reset?this.innerHTML="":t.detail.statewide?this.innerHTML=this.template(!0):(this.county=t.detail.county,this.innerHTML=this.template(!1))}.bind(this),!1),this.addEventListener("click",(function(e){if(e.preventDefault(),e.target.classList.contains("js-toggle-county")){let i=e.target.textContent;if(!e.target.classList.contains("active")){let a=new window.CustomEvent("county-selected",{detail:{county:i,statewide:!1,reset:!1,how:"tab"}});e.target.classList.contains("statewide")&&(a=new window.CustomEvent("county-selected",{detail:{county:"California",statewide:!0,reset:!1,how:"tab"}})),t.dispatchEvent(a)}}}))}template(t){return`<div class="d-flex flex-column flex-md-row justify-content-center my-3">\n    <div class="text-center large-tabs">\n          <button class="large-tab js-toggle-county county ${t?"":"active"}">${this.county}</button>\n          <button class="large-tab js-toggle-county statewide ${t?"active":""}">${this.resetText}</button>\n        </div>\n    </div>`}}function l(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}window.customElements.define("cagov-county-toggle-buttons",o);function h(t){let e={};return t.querySelectorAll("[data-label]").forEach((t=>{e[t.dataset.label]=t.innerHTML})),t.querySelectorAll("[data-group]").forEach((t=>{let i=t.getAttribute("data-group"),a=t.querySelectorAll("[data-item]");if(null!==i&&null!==a){let t={};a.forEach((e=>{let i=e.getAttribute("data-item");t[i]=e.innerHTML})),e[i]=t}})),e}function c(){window.charts={};const t=()=>{let t=window.innerWidth,e=(window.innerHeight,(window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: 75.6dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min--moz-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)").matches)||window.devicePixelRatio&&window.devicePixelRatio>=2)&&/(iPad|iPhone|iPod)/g.test(navigator.userAgent)),i=window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches)||window.devicePixelRatio&&window.devicePixelRatio>1.3;(screen.orientation||{}).type||screen.mozOrientation||screen.msOrientation,void 0!==window.charts&&(t<=576?(window.charts.displayType="mobile",!0!==i&&!0!==e||(window.charts.displayType="retina")):window.charts.displayType=t>576&&t<=768?"tablet":"desktop")},e=()=>{t()};window.addEventListener("resize",e),e()}l("cagov-chart-dashboard-groups-race-ethnicity-cases.chart .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-dashboard-groups-race-ethnicity-cases.chart .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-race-ethnicity-cases.chart .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-dashboard-groups-race-ethnicity-cases.chart .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-race-ethnicity-cases.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.d-hide {\n  display: none; }\n");let d=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}),p=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:1,maximumFractionDigits:1}),g=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),m=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:3,maximumFractionDigits:3}),u=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0}),f=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1}),y=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),b=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:3,maximumFractionDigits:3});function _(t,{format:e="number",min_decimals:i=1}){return"integer"==e?d.format(t):"percent"==e?0==t?u.format(t):t<5e-5?b.format(t):t<5e-4?y.format(t):0==i?u.format(t):f.format(t):0==t?d.format(t):t<.005?m.format(t):t<.05?g.format(t):0==i?d.format(t):1==i?p.format(t):2==i?g.format(t):m.format(t)}function v(t,e,i,a,s){const n=this.getLegendText();if(0==n.length)return;const r=1.2*a.bandwidth(),o=this.dimensions.margin.top/2,l=this.dimensions.width/2;let h=t.append("g");h.append("rect").attr("fill","#92C5DE").attr("class","legend-block").attr("y",o).attr("x",0).attr("width",r).attr("height",r),h.append("text").text(n[0]).attr("class","legend-caption").attr("y",o+r/2+1).attr("x",2*r).attr("dominant-baseline","middle").attr("text-anchor","start"),s&&n.length>1&&(h.append("rect").attr("fill","#1f2574").attr("y",o-a.bandwidth()/2).attr("x",l).attr("width",(t=>4)).attr("height",2*a.bandwidth()),h.append("text").text(n[1]).attr("class","legend-caption").attr("y",o+r/2).attr("x",l+15).attr("dominant-baseline","middle").attr("text-anchor","start"))}function x(t,e,i,a,s,n,r="barid"){let o=i.domain()[1],l=this,h=t.append("g").selectAll("g").data(e).enter().append("g");h.append("rect").attr("class","bg-bar").attr("fill","#f2f5fc").attr("y",((t,e)=>a(t.CATEGORY))).attr("x",(t=>i(0))).attr("width",(t=>i(o))).attr("height",a.bandwidth()),h.append("rect").attr("class","fg-bar").attr("fill","#92C5DE").attr("y",((t,e)=>a(t.CATEGORY))).attr("x",(t=>i(0))).attr("width",(t=>i(t.METRIC_VALUE))).attr("height",a.bandwidth()).attr("id",((t,e)=>r+"-"+e)),h.append("rect").attr("class","hot-bar").attr("fill","#00ff00").attr("fill-opacity",0).attr("y",((t,e)=>a(t.CATEGORY))).attr("x",(t=>i(0))).attr("width",(t=>i(o))).attr("height",a.bandwidth()).attr("tabindex","0").attr("aria-label",((t,e)=>`${this.ariaLabel(t,s)}`)).on("mouseover focus",(function(t,e,i){d3.select(this.parentNode).select(".fg-bar").transition().duration(200).style("fill","#003D9D"),n&&(n.html(l.getTooltip(e,s)),n.style("left","20px"),n.style("top",`${t.offsetY+120}px`),n.style("visibility","visible"))})).on("mouseout blur",(function(t){d3.select(this.parentNode).select(".fg-bar").transition().duration(200).style("fill","#92C5DE"),n&&(d3.select(this).transition(),n.style("visibility","hidden"))})),s&&h.append("rect").attr("fill","#1f2574").attr("fill-opacity",((t,e)=>-1==s[e].METRIC_VALUE?0:1)).attr("y",((t,e)=>a(t.CATEGORY)-a.bandwidth()/2)).attr("x",((t,e)=>i(s[e].METRIC_VALUE)-2)).attr("width",(t=>4)).attr("height",2*a.bandwidth()),h.append("text").attr("class","bar-label").attr("y",((t,e)=>a(t.CATEGORY)+a.bandwidth()/2)).attr("x",(t=>i(o)+12)).text((t=>_(t.METRIC_VALUE,{format:"percent"}))).attr("dominant-baseline","middle").attr("text-anchor","start"),h.append("text").attr("class","bar-cat").attr("y",((t,e)=>a(t.CATEGORY)-8)).attr("x",(t=>i(0))).text((t=>t.CATEGORY)).attr("text-anchor","start")}function E(t=null,e=null,i=null,a="barid"){let s=this.alldata,n=s.map((t=>t.CATEGORY));this.dimensions.height=this.dimensions.margin.top+60*n.length,d3.select(this.querySelector("svg")).attr("viewBox",[0,0,this.dimensions.width,this.dimensions.height]),this.y=d3.scaleBand().domain(n).range([this.dimensions.margin.top,this.dimensions.height-this.dimensions.margin.bottom]).paddingInner(5/6).paddingOuter(.5),this.max_x_domain=this.x=d3.scaleLinear().domain([0,1]).range([this.dimensions.margin.left,this.dimensions.width-(this.dimensions.margin.left+this.dimensions.margin.right)]),this.svg.selectAll("g").remove(),x.call(this,this.svg,s,this.x,this.y,e,i,a),v.call(this,this.svg,s,this.x,this.y,e),t&&t.call(this,this.svg,s,this.x,this.y)}function T(t){const e=t.split("-"),i=+e[0],a=+e[1],s=+e[2];return new Date(i,a-1,s)}function w(t){let e=""+(t.getMonth()+1),i=""+t.getDate(),a=t.getFullYear();return e.length<2&&(e="0"+e),i.length<2&&(i="0"+i),[a,e,i].join("-")}function A(t){let e=new Date;return e.setDate(e.getDate()+t),w(e)}function C(t,e={month:"long",day:"numeric",year:"numeric"}){return t.toLocaleString(document.documentElement.lang,e)}function O(t,e={month:"long",day:"numeric",year:"numeric"},i=0){const a=T(t);return 0!=i&&a.setDate(a.getDate()+i),C(a,e)}function L(t,e){for(const i in e){const a=e[i];t=(t=(t=t.replace("{{"+i+"}}",a)).replace("{"+i+"}",a)).replace("("+i+")",a)}return t}class D extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardGroupsRaceEthnicityCases"),this.translationsObj=h(this),this.innerHTML=function({chartTitle:t="Confirmed cases by race and ethnicity in California",chartDataLabel:e=null}){return`\n    <div class="py-2">\n      <div class="bg-white pt-2 pb-1">\n        <div class="mx-auto">\n            <div class="chart-title">${t}</div>\n            <div class="svg-holder"></div>\n        </div>\n      </div>\n    </div>`}(this.translationsObj),this.nbr_bars=8,this.bar_vspace=60,this.chartOptions={dataUrl:t,desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:400,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:350,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:0,left:0}}},this.labelTran={"American Indian or Alaska Native":"AI/AN",Asian:"Asian American","Native Hawaiian and other Pacific Islander":"NHPI"},c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-dashboard-groups-race-ethnicity-cases").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}getTooltip(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${_(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${_(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}ariaLabel(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",t.CATEGORY),i=i.replace("{metric-value}",_(t.METRIC_VALUE,{format:"percent"})),i=i.replace("{metric-baseline-value}",_(a[0].METRIC_VALUE,{format:"percent"})),i}getLegendText(){return[this.translationsObj.chartLegend1,this.translationsObj.chartLegend2]}renderExtras(t,e,i,a){}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data.by_race_and_ethnicity.cases,this.popdata=t.data.by_race_and_ethnicity.population,this.alldata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),this.popdata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),this.alldata.push(this.alldata.splice(4,1)[0]),this.popdata.push(this.popdata.splice(4,1)[0]),this.alldata.push(this.alldata.splice(5,1)[0]),this.popdata.push(this.popdata.splice(5,1)[0]);let e=this.metadata.PUBLISHED_DATE,i=T(e),a=T(e);a.setDate(a.getDate()-1);let s={PUBLISHED_DATE:C(i),MINUS_ONE_DATE:C(a)},n=L(this.translationsObj.footerText,s);d3.select(document.querySelector("#ethnicityGroupChartContainer .chart-footer-caption")).text(n),E.call(this,this.renderExtras,this.popdata,this.tooltip,"g-re-cases")}.bind(this))}}window.customElements.define("cagov-chart-dashboard-groups-race-ethnicity-cases",D);l("cagov-chart-dashboard-groups-race-ethnicity-deaths.chart .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-dashboard-groups-race-ethnicity-deaths.chart .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-race-ethnicity-deaths.chart .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-dashboard-groups-race-ethnicity-deaths.chart .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-race-ethnicity-deaths.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.d-hide {\n  display: none; }\n");class k extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardGroupsRaceEthnicityDeaths"),this.translationsObj=h(this),this.innerHTML=function({chartTitle:t="Confirmed deaths by race and ethnicity in California",chartDataLabel:e=null}){return`\n  <div class="py-2">\n    <div class="bg-white pt-2 pb-1">\n      <div class="mx-auto">\n        <div class="chart-title">${t}</div>\n        <div class="svg-holder"></div>\n      </div>\n    </div>\n  </div>`}(this.translationsObj),this.nbr_bars=8,this.bar_vspace=60,this.chartOptions={dataUrl:t,desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:400,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:350,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:0,left:0}}},this.labelTran={"American Indian or Alaska Native":"AI/AN",Asian:"Asian American","Native Hawaiian and other Pacific Islander":"NHPI"},c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-dashboard-groups-race-ethnicity-deaths").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}getTooltip(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${_(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${_(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}ariaLabel(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",t.CATEGORY),i=i.replace("{metric-value}",_(t.METRIC_VALUE,{format:"percent"})),i=i.replace("{metric-baseline-value}",_(a[0].METRIC_VALUE,{format:"percent"})),i}getLegendText(){return[this.translationsObj.chartLegend1,this.translationsObj.chartLegend2]}renderExtras(t,e,i,a){}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.alldata=t.data.by_race_and_ethnicity.deaths,this.popdata=t.data.by_race_and_ethnicity.population,this.alldata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),this.popdata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),this.alldata.push(this.alldata.splice(4,1)[0]),this.popdata.push(this.popdata.splice(4,1)[0]),this.alldata.push(this.alldata.splice(5,1)[0]),this.popdata.push(this.popdata.splice(5,1)[0]),E.call(this,this.renderExtras,this.popdata,this.tooltip,"g-re-deaths")}.bind(this))}}window.customElements.define("cagov-chart-dashboard-groups-race-ethnicity-deaths",k);l("cagov-chart-dashboard-groups-gender-cases.chart .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-dashboard-groups-gender-cases.chart .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-gender-cases.chart .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-dashboard-groups-gender-cases.chart .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-gender-cases.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.d-hide {\n  display: none; }\n");class S extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardGroupsGenderCases"),this.translationsObj=h(this),this.innerHTML=function({chartTitle:t="Confirmed cases by gender in California",chartDataLabel:e=null}){return`\n    <div class="py-2">\n      <div class="bg-white pt-2 pb-1">\n        <div class="mx-auto">\n            <div class="chart-title">${t}</div>\n            <div class="svg-holder"></div>\n        </div>\n      </div>\n    </div>`}(this.translationsObj),this.nbr_bars=8,this.bar_vspace=60,this.chartOptions={dataUrl:t,desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:400,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:350,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:0,left:0}}},this.labelTran={},c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-dashboard-groups-gender-cases").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}getTooltip(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}s</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${_(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${_(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}ariaLabel(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",t.CATEGORY+"s"),i=i.replace("{metric-value}",_(t.METRIC_VALUE,{format:"percent"})),i=i.replace("{metric-baseline-value}",_(a[0].METRIC_VALUE,{format:"percent"})),i}getLegendText(){return[this.translationsObj.chartLegend1,this.translationsObj.chartLegend2]}renderExtras(t,e,i,a){}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data.by_gender.cases,this.popdata=t.data.by_gender.population,this.alldata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),this.popdata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])}));let e=this.metadata.PUBLISHED_DATE,i=T(e),a=T(e);a.setDate(a.getDate()-1);let s={PUBLISHED_DATE:C(i),MINUS_ONE_DATE:C(a)},n=L(this.translationsObj.footerText,s);d3.select(document.querySelector("#genderGroupChartContainer .chart-footer-caption")).text(n),E.call(this,this.renderExtras,this.popdata,this.tooltip,"g-gender-cases")}.bind(this))}}window.customElements.define("cagov-chart-dashboard-groups-gender-cases",S);l("cagov-chart-dashboard-groups-gender-deaths.chart .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-dashboard-groups-gender-deaths.chart .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-gender-deaths.chart .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-dashboard-groups-gender-deaths.chart .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-gender-deaths.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.d-hide {\n  display: none; }\n");class I extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardGroupsGenderDeaths"),this.translationsObj=h(this),this.innerHTML=function({chartTitle:t="Confirmed deaths by gender in California",chartDataLabel:e=null}){return`\n  <div class="py-2">\n    <div class="bg-white pt-2 pb-1">\n      <div class="mx-auto">\n        <div class="chart-title">${t}</div>\n        <div class="svg-holder"></div>\n      </div>\n    </div>\n  </div>`}(this.translationsObj),this.nbr_bars=8,this.bar_vspace=60,this.chartOptions={dataUrl:t,desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:400,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:350,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:0,left:0}}},this.labelTran={},c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-dashboard-groups-gender-deaths").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}getTooltip(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}s</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${_(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${_(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}ariaLabel(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",t.CATEGORY+"s"),i=i.replace("{metric-value}",_(t.METRIC_VALUE,{format:"percent"})),i=i.replace("{metric-baseline-value}",_(a[0].METRIC_VALUE,{format:"percent"})),i}getLegendText(){return[this.translationsObj.chartLegend1,this.translationsObj.chartLegend2]}renderExtras(t,e,i,a){}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.alldata=t.data.by_gender.deaths,this.popdata=t.data.by_gender.population,this.alldata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),this.popdata.forEach((t=>{t.METRIC_VALUE/=100,t.CATEGORY in this.labelTran&&(t.CATEGORY=this.labelTran[t.CATEGORY])})),E.call(this,this.renderExtras,this.popdata,this.tooltip,"g-gender-deaths")}.bind(this))}}window.customElements.define("cagov-chart-dashboard-groups-gender-deaths",I);l("cagov-chart-dashboard-groups-age-cases.chart .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-dashboard-groups-age-cases.chart .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-age-cases.chart .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-dashboard-groups-age-cases.chart .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-age-cases.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.d-hide {\n  display: none; }\n");class U extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardGroupsAgeCases"),this.translationsObj=h(this),this.innerHTML=function({chartTitle:t="Confirmed cases by age in California",chartDataLabel:e=null}){return`\n    <div class="py-2">\n      <div class="bg-white pt-2 pb-1">\n        <div class="mx-auto">\n            <div class="chart-title">${t}</div>\n            <div class="svg-holder"></div>\n        </div>\n      </div>\n    </div>`}(this.translationsObj),this.nbr_bars=8,this.bar_vspace=60,this.chartOptions={dataUrl:t,desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:400,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:350,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:0,left:0}}},c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-dashboard-groups-age-cases").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}getTooltip(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${_(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${_(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}ariaLabel(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",t.CATEGORY),i=i.replace("{metric-value}",_(t.METRIC_VALUE,{format:"percent"})),i=i.replace("{metric-baseline-value}",_(a[0].METRIC_VALUE,{format:"percent"})),i}getLegendText(){return[this.translationsObj.chartLegend1,this.translationsObj.chartLegend2]}renderExtras(t,e,i,a){}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data.by_age.cases,this.popdata=t.data.by_age.population,this.alldata.forEach((t=>{t.METRIC_VALUE/=100})),this.popdata.forEach((t=>{t.METRIC_VALUE/=100}));let e=this.metadata.PUBLISHED_DATE,i=T(e),a=T(e);a.setDate(a.getDate()-1);let s={PUBLISHED_DATE:C(i),MINUS_ONE_DATE:C(a)},n=L(this.translationsObj.footerText,s);d3.select(document.querySelector("#ageGroupChartContainer .chart-footer-caption")).text(n),E.call(this,this.renderExtras,this.popdata,this.tooltip,"g-age-cases")}.bind(this))}}window.customElements.define("cagov-chart-dashboard-groups-age-cases",U);l("cagov-chart-dashboard-groups-age-deaths.chart .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-dashboard-groups-age-deaths.chart .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-age-deaths.chart .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-dashboard-groups-age-deaths.chart .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-dashboard-groups-age-deaths.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.d-hide {\n  display: none; }\n");class j extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardGroupsAgeDeaths"),this.translationsObj=h(this),this.innerHTML=function({chartTitle:t="Confirmed deaths by age in California",chartDataLabel:e=null}){return`\n  <div class="py-2">\n    <div class="bg-white pt-2 pb-1">\n      <div class="mx-auto">\n        <div class="chart-title">${t}</div>\n        <div class="svg-holder"></div>\n      </div>\n    </div>\n  </div>`}(this.translationsObj),this.nbr_bars=8,this.bar_vspace=60,this.chartOptions={dataUrl:t,desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:400,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:350,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:0,left:0}}},c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-dashboard-groups-age-deaths").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}getTooltip(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${_(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${_(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}ariaLabel(t,e){let i=this.translationsObj.chartBarCaption,a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",t.CATEGORY),i=i.replace("{metric-value}",_(t.METRIC_VALUE,{format:"percent"})),i=i.replace("{metric-baseline-value}",_(a[0].METRIC_VALUE,{format:"percent"})),i}getLegendText(){return[this.translationsObj.chartLegend1,this.translationsObj.chartLegend2]}renderExtras(t,e,i,a){}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.alldata=t.data.by_age.deaths,this.popdata=t.data.by_age.population,this.alldata.forEach((t=>{t.METRIC_VALUE/=100})),this.popdata.forEach((t=>{t.METRIC_VALUE/=100})),E.call(this,this.renderExtras,this.popdata,this.tooltip,"g-age-deaths")}.bind(this))}}window.customElements.define("cagov-chart-dashboard-groups-age-deaths",j);class F extends window.HTMLElement{connectedCallback(){this.addEventListener("click",(function(t){t.preventDefault();let e=t.target.textContent,i=t.target.dataset.key;if(null!=i&&!t.target.classList.contains("active")){let a=new window.CustomEvent("filter-selected",{detail:{filterKey:i,clickedFilterText:e}});this.resetActive(),t.target.classList.add("active"),this.dispatchEvent(a)}}));let t=this.querySelector("button[data-key='deaths']");document.querySelector("cagov-county-search").addEventListener("county-selected",function(e){t&&(e.detail.statewide?t.style.display="block":t.style.display="none",t.classList.contains("active")&&(t.classList.remove("active"),this.querySelector("button").classList.add("active")))}.bind(this),!1)}resetActive(){this.querySelectorAll(".small-tab").forEach((t=>{t.classList.contains("active")&&t.classList.remove("active")}))}}window.customElements.define("cagov-chart-filter-buttons",F);function R(t,{post_chartTitle:e="chart title",post_chartLegend1:i="Chart Legend 1",post_chartLegend2:a="Chart Legend 2",post_chartLegend3:s=null,filterTabLabel1:n="Tab Label 1",filterTabLabel2:r="Tab Label 2"}){let o="";if("filterKeys"in t){let e=this.chartConfigFilter==t.filterKeys[0]?"active":"",i=this.chartConfigFilter==t.filterKeys[1]?"active":"";o=`<cagov-chart-filter-buttons class="filter-buttons--statedash js-re-smalls js-filter-${this.chartConfigKey}">\n            <div class="d-flex justify-content-center">\n              <button class="small-tab ${e}" data-key="${t.filterKeys[0]}">${n}</button>\n              <button class="small-tab ${i}" data-key="${t.filterKeys[1]}">${r}</button>\n            </div>\n          </cagov-chart-filter-buttons>`}return`\n    <div class="py-2">\n      <div class="bg-white pt-2 pb-1">\n        <div class="mx-auto chart-histogram">\n            <div class="chart-title">${e}</div>\n            ${o}\n            <div class="chart-header">\n            <div class="header-line header-line1">${i}</div>\n            <div class="header-line">${a}</div>\n`+(s?`            <div class="header-line">${s}</div>\n`:"")+'            </div>\n            <div class="svg-holder"></div>\n            \x3c!-- <a class="dl-button" role="button">download</a> --\x3e\n        </div>\n      </div>\n    </div>\n    '}l(".chart .svg-holder g.fg-bars {\n  fill: #deeaf6; }\n\n.chart .svg-holder g.fg-line path {\n  fill: none;\n  stroke: black;\n  stroke-width: 2px; }\n\n.chart .svg-holder g.fg-line.second-line path {\n  opacity: 0.5; }\n\n.chart .svg-holder g.pending-block rect {\n  fill: black;\n  opacity: 0.05; }\n\n.chart .svg-holder g.pending-block text {\n  font-weight: 300;\n  font-size: 0.8rem;\n  fill: black; }\n\n.chart .svg-holder g.pending-block text {\n  text-anchor: end;\n  dominant-baseline: auto; }\n\n.chart .svg-holder g.date-axis line {\n  stroke-width: 0.5px;\n  stroke: black; }\n\n.chart .svg-holder g.date-axis text {\n  font-weight: 300;\n  font-size: 0.75rem;\n  fill: black; }\n\n.chart .svg-holder g.date-axis text {\n  text-anchor: middle;\n  dominant-baseline: hanging; }\n\n.chart .svg-holder g.date-axis text.x-axis-legend {\n  font-weight: 300;\n  text-anchor: end;\n  dominant-baseline: middle; }\n\n.chart .svg-holder g.county-legend rect {\n  fill: black; }\n\n.chart .svg-holder g.county-legend text {\n  font-weight: 300;\n  font-size: 0.75rem;\n  fill: black; }\n\n.chart .svg-holder g.county-legend text {\n  text-anchor: left;\n  dominant-baseline: middle; }\n\n.chart .svg-holder g.state-legend rect {\n  fill: gray; }\n\n.chart .svg-holder g.state-legend text {\n  font-weight: 300;\n  font-size: 0.75rem;\n  fill: black; }\n\n.chart .svg-holder g.state-legend text {\n  text-anchor: left;\n  dominant-baseline: middle; }\n\n.chart .svg-holder g.left-y-axis line {\n  stroke-width: 0.5px;\n  stroke: black;\n  opacity: 0.15; }\n\n.chart .svg-holder g.left-y-axis text {\n  font-weight: 400;\n  font-size: 0.75rem;\n  fill: black; }\n\n.chart .svg-holder g.left-y-axis text {\n  text-anchor: end;\n  dominant-baseline: middle; }\n\n.chart .svg-holder g.left-y-axis text.left-y-axis-legend {\n  font-weight: 700;\n  font-size: 0.75rem;\n  text-anchor: start;\n  dominant-baseline: hanging; }\n\n.chart .svg-holder g.right-y-axis line {\n  stroke-width: 0.5px;\n  stroke: #608cbd; }\n\n.chart .svg-holder g.right-y-axis text {\n  font-weight: 400;\n  font-size: 0.75rem;\n  fill: #1f2574; }\n\n.chart .svg-holder g.right-y-axis text {\n  text-anchor: start;\n  dominant-baseline: middle; }\n\n.chart .svg-holder g.right-y-axis text.right-y-axis-legend {\n  font-weight: 700;\n  font-size: 0.75rem;\n  text-anchor: end;\n  dominant-baseline: hanging; }\n\n.chart .svg-holder text.line-legend text {\n  font-weight: 300;\n  font-size: 1rem;\n  fill: black;\n  text-anchor: middle;\n  dominant-baseline: auto; }\n\n.chart .svg-holder g.tt-marker {\n  fill: black;\n  opacity: 0.5; }\n\n.chart .svg-holder g.line-legend text {\n  font-weight: 400;\n  font-size: 0.8rem;\n  text-anchor: middle;\n  dominant-baseline: auto; }\n\n.chart .svg-holder g.line-legend line {\n  stroke-width: 0.25px;\n  stroke: black; }\n\n.chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 0px; }\n\n.chart .chart-header {\n  margin-bottom: 24px;\n  font-weight: 300;\n  font-size: 0.95rem; }\n\n.chart .chart-header .header-line1 {\n  font-weight: 700;\n  font-size: 0.95rem; }\n\n.chart .chart-header .big-num {\n  font-weight: 700;\n  font-size: 1.2rem;\n  color: #1f2574; }\n\n.chart .chart-header .med-num {\n  font-weight: 400;\n  font-size: 1rem;\n  color: #1f2574; }\n\n.chart div.tooltip-container {\n  font-weight: 300;\n  font-size: 0.75rem;\n  line-height: 2;\n  color: black;\n  text-align: center; }\n\n.chart .tooltip-container {\n  position: absolute;\n  z-index: 10;\n  visibility: hidden;\n  background: #fff;\n  width: 280px; }\n\n.chart .tooltip-container {\n  pointer-events: none;\n  /* padding: 10px; */\n  padding: 1rem 2rem;\n  box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.14);\n  /* box-shadow: -12px 11px 5px -4px rgba(0, 0, 0, 0.4); */\n  border: none; }\n\n.chart .pending-caveat {\n  font-style: italic; }\n\n.chart a.dlbutton {\n  border-radius: 3px;\n  background-color: aqua;\n  color: blue;\n  font-weight: 300;\n  font-size: 0.5rem; }\n\n.d-hide {\n  display: none; }\n");var M={cases:{episode:{chartName:"cagov-chart-dashboard-confirmed-cases",latestField:"CONFIRMED_CASES",seriesField:"CONFIRMED_CASES_EPISODE_DATE",seriesFieldAvg:"AVG_CASE_RATE_PER_100K_7_DAYS",dataUrl:"confirmed-cases/california.json",dataUrlCounty:"confirmed-cases/<county>.json",rootId:"cases-ep",filterKeys:["episode","reported"]},reported:{chartName:"cagov-chart-dashboard-confirmed-cases",latestField:"CONFIRMED_CASES",seriesField:"CONFIRMED_CASES_REPORTED_DATE",seriesFieldAvg:"AVG_CASE_REPORT_RATE_PER_100K_7_DAYS",dataUrl:"confirmed-cases/california.json",dataUrlCounty:"confirmed-cases/<county>.json",rootId:"cases-rep",filterKeys:["episode","reported"]}},deaths:{death:{chartName:"cagov-chart-dashboard-confirmed-deaths",latestField:"CONFIRMED_DEATHS",seriesField:"CONFIRMED_DEATHS_DEATH_DATE",seriesFieldAvg:"AVG_DEATH_RATE_PER_100K_7_DAYS",dataUrl:"confirmed-deaths/california.json",dataUrlCounty:"confirmed-deaths/<county>.json",rootId:"death-date",filterKeys:["death","reported"]},reported:{chartName:"cagov-chart-dashboard-confirmed-deaths",latestField:"CONFIRMED_DEATHS",seriesField:"CONFIRMED_DEATHS_REPORTED_DATE",seriesFieldAvg:"AVG_DEATH_REPORT_RATE_PER_100K_7_DAYS",dataUrl:"confirmed-deaths/california.json",dataUrlCounty:"confirmed-deaths/<county>.json",rootId:"deaths-reported-date",filterKeys:["death","reported"]}},tests:{testing:{chartName:"cagov-chart-dashboard-total-tests",latestField:"TOTAL_TESTS",seriesField:"TOTAL_TESTS",seriesFieldAvg:"AVG_TEST_RATE_PER_100K_7_DAYS",dataUrl:"total-tests/california.json",dataUrlCounty:"total-tests/<county>.json",rootId:"tests-tests",filterKeys:["testing","reported"]},reported:{chartName:"cagov-chart-dashboard-total-tests",latestField:"TOTAL_TESTS",seriesField:"REPORTED_TESTS",seriesFieldAvg:"AVG_TEST_REPORT_RATE_PER_100K_7_DAYS",dataUrl:"total-tests/california.json",dataUrlCounty:"total-tests/<county>.json",rootId:"tests-rep",filterKeys:["testing","reported"]}},positivity:{positivity:{chartName:"cagov-chart-dashboard-positivity-rate",latestField:"POSITIVITY_RATE",seriesField:"TOTAL_TESTS",seriesFieldAvg:"TEST_POSITIVITY_RATE_7_DAYS",dataUrl:"positivity-rate/california.json",dataUrlCounty:"positivity-rate/<county>.json",rootId:"pos-rate"}},patients:{hospitalized:{chartName:"cagov-chart-dashboard-patients",latestField:"HOSPITALIZED_PATIENTS",seriesField:"HOSPITALIZED_PATIENTS",seriesFieldAvg:"HOSPITALIZED_PATIENTS_14_DAY_AVG",dataUrl:"patients/california.json",dataUrlCounty:"patients/<county>.json",rootId:"hosp-p",filterKeys:["hospitalized","icu"]},icu:{chartName:"cagov-chart-dashboard-patients",latestField:"ICU_PATIENTS",seriesField:"ICU_PATIENTS",seriesFieldAvg:"ICU_PATIENTS_14_DAY_AVG",dataUrl:"patients/california.json",dataUrlCounty:"patients/<county>.json",rootId:"hosp-p",filterKeys:["hospitalized","icu"]}},"icu-beds":{"icu-beds":{chartName:"cagov-chart-dashboard-icu-beds",latestField:"ICU_BEDS",seriesField:"ICU_BEDS",seriesFieldAvg:"ICU_BEDS",dataUrl:"icu-beds/california.json",dataUrlCounty:"icu-beds/<county>.json",rootId:"icu-beds"}},desktop:{fontSize:14,width:400,height:300,margin:{left:50,top:30,right:60,bottom:45}},tablet:{fontSize:14,width:400,height:300,margin:{left:50,top:30,right:60,bottom:45}},mobile:{fontSize:12,width:400,height:300,margin:{left:50,top:30,right:60,bottom:45}},retina:{fontSize:12,width:400,height:300,margin:{left:50,top:30,right:60,bottom:45}}};function V(t,e,i,a,{root_id:s="barid",is_second_line:n=!1,crop_floor:r=!0}){a.domain()[1],i.domain()[1],t.append("g").attr("class","fg-line "+s+(n?" second-line":"")).append("path").datum(e).attr("d",d3.line().x((function(t,e){return i(e)})).y((function(t){return a(r?Math.max(0,t.VALUE):t.VALUE)})))}function N(t,e,i,a,{root_id:s="barid",crop_floor:n=!0}){n||console.log("NOT CROP FLOOR");let r=t.append("g").attr("class","fg-bars "+s).selectAll("g").data(e).enter().append("g");n?r.append("rect").attr("x",((t,e)=>i(e))).attr("y",(t=>a(t.VALUE))).attr("width",2).attr("height",(t=>Math.max(a(0)-a(t.VALUE),0))).attr("id",((t,e)=>s+"-"+e)):r.append("rect").attr("x",((t,e)=>i(e))).attr("y",(t=>Math.min(a(0),a(t.VALUE)))).attr("width",2).attr("height",(t=>Math.abs(a(0)-a(t.VALUE)))).attr("id",((t,e)=>s+"-"+e))}function G(t,e,i,a,{pending_date:s=null,pending_legend:n=null,root_id:r="barid"}){let o=t.append("g").attr("class","pending-block");i.domain()[1];const l=a.domain()[0],h=a.domain()[1];let c=0;for(let t=0;t<e.length&&(c+=1,e[t].DATE!=s);++t);o.append("rect").attr("x",i(c)).attr("y",a(h)).attr("width",i(0)-i(c)).attr("height",a(l)-a(h)),o.append("text").text(n).attr("x",i(0)).attr("y",a(h)-4)}function z(t,e,i,{county_legend:a="County",state_legend:s="State"}){let n=this.dimensions.height-6,r=this.dimensions.margin.left,o=t.append("g").attr("class","county-legend");o.append("rect").attr("x",r).attr("y",n).attr("width",24).attr("height",1),o.append("text").text(a).attr("x",r+36).attr("y",n),o=t.append("g").attr("class","state-legend"),o.append("rect").attr("x",r+85).attr("y",n).attr("width",24).attr("height",1),o.append("text").text(s).attr("x",r+85+36).attr("y",n)}function B(t,e,i,a,{x_axis_legend:s=null,month_modulo:n=3,root_id:r="barid"}){const o=this.dimensions.height-this.dimensions.margin.bottom;let l=t.append("g").attr("class","date-axis");e.forEach(((t,e)=>{const a=t.DATE.split("-"),s=parseInt(a[1]);if(s%n==0){if(1==parseInt(a[2])){const t=s+"/1";let a=l.append("g").attr("class","x-tick");a.append("line").attr("x1",i(e)).attr("y1",o+1).attr("x2",i(e)).attr("y2",o+1+4),a.append("text").text(t).attr("x",i(e)).attr("y",o+1+4+2)}}})),s&&l.append("text").attr("class","x-axis-legend").attr("style","font-family:sans-serif; font-weight:300; font-size: 0.75rem; fill:black;text-anchor: end; dominant-baseline:middle;").text(s).attr("x",i(0)).attr("y",this.dimensions.height-6)}function H(t,{hint:e="num",digits:i=0}){if("pct"==e){const e=t<.01?2:t<.1?1:0;return new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:e,maximumFractionDigits:e}).format}if(t<4e3){const i="integer"==e?0:t<.1?2:t<10?1:0;return new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:i,maximumFractionDigits:i}).format}if(t<1e6){const e=t<4e3?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e3)+"K"}}if(t<1e9){const e=t<4e6?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e6)+"M"}}{const e=t<4e9?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e3)+"M"}}}function Y(t,e,i,a,{y_axis_legend:s=null,left_y_fmt:n="num",root_id:r="barid"}){const o=K(a,{hint:n});let l=t.append("g").attr("class","left-y-axis");const h=a.domain()[1],c=i.domain()[0],d=i.domain()[1];let p=H(h,{hint:n});for(let t=0;t<=h;t+=o){let e=p(t),s=l.append("g").attr("class","y-tick");s.append("line").attr("style","stroke-width: 0.5px; stroke:black; opacity:0.15;").attr("x1",i(d)).attr("y1",a(t)).attr("x2",i(c)).attr("y2",a(t)),s.append("text").text(e).attr("style","font-family:sans-serif; font-weight:400; font-size: 0.75rem; fill:black;text-anchor: end; dominant-baseline:middle;").attr("x",i(d)-10).attr("y",a(t))}s&&l.append("text").attr("class","left-y-axis-legend").attr("style","font-family:sans-serif; font-weight:700; font-size: 0.75rem; fill:black;text-anchor: start; dominant-baseline:hanging;").text(s).attr("x",0).attr("y",4)}function P(t,e,i,a,{y_axis_legend:s=null,right_y_fmt:n="num",root_id:r="barid"}){const o=K(a,{hint:n});let l=t.append("g").attr("class","right-y-axis").attr("style","stroke-width: 0.5px; stroke:#608cbd;");const h=a.domain()[1],c=i.domain()[0];let d=H(h,{hint:n});for(let t=0;t<=h;t+=o){let e=d(t);l.append("g").attr("class","y-tick").append("text").text(e).attr("style","font-family:sans-serif; font-weight:400; font-size: 0.75rem; fill:#1f2574; text-anchor:start; dominant-baseline:middle; ").attr("x",i(c)+24).attr("y",a(t))}s&&l.append("text").attr("class","right-y-axis-legend").text(s).attr("style","font-family:sans-serif; font-weight:700; font-size: 0.75rem; fill:#1f2574; text-anchor:end; dominant-baseline:hanging; ").attr("x",this.dimensions.width).attr("y",4)}function $(t,e,i,a,s,n,r){let o=this.tooltip,l=this.getTooltipContent(e);o.html(l),o.style("left",`${Math.min(this.dimensions.width-280,t.offsetX)}px`),o.style("top",`${t.offsetY+220}px`),o.style("visibility","visible"),this.svg.selectAll("g.tt-marker").remove(),this.svg.append("g").attr("class","tt-marker").append("rect").attr("x",n(a)-1).attr("y",r(s.VALUE)).attr("width",3).attr("height",Math.max(0,r(0)-r(s.VALUE)))}function q(){this.tooltip,this.tooltip.style("visibility","hidden"),this.svg.selectAll("g.tt-marker").remove()}function K(t,{hint:e="num"}){const i=t.domain()[1],a=Math.log10(i),s=Math.floor(a),n=a-s;if(n<.176)var r=5;else if(n<.477)r=2;else if(n<.778)r=1;else r=.5;let o=Math.pow(10,s)/r;return"integer"==e&&o<1&&(o=1),o}function J(t,e,i,a,s){if(null!=e){let t=Math.floor(2*i.length/3),n=i[t],r=this.dimensions.width/3,o=this.dimensions.height/4,l=a(t),h=s(n.VALUE),c=6,d=Math.atan2(h-o,l-r);r+=Math.cos(d)*c,o+=Math.sin(d)*c,l+=Math.cos(d+Math.PI)*c,h+=Math.sin(d+Math.PI)*c;let p=this.svg.append("g").attr("class","line-legend");p.append("text").text(e).attr("x",this.dimensions.width/3).attr("y",this.dimensions.height/4),p.append("line").attr("x1",r).attr("y1",o).attr("x2",l).attr("y2",h)}}function W({tooltip_func:t=null,extras_func:e=null,time_series_bars:i=null,time_series_line:a=null,time_series_state_line:s=null,line_date_offset:n=0,left_y_fmt:r="num",right_y_fmt:o="num",left_y_axis_legend:l=null,right_y_axis_legend:h=null,line_legend:c=null,x_axis_legend:d=null,crop_floor:p=!0,pending_date:g=null,pending_legend:m=null,month_modulo:u=3,root_id:f="barid"}){if(console.log("renderChart",f),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg"),this.svg.attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select(this.chartOptions.chartName).append("div").attr("class","tooltip-container").text("Empty Tooltip"),i){this.xbars=d3.scaleLinear().domain([0,i.length-1]).range([this.dimensions.width-this.dimensions.margin.right,this.dimensions.margin.left]);let t=p?0:d3.min(i,(t=>t.VALUE));t>0&&(t=0);let e=d3.max(i,(t=>t.VALUE));0==e&&(e=1),this.ybars=d3.scaleLinear().domain([t,e]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top])}if(a){const t=n;this.xline=d3.scaleLinear().domain([t+0,t+a.length-1]).range([this.dimensions.width-this.dimensions.margin.right,this.dimensions.margin.left]);let e=p?0:d3.min(a,(t=>t.VALUE));e>0&&(e=0);let i=d3.max(a,(t=>t.VALUE));0==i&&(i=1),s&&(i=Math.max(i,d3.max(s,(t=>t.VALUE)))),this.yline=d3.scaleLinear().domain([e,i]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top])}i&&N.call(this,this.svg,i,this.xbars,this.ybars,{root_id:f,crop_floot:p}),a&&(V.call(this,this.svg,a,this.xline,this.yline,{line_legend:c,root_id:f,crop_floot:p}),null!=c&&J.call(this,this.svg,c,a,this.xline,this.yline)),s&&(V.call(this,this.svg,s,this.xline,this.yline,{root_id:"state-"+f,is_second_line:!0,crop_floot:p}),z.call(this,this.svg,this.xline,this.yline,{})),g&&m&&G.call(this,this.svg,i,this.xbars,this.ybars,{root_id:f,pending_date:g,pending_legend:m}),i?B.call(this,this.svg,i,this.xbars,this.ybars,{x_axis_legend:d,month_modulo:u,root_id:f}):a&&B.call(this,this.svg,a,this.xline,this.yline,{x_axis_legend:d,month_modulo:u,root_id:f}),a?(Y.call(this,this.svg,a,this.xline,this.yline,{y_axis_legend:l,left_y_fmt:r,root_id:f}),i&&h&&P.call(this,this.svg,i,this.xbars,this.ybars,{y_axis_legend:h,right_y_fmt:o,root_id:f})):i&&Y.call(this,this.svg,i,this.xbars,this.ybars,{y_axis_legend:l,left_y_fmt:r,root_id:f}),e&&e.call(this,this.svg),this.svg.on("mousemove focus",(t=>{let e=d3.pointer(t),s=function(t,e,i,a,s,n,r){let o=r[0],l=r[1],h=e.invert(o);if(h>=0&&h<=e.domain()[1]){let t=i.invert(l);if(t>=0&&t<=i.domain()[1]){let t=Math.round(h);if(l>=i(a[t].VALUE)-2)return t;let e=s(n[t].VALUE);if(Math.abs(e-l)<6)return t}}return null}(0,this.xbars,this.ybars,i,this.yline,a,e);null!=s?$.call(this,t,s,e,s,i[s],this.xbars,this.ybars):q.call(this)})).on("mouseleave touchend blur",(t=>{q.call(this)}))}class Z extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardConfirmedCases"),this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],this.stateData=null,c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=e+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),n(this),this.listenForLocations()}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t){this.regionName}getTooltipContent(t){const e=this.chartdata.time_series[this.chartOptions.seriesField].VALUES,i=this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,a={DATE:O(i[t].DATE),"7DAY_AVERAGE":_(i[t].VALUE,{format:"number",min_decimals:1}),CASES:_(e[t].VALUE,{format:"integer"})};let s=L(this.translationsObj.tooltipContent,a);return+T(i[t].DATE)>=+T(this.chartdata.latest[this.chartOptions.latestField].EPISODE_UNCERTAINTY_PERIOD)&&(s+=`<br><span class="pending-caveat">${this.translationsObj.pending_caveat}</span>`),s}renderComponent(t){console.log("Render component cases");let e=!1;"California"==t?this.statedata=this.chartdata:this.statedata&&(e=!0);let i=this.chartdata.latest[this.chartOptions.latestField];const a={total_confirmed_cases:_(i.total_confirmed_cases,{format:"integer"}),new_cases:_(i.new_cases,{format:"integer"}),new_cases_delta_1_day:_(Math.abs(i.new_cases_delta_1_day),{format:"percent"}),cases_per_100k_7_days:_(i.cases_per_100k_7_days,{format:"number",min_decimals:1}),REGION:t};"chartTitleState"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleState:this.translationsObj.chartTitleCounty,a):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitle,a)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1,a),this.translationsObj.post_chartLegend2=L(i.new_cases_delta_1_day>=0?this.translationsObj.chartLegend2Increase:this.translationsObj.chartLegend2Decrease,a),this.translationsObj.post_chartLegend3=L(this.translationsObj.chartLegend3,a),this.translationsObj.currentLocation=t,this.innerHTML=R.call(this,this.chartOptions,this.translationsObj),this.setupTabFilters();let s={tooltip_func:this.tooltip,extras_func:this.renderExtras,time_series_bars:this.chartdata.time_series[this.chartOptions.seriesField].VALUES,time_series_line:this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,root_id:this.chartOptions.rootId,left_y_axis_legend:this.translationsObj[this.chartConfigKey+"_leftYAxisLegend"],right_y_axis_legend:this.translationsObj[this.chartConfigKey+"_rightYAxisLegend"],right_y_fmt:"integer",x_axis_legend:this.translationsObj[this.chartConfigKey+"_"+this.chartConfigFilter+"_xAxisLegend"],line_legend:"California"==this.regionName?this.translationsObj.dayAverage:null};"reported"!=this.chartConfigFilter&&(s.pending_date=this.chartdata.latest[this.chartOptions.latestField].EPISODE_UNCERTAINTY_PERIOD,s.pending_legend=this.translationsObj.pending),e&&(s.time_series_state_line=this.statedata.time_series[this.chartOptions.seriesFieldAvg].VALUES),W.call(this,s)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.regionName=e,this.metadata=t.meta,this.chartdata=t.data,this.renderComponent(e)}.bind(this))}chartFilterSelectHandler(t){console.log("cases chartfilter"),this.chartConfigFilter=t.detail.filterKey,"reported"!=this.chartConfigFilter?(this.chartConfigFilter="episode",document.querySelector('cagov-chart-filter-buttons.js-filter-cases .small-tab[data-key="episode"]').classList.add("active"),document.querySelector('cagov-chart-filter-buttons.js-filter-cases .small-tab[data-key="reported"]').classList.remove("active")):(document.querySelector('cagov-chart-filter-buttons.js-filter-cases .small-tab[data-key="episode"]').classList.remove("active"),document.querySelector('cagov-chart-filter-buttons.js-filter-cases .small-tab[data-key="reported"]').classList.add("active")),this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],this.renderComponent(this.regionName)}tabFilterHandler(t){this.chartFilterSelectHandler(t);const e=new window.CustomEvent("cases-chart-filter-select",{detail:{filterKey:this.chartConfigFilter}});window.dispatchEvent(e)}setupTabFilters(){document.querySelector("cagov-chart-filter-buttons.js-filter-cases").addEventListener("filter-selected",this.tabFilterHandler.bind(this),!1)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){this.county=t.detail.county;let i=this.county.toLowerCase().replace(/ /g,"_"),a=e+this.chartOptions.dataUrlCounty.replace("<county>",i);this.retrieveData(a,t.detail.county),document.location.replace("#location-"+i)}.bind(this),!1),window.addEventListener("deaths-chart-filter-select",this.chartFilterSelectHandler.bind(this),!1)}}window.customElements.define("cagov-chart-dashboard-confirmed-cases",Z);class X extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardConfirmedDeaths"),this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=e+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),n(this),this.listenForLocations()}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t,e,i,a){}getTooltipContent(t){const e=this.chartdata.time_series[this.chartOptions.seriesField].VALUES,i=this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,a={DATE:O(i[t].DATE),"7DAY_AVERAGE":_(i[t].VALUE,{format:"number",min_decimals:1}),DEATHS:_(e[t].VALUE,{format:"integer"})};let s=L(this.translationsObj.tooltipContent,a);return+T(i[t].DATE)>=+T(this.chartdata.latest[this.chartOptions.latestField].DEATH_UNCERTAINTY_PERIOD)&&(s+=`<br><span class="pending-caveat">${this.translationsObj.pending_caveat}</span>`),s}renderComponent(t){console.log("Render component deaths",this);let e=!1;"California"==t?this.statedata=this.chartdata:this.statedata&&(e=!0);let i=this.chartdata.latest[this.chartOptions.latestField];const a={total_confirmed_deaths:_(i.total_confirmed_deaths,{format:"integer"}),new_deaths:_(i.new_deaths,{format:"integer"}),new_deaths_delta_1_day:_(Math.abs(i.new_deaths_delta_1_day),{format:"percent"}),deaths_per_100k_7_days:_(i.deaths_per_100k_7_days,{format:"number",min_decimals:1}),REGION:t};"chartTitleState"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleState:this.translationsObj.chartTitleCounty,a):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitle,a)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1,a),this.translationsObj.post_chartLegend2=L(i.new_deaths_delta_1_day>=0?this.translationsObj.chartLegend2Increase:this.translationsObj.chartLegend2Decrease,a),this.translationsObj.post_chartLegend3=L(this.translationsObj.chartLegend3,a),this.translationsObj.currentLocation=t,this.innerHTML=R.call(this,this.chartOptions,this.translationsObj),this.setupTabFilters();let s={tooltip_func:this.tooltip,extras_func:this.renderExtras,time_series_bars:this.chartdata.time_series[this.chartOptions.seriesField].VALUES,time_series_line:this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,root_id:this.chartOptions.rootId,left_y_axis_legend:this.translationsObj[this.chartConfigKey+"_leftYAxisLegend"],right_y_axis_legend:this.translationsObj[this.chartConfigKey+"_rightYAxisLegend"],right_y_fmt:"integer",x_axis_legend:this.translationsObj[this.chartConfigKey+"_"+this.chartConfigFilter+"_xAxisLegend"],line_legend:"California"==this.regionName?this.translationsObj.dayAverage:null};"reported"!=this.chartConfigFilter&&(s.pending_date=this.chartdata.latest[this.chartOptions.latestField].DEATH_UNCERTAINTY_PERIOD,s.pending_legend=this.translationsObj.pending),e&&(s.time_series_state_line=this.statedata.time_series[this.chartOptions.seriesFieldAvg].VALUES),W.call(this,s)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.regionName=e,this.metadata=t.meta,this.chartdata=t.data,this.renderComponent(e)}.bind(this))}chartFilterSelectHandler(t){console.log("deaths chartfilter"),this.chartConfigFilter=t.detail.filterKey,"reported"!=this.chartConfigFilter?(this.chartConfigFilter="death",document.querySelector('cagov-chart-filter-buttons.js-filter-deaths .small-tab[data-key="death"]').classList.add("active"),document.querySelector('cagov-chart-filter-buttons.js-filter-deaths .small-tab[data-key="reported"]').classList.remove("active")):(document.querySelector('cagov-chart-filter-buttons.js-filter-deaths .small-tab[data-key="death"]').classList.remove("active"),document.querySelector('cagov-chart-filter-buttons.js-filter-deaths .small-tab[data-key="reported"]').classList.add("active")),this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],this.renderComponent(this.regionName)}tabFilterHandler(t){this.chartFilterSelectHandler(t);const e=new window.CustomEvent("deaths-chart-filter-select",{detail:{filterKey:this.chartConfigFilter}});window.dispatchEvent(e)}setupTabFilters(){document.querySelector("cagov-chart-filter-buttons.js-filter-deaths").addEventListener("filter-selected",this.tabFilterHandler.bind(this),!1)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){this.county=t.detail.county;let i=e+this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_"));this.retrieveData(i,t.detail.county)}.bind(this),!1),window.addEventListener("cases-chart-filter-select",this.chartFilterSelectHandler.bind(this),!1)}}window.customElements.define("cagov-chart-dashboard-confirmed-deaths",X);class Q extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardTotalTests"),this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=e+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),n(this),this.listenForLocations()}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t,e,i,a){}getTooltipContent(t){const e=this.chartdata.time_series[this.chartOptions.seriesField].VALUES,i=this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,a={DATE:O(i[t].DATE),"7DAY_AVERAGE":_(i[t].VALUE,{format:"number",min_decimals:1}),TOTAL_TESTS:_(e[t].VALUE,{format:"integer"})};let s=L(this.translationsObj.tooltipContent,a);return+T(i[t].DATE)>=+T(this.chartdata.latest[this.chartOptions.latestField].TESTING_UNCERTAINTY_PERIOD)&&(s+=`<br><span class="pending-caveat">${this.translationsObj.pending_caveat}</span>`),s}renderComponent(t){let e=!1;"California"==t?this.statedata=this.chartdata:this.statedata&&(e=!0);let i=this.chartdata.latest[this.chartOptions.latestField];const a={total_tests_performed:_(i.total_tests_performed,{format:"integer"}),new_tests_reported:_(Math.abs(i.new_tests_reported),{format:"integer"}),new_tests_reported_delta_1_day:_(Math.abs(i.new_tests_reported_delta_1_day),{format:"percent"}),REGION:t};"chartTitleState"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleState:this.translationsObj.chartTitleCounty,a):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitle,a)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1,a),this.translationsObj.post_chartLegend2=L(i.new_tests_reported_delta_1_day>=0?this.translationsObj.chartLegend2Increase:this.translationsObj.chartLegend2Decrease,a),this.translationsObj.currentLocation=t,this.innerHTML=R.call(this,this.chartOptions,this.translationsObj),this.setupTabFilters();let s={tooltip_func:this.tooltip,extras_func:this.renderExtras,time_series_bars:this.chartdata.time_series[this.chartOptions.seriesField].VALUES,time_series_line:this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,root_id:this.chartOptions.rootId,left_y_axis_legend:this.translationsObj[this.chartConfigKey+"_leftYAxisLegend"],right_y_axis_legend:this.translationsObj[this.chartConfigKey+"_rightYAxisLegend"],right_y_fmt:"integer",x_axis_legend:this.translationsObj[this.chartConfigKey+"_"+this.chartConfigFilter+"_xAxisLegend"],line_legend:"California"==this.regionName?this.translationsObj.dayAverage:null};"reported"!=this.chartConfigFilter&&(s.pending_date=this.chartdata.latest[this.chartOptions.latestField].TESTING_UNCERTAINTY_PERIOD,s.pending_legend=this.translationsObj.pending),e&&(s.time_series_state_line=this.statedata.time_series[this.chartOptions.seriesFieldAvg].VALUES),W.call(this,s)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.regionName=e,this.metadata=t.meta,this.chartdata=t.data,this.renderComponent(e)}.bind(this))}setupTabFilters(){let t=document.querySelector("cagov-chart-filter-buttons.js-filter-tests");t&&t.addEventListener("filter-selected",function(t){this.chartConfigFilter=t.detail.filterKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],this.chartOptions.dataUrl,this.county&&"California"!==this.county&&this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_")),this.renderComponent(this.regionName)}.bind(this),!1)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){this.county=t.detail.county;let i=e+this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_"));this.retrieveData(i,t.detail.county)}.bind(this),!1)}}window.customElements.define("cagov-chart-dashboard-total-tests",Q);class tt extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardPositivityRate"),this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],this.stateData=null,c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=e+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),n(this),this.listenForLocations()}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t,e,i,a){}getTooltipContent(t){const e=this.chartdata.time_series[this.chartOptions.seriesField].VALUES,i=this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,a={DATE:O(i[t].DATE),"7DAY_POSRATE":_(i[t].VALUE,{format:"percent"}),TOTAL_TESTS:_(e[t].VALUE,{format:"integer"})};let s=L(this.translationsObj.tooltipContent,a);return+T(i[t].DATE)>=+T(this.chartdata.latest[this.chartOptions.latestField].TESTING_UNCERTAINTY_PERIOD)&&(s+=`<br><span class="pending-caveat">${this.translationsObj.pending_caveat}</span>`),s}renderComponent(t){let e=!1;"California"==t?this.statedata=this.chartdata:this.statedata&&(e=!0);let i=this.chartdata.latest[this.chartOptions.latestField];const a={test_positivity_7_days:_(i.test_positivity_7_days,{format:"percent"}),test_positivity_7_days_delta_7_days:_(Math.abs(i.test_positivity_7_days_delta_7_days),{format:"percent"}),REGION:t};"chartTitleState"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleState:this.translationsObj.chartTitleCounty,a):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitle,a)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1,a),this.translationsObj.post_chartLegend2=L(i.test_positivity_7_days_delta_7_days>=0?this.translationsObj.chartLegend2Increase:this.translationsObj.chartLegend2Decrease,a),this.translationsObj.currentLocation=t,this.innerHTML=R.call(this,this.chartOptions,this.translationsObj);let s={tooltip_func:this.tooltip,extras_func:this.renderExtras,time_series_bars:this.chartdata.time_series[this.chartOptions.seriesField].VALUES,time_series_line:this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,left_y_fmt:"pct",root_id:"pos-rate",left_y_axis_legend:this.translationsObj.leftYAxisLegend,right_y_axis_legend:this.translationsObj.rightYAxisLegend,right_y_fmt:"integer",x_axis_legend:this.translationsObj.xAxisLegend,line_legend:"California"==this.regionName?this.translationsObj.dayRate:null,pending_date:this.chartdata.latest[this.chartOptions.latestField].TESTING_UNCERTAINTY_PERIOD,pending_legend:this.translationsObj.pending};e&&(s.time_series_state_line=this.statedata.time_series[this.chartOptions.seriesFieldAvg].VALUES),W.call(this,s)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.regionName=e,this.metadata=t.meta,this.chartdata=t.data,this.renderComponent(e)}.bind(this))}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){this.county=t.detail.county;let i=e+this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_"));this.retrieveData(i,t.detail.county)}.bind(this),!1)}}function et(t,e,i,a,{root_id:s="barid",is_second_line:n=!1,crop_floor:r=!0}){a.domain()[1],i.domain()[1],t.append("g").attr("class","fg-line "+s+(n?" second-line":"")).append("path").datum(e).attr("d",d3.line().x((function(t,e){return i(e)})).y((function(t){return a(r?Math.max(0,t.VALUE):t.VALUE)})))}function it(t,e,i,a,{root_id:s="barid",crop_floor:n=!0}){n||console.log("NOT CROP FLOOR");let r=t.append("g").attr("class","fg-bars "+s).selectAll("g").data(e).enter().append("g");n?r.append("rect").attr("x",((t,e)=>i(e))).attr("y",(t=>a(t.VALUE))).attr("width",2).attr("height",(t=>Math.max(a(0)-a(t.VALUE),0))).attr("id",((t,e)=>s+"-"+e)):r.append("rect").attr("x",((t,e)=>i(e))).attr("y",(t=>Math.min(a(0),a(t.VALUE)))).attr("width",2).attr("height",(t=>Math.abs(a(0)-a(t.VALUE)))).attr("id",((t,e)=>s+"-"+e))}function at(t,e,i,a,{pending_date:s=null,pending_legend:n=null,root_id:r="barid"}){let o=t.append("g").attr("class","pending-block");i.domain()[1];const l=a.domain()[0],h=a.domain()[1];let c=0;for(let t=0;t<e.length&&(c+=1,e[t].DATE!=s);++t);o.append("rect").attr("x",i(c)).attr("y",a(h)).attr("width",i(0)-i(c)).attr("height",a(l)-a(h)),o.append("text").text(n).attr("x",i(0)).attr("y",a(h)-4)}function st(t,e,i,{county_legend:a="County",state_legend:s="State"}){let n=this.dimensions.height-6,r=this.dimensions.margin.left,o=t.append("g").attr("class","county-legend");o.append("rect").attr("x",r).attr("y",n).attr("width",24).attr("height",1),o.append("text").text(a).attr("x",r+36).attr("y",n),o=t.append("g").attr("class","state-legend"),o.append("rect").attr("x",r+85).attr("y",n).attr("width",24).attr("height",1),o.append("text").text(s).attr("x",r+85+36).attr("y",n)}function nt(t,e,i,a,{x_axis_legend:s=null,month_modulo:n=3,root_id:r="barid"}){const o=this.dimensions.height-this.dimensions.margin.bottom;let l=t.append("g").attr("class","date-axis");e.forEach(((t,e)=>{const a=t.DATE.split("-"),s=parseInt(a[1]);if(s%n==0){if(1==parseInt(a[2])){const t=s+"/1";let a=l.append("g").attr("class","x-tick");a.append("line").attr("x1",i(e)).attr("y1",o+1).attr("x2",i(e)).attr("y2",o+1+4),a.append("text").text(t).attr("x",i(e)).attr("y",o+1+4+2)}}})),s&&l.append("text").attr("class","x-axis-legend").attr("style","font-family:sans-serif; font-weight:300; font-size: 0.75rem; fill:black;text-anchor: end; dominant-baseline:middle;").text(s).attr("x",i(0)).attr("y",this.dimensions.height-6)}function rt(t,{hint:e="num",digits:i=0}){if("pct"==e){const e=t<.01?2:t<.1?1:0;return new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:e,maximumFractionDigits:e}).format}if(t<4e3){const i="integer"==e?0:t<.1?2:t<10?1:0;return new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:i,maximumFractionDigits:i}).format}if(t<1e6){const e=t<4e3?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e3)+"K"}}if(t<1e9){const e=t<4e6?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e6)+"M"}}{const e=t<4e9?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e3)+"M"}}}function ot(t,e,i,a,{y_axis_legend:s=null,left_y_fmt:n="num",root_id:r="barid"}){const o=dt(a,{hint:n});let l=t.append("g").attr("class","left-y-axis");const h=a.domain()[1],c=i.domain()[0],d=i.domain()[1];let p=rt(h,{hint:n});for(let t=0;t<=h;t+=o){let e=p(t),s=l.append("g").attr("class","y-tick");s.append("line").attr("style","stroke-width: 0.5px; stroke:black; opacity:0.15;").attr("x1",i(d)).attr("y1",a(t)).attr("x2",i(c)).attr("y2",a(t)),s.append("text").text(e).attr("style","font-family:sans-serif; font-weight:400; font-size: 0.75rem; fill:black;text-anchor: end; dominant-baseline:middle;").attr("x",i(d)-10).attr("y",a(t))}s&&l.append("text").attr("class","left-y-axis-legend").attr("style","font-family:sans-serif; font-weight:700; font-size: 0.75rem; fill:black;text-anchor: start; dominant-baseline:hanging;").text(s).attr("x",0).attr("y",4)}function lt(t,e,i,a,{y_axis_legend:s=null,right_y_fmt:n="num",root_id:r="barid"}){const o=dt(a,{hint:n});let l=t.append("g").attr("class","right-y-axis").attr("style","stroke-width: 0.5px; stroke:#608cbd;");const h=a.domain()[1],c=i.domain()[0];let d=rt(h,{hint:n});for(let t=0;t<=h;t+=o){let e=d(t);l.append("g").attr("class","y-tick").append("text").text(e).attr("style","font-family:sans-serif; font-weight:400; font-size: 0.75rem; fill:#1f2574; text-anchor:start; dominant-baseline:middle; ").attr("x",i(c)+24).attr("y",a(t))}s&&l.append("text").attr("class","right-y-axis-legend").text(s).attr("style","font-family:sans-serif; font-weight:700; font-size: 0.75rem; fill:#1f2574; text-anchor:end; dominant-baseline:hanging; ").attr("x",this.dimensions.width).attr("y",4)}function ht(t,e,i,a,s,n,r){let o=this.tooltip,l=this.getTooltipContent(e);o.html(l),o.style("left",`${Math.min(this.dimensions.width-280,t.offsetX)}px`),o.style("top",`${t.offsetY+220}px`),o.style("visibility","visible"),this.svg.selectAll("g.tt-marker").remove(),this.svg.append("g").attr("class","tt-marker").append("rect").attr("x",n(a)-1).attr("y",r(s.VALUE)).attr("width",3).attr("height",Math.max(0,r(0)-r(s.VALUE)))}function ct(){this.tooltip,this.tooltip.style("visibility","hidden"),this.svg.selectAll("g.tt-marker").remove()}function dt(t,{hint:e="num"}){const i=t.domain()[1],a=Math.log10(i),s=Math.floor(a),n=a-s;if(n<.176)var r=5;else if(n<.477)r=2;else if(n<.778)r=1;else r=.5;let o=Math.pow(10,s)/r;return"integer"==e&&o<1&&(o=1),o}function pt(t,e,i,a,s){if(null!=e){let t=Math.floor(2*i.length/3),n=i[t],r=this.dimensions.width/3,o=this.dimensions.height/4,l=a(t),h=s(n.VALUE),c=6,d=Math.atan2(h-o,l-r);r+=Math.cos(d)*c,o+=Math.sin(d)*c,l+=Math.cos(d+Math.PI)*c,h+=Math.sin(d+Math.PI)*c;let p=this.svg.append("g").attr("class","line-legend");p.append("text").text(e).attr("x",this.dimensions.width/3).attr("y",this.dimensions.height/4),p.append("line").attr("x1",r).attr("y1",o).attr("x2",l).attr("y2",h)}}function gt({tooltip_func:t=null,extras_func:e=null,time_series_bars:i=null,time_series_line:a=null,time_series_state_line:s=null,line_date_offset:n=0,left_y_fmt:r="num",right_y_fmt:o="num",left_y_axis_legend:l=null,right_y_axis_legend:h=null,line_legend:c=null,x_axis_legend:d=null,crop_floor:p=!0,pending_date:g=null,pending_legend:m=null,month_modulo:u=3,root_id:f="barid"}){if(console.log("renderChart",f),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg"),this.svg.attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select(this.chartOptions.chartName).append("div").attr("class","tooltip-container").text("Empty Tooltip"),i){this.xbars=d3.scaleLinear().domain([0,i.length-1]).range([this.dimensions.width-this.dimensions.margin.right,this.dimensions.margin.left]);let t=p?0:d3.min(a,(t=>t.VALUE));t>0&&(t=0);let e=d3.max(a,(t=>t.VALUE));0==e&&(e=1),this.ybars=d3.scaleLinear().domain([t,e]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top])}if(a){const t=n;this.xline=d3.scaleLinear().domain([t+0,t+a.length-1]).range([this.dimensions.width-this.dimensions.margin.right,this.dimensions.margin.left]);let e=p?0:d3.min(a,(t=>t.VALUE));e>0&&(e=0);let i=d3.max(a,(t=>t.VALUE));0==i&&(i=1),s&&(i=Math.max(i,d3.max(s,(t=>t.VALUE)))),this.yline=d3.scaleLinear().domain([e,i]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top])}i&&it.call(this,this.svg,i,this.xbars,this.ybars,{root_id:f,crop_floot:p}),a&&(et.call(this,this.svg,a,this.xline,this.yline,{line_legend:c,root_id:f,crop_floot:p}),null!=c&&pt.call(this,this.svg,c,a,this.xline,this.yline)),s&&(et.call(this,this.svg,s,this.xline,this.yline,{root_id:"state-"+f,is_second_line:!0,crop_floot:p}),st.call(this,this.svg,this.xline,this.yline,{})),g&&m&&at.call(this,this.svg,i,this.xbars,this.ybars,{root_id:f,pending_date:g,pending_legend:m}),i?nt.call(this,this.svg,i,this.xbars,this.ybars,{x_axis_legend:d,month_modulo:u,root_id:f}):a&&nt.call(this,this.svg,a,this.xline,this.yline,{x_axis_legend:d,month_modulo:u,root_id:f}),a?(ot.call(this,this.svg,a,this.xline,this.yline,{y_axis_legend:l,left_y_fmt:r,root_id:f}),i&&h&&lt.call(this,this.svg,i,this.xbars,this.ybars,{y_axis_legend:h,right_y_fmt:o,root_id:f})):i&&ot.call(this,this.svg,i,this.xbars,this.ybars,{y_axis_legend:l,left_y_fmt:r,root_id:f}),e&&e.call(this,this.svg),this.svg.on("mousemove focus",(t=>{let e=d3.pointer(t),s=function(t,e,i,a,s,n,r){let o=r[0],l=r[1],h=e.invert(o);if(h>=0&&h<=e.domain()[1]){let t=i.invert(l);if(t>=0&&t<=i.domain()[1]){let t=Math.round(h);if(l>=i(a[t].VALUE)-2)return t;let e=s(n[t].VALUE);if(Math.abs(e-l)<6)return t}}return null}(0,this.xbars,this.ybars,i,this.yline,a,e);null!=s?ht.call(this,t,s,e,s,i[s],this.xbars,this.ybars):ct.call(this)})).on("mouseleave touchend blur",(t=>{ct.call(this)}))}window.customElements.define("cagov-chart-dashboard-positivity-rate",tt);class mt extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardPatients"),this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"],this.chartBreakpointValues=JSON.parse(JSON.stringify(this.chartBreakpointValues)),this.dimensions=this.chartBreakpointValues,this.dimensions.margin.right=20;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=e+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),n(this),this.listenForLocations()}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t,e,i,a){}getTooltipContent(t){const e=this.chartdata.time_series[this.chartOptions.seriesField].VALUES,i=this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,a={DATE:O(e[t].DATE),"14DAY_AVERAGE":_(i[t].VALUE,{format:"number",min_decimals:1}),TOTAL_HOSPITALIZED:_(e[t].VALUE,{format:"integer"})};return L(this.translationsObj.tooltipContent,a)}renderComponent(t){console.log("Setting up patients replacements",this.chartConfigFilter,this.chartConfigKey,t);var e=this.chartdata.latest[this.chartOptions.latestField];const i={TOTAL:_(e.TOTAL,{format:"integer"}),CHANGE:_(Math.abs(e.CHANGE),{format:"integer"}),CHANGE_FACTOR:_(Math.abs(e.CHANGE_FACTOR),{format:"percent"}),REGION:t};"icu"==this.chartConfigFilter?("chartTitleStateICU"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleStateICU:this.translationsObj.chartTitleCountyICU,i):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitleICU,i)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1ICU,i),this.translationsObj.post_chartLegend2=L(e.CHANGE_FACTOR>=0?this.translationsObj.chartLegend2IncreaseICU:this.translationsObj.chartLegend2DecreaseICU,i),this.translationsObj.currentLocation=t):("chartTitleState"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleState:this.translationsObj.chartTitleCounty,i):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitle,i)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1,i),this.translationsObj.post_chartLegend2=L(e.CHANGE_FACTOR>=0?this.translationsObj.chartLegend2Increase:this.translationsObj.chartLegend2Decrease,i),this.translationsObj.currentLocation=t),this.innerHTML=R.call(this,this.chartOptions,this.translationsObj),this.setupTabFilters();let a={tooltip_func:this.tooltip,extras_func:this.renderExtras,time_series_bars:this.chartdata.time_series[this.chartOptions.seriesField].VALUES,time_series_line:this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,root_id:this.chartOptions.rootId,x_axis_legend:this.translationsObj.xAxisLegend,line_legend:this.translationsObj.dayAverage,month_modulo:2};gt.call(this,a)}retrieveData(t,e){if("Alpine"==e){let t={meta:{PUBLISHED_DATE:A(0),coverage:e},data:{latest:{HOSPITALIZED_PATIENTS:{TOTAL:0,CHANGE:0,CHANGE_FACTOR:0,POPULATION:13354},ICU_PATIENTS:{TOTAL:0,CHANGE:0,CHANGE_FACTOR:0,POPULATION:13354}},time_series:{HOSPITALIZED_PATIENTS:{DATE_RANGE:{MINIMUM:"2020-03-30",MAXIMUM:A(-1)},VALUES:[]},ICU_PATIENTS:{DATE_RANGE:{MINIMUM:"2020-03-30",MAXIMUM:A(-1)},VALUES:[]},HOSPITALIZED_PATIENTS_14_DAY_AVG:{DATE_RANGE:{MINIMUM:"2020-03-30",MAXIMUM:A(-1)},VALUES:[]},ICU_PATIENTS_14_DAY_AVG:{DATE_RANGE:{MINIMUM:"2020-03-30",MAXIMUM:A(-1)},VALUES:[]}}}},i=T(t.data.time_series.HOSPITALIZED_PATIENTS.DATE_RANGE.MINIMUM),a=new Date;for(;+i<+a;)t.data.time_series.HOSPITALIZED_PATIENTS.VALUES.push({DATE:w(i),VALUE:0}),t.data.time_series.ICU_PATIENTS.VALUES.push({DATE:w(i),VALUE:0}),t.data.time_series.HOSPITALIZED_PATIENTS_14_DAY_AVG.VALUES.push({DATE:w(i),VALUE:0}),t.data.time_series.ICU_PATIENTS_14_DAY_AVG.VALUES.push({DATE:w(i),VALUE:0}),i.setDate(i.getDate()+1);this.metadata=t.meta,this.chartdata=t.data,this.regionName=e,this.renderComponent(e)}else window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.chartdata=t.data,this.regionName=e,this.renderComponent(e)}.bind(this))}setupTabFilters(){document.querySelector("cagov-chart-filter-buttons.js-filter-patients").addEventListener("filter-selected",function(t){this.chartConfigFilter=t.detail.filterKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],this.chartOptions.dataUrl,this.county&&"California"!==this.county&&this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_")),this.renderComponent(this.regionName)}.bind(this),!1)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){this.county=t.detail.county;let i=e+this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_"));this.retrieveData(i,t.detail.county)}.bind(this),!1)}}window.customElements.define("cagov-chart-dashboard-patients",mt);class ut extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovDashboardICUBeds"),this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,this.chartOptions=M[this.chartConfigKey][this.chartConfigFilter],c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"],this.chartBreakpointValues=JSON.parse(JSON.stringify(this.chartBreakpointValues)),this.dimensions=this.chartBreakpointValues,this.dimensions.margin.right=20;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=M[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=e+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),n(this),this.listenForLocations()}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t,e,i,a){}getTooltipContent(t){const e=this.chartdata.time_series[this.chartOptions.seriesField].VALUES;this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES;const i={DATE:O(e[t].DATE),VALUE:_(e[t].VALUE,{format:"integer"})};return L(this.translationsObj.tooltipContent,i)}renderComponent(t){var e=this.chartdata.latest[this.chartOptions.latestField];const i={TOTAL:_(e.TOTAL,{format:"integer"}),CHANGE:_(Math.abs(e.CHANGE),{format:"integer"}),CHANGE_FACTOR:_(Math.abs(e.CHANGE_FACTOR),{format:"percent"}),REGION:t};"chartTitleState"in this.translationsObj?this.translationsObj.post_chartTitle=L("California"==t?this.translationsObj.chartTitleState:this.translationsObj.chartTitleCounty,i):this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitle,i)+" "+t,this.translationsObj.post_chartLegend1=L(this.translationsObj.chartLegend1,i),this.translationsObj.post_chartLegend2=L(e.CHANGE_FACTOR>=0?this.translationsObj.chartLegend2Increase:this.translationsObj.chartLegend2Decrease,i),this.translationsObj.currentLocation=t,this.innerHTML=R.call(this,this.chartOptions,this.translationsObj);let a={tooltip_func:this.tooltip,extras_func:this.renderExtras,time_series_bars:this.chartdata.time_series[this.chartOptions.seriesField].VALUES,time_series_line:this.chartdata.time_series[this.chartOptions.seriesFieldAvg].VALUES,root_id:this.chartOptions.rootId,x_axis_legend:this.translationsObj.xAxisLegend,month_modulo:2};W.call(this,a)}retrieveData(t,e){if("Alpine"==e){let t={meta:{PUBLISHED_DATE:A(0),coverage:e},data:{latest:{ICU_BEDS:{TOTAL:0,CHANGE:0,CHANGE_FACTOR:0,POPULATION:13354}},time_series:{ICU_BEDS:{DATE_RANGE:{MINIMUM:"2020-03-30",MAXIMUM:A(-1)},VALUES:[]}}}},i=T(t.data.time_series.ICU_BEDS.DATE_RANGE.MINIMUM),a=new Date;for(;+i<+a;)t.data.time_series.ICU_BEDS.VALUES.push({DATE:w(i),VALUE:0}),i.setDate(i.getDate()+1);this.metadata=t.meta,this.chartdata=t.data,this.regionName=e,this.renderComponent(e)}else window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.chartdata=t.data,this.renderComponent(e)}.bind(this))}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){this.county=t.detail.county;let i=e+this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,"_"));this.retrieveData(i,t.detail.county)}.bind(this),!1)}}window.customElements.define("cagov-chart-dashboard-icu-beds",ut);function ft(t,{post_chartTitle:e="chart title",post_chartImpactStatement:i="chart title",post_yaxis_legend:a="y axis title",post_series1_legend:s="Vaccinated",post_series2_legend:n="Unvaccinated",post_series3_legend:r="All cases",mode_3lines:o=!1}){let l="";return o&&(l+='&nbsp;&nbsp;&nbsp;<span class="series3-legend-line"></span> '+r),`\n    <div class="py-2">\n      <div class="bg-white pt-2 pb-1">\n      <div class="chart-title noborder">${i}</div>\n      <div class="mx-auto postvax-chart">\n            <div class="y-axis-title">${a}\n              <span class="chart-legend">\n                <svg class="series2-legend-line legend-line" data-name="legend-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 15"><path d="M0,6L24,6Z" /></svg>\n                 ${n}&nbsp;&nbsp;&nbsp;\n               <svg class="series1-legend-line legend-line" data-name="legend-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 15"><path d="M0,6L24,6Z" /></svg>\n                 ${s}${l}\n               </span>\n            </div>\n            <div class="svg-holder"></div>\n        </div>\n      </div>\n    </div>\n    `}l('cagov-chart-dashboard-postvax-chart .chart-title {\n  font-weight: 300;\n  font-size: 1.2rem;\n  margin-bottom: 2rem; }\n\ncagov-chart-dashboard-postvax-chart .chart-title.noborder {\n  border: none;\n  margin-bottom: 2rem; }\n\n.postvax-chart {\n  max-width: 615px; }\n  .postvax-chart .svg-holder g.fg-line path {\n    fill: none;\n    stroke: #1f2574;\n    stroke-width: 2px; }\n  .postvax-chart .svg-holder g.fg-line.line_s1 path {\n    stroke: #1f2574; }\n  .postvax-chart .svg-holder g.fg-line.line_s2 path {\n    stroke: #dc4567; }\n  .postvax-chart .svg-holder g.fg-line.line_s3 path {\n    stroke: #cccccc; }\n  .postvax-chart .svg-holder g.fg-line.line_s3 path {\n    stroke-dasharray: "1 3"; }\n  .postvax-chart .svg-holder g.date-axis line {\n    stroke-width: 0.5px;\n    stroke: black; }\n  .postvax-chart .svg-holder g.date-axis text {\n    font-weight: 300;\n    font-size: 0.85rem;\n    fill: black; }\n  .postvax-chart .svg-holder g.date-axis text {\n    text-anchor: middle;\n    dominant-baseline: hanging; }\n  .postvax-chart .svg-holder g.date-axis text.x-axis-legend {\n    font-weight: 300;\n    text-anchor: end;\n    dominant-baseline: middle; }\n  .postvax-chart .svg-holder g.left-y-axis line {\n    stroke-width: 0.5px;\n    stroke: black;\n    opacity: 0.15; }\n  .postvax-chart .svg-holder g.left-y-axis text {\n    font-weight: 300;\n    font-size: 0.85rem;\n    fill: black; }\n  .postvax-chart .svg-holder g.left-y-axis text {\n    text-anchor: end;\n    dominant-baseline: middle; }\n  .postvax-chart .svg-holder g.left-y-axis text.left-y-axis-legend {\n    font-weight: 300;\n    font-size: 0.85rem;\n    text-anchor: start;\n    dominant-baseline: hanging; }\n  .postvax-chart .svg-holder g.tt-marker {\n    fill: black;\n    opacity: 0.15; }\n  .postvax-chart .svg-holder g.pending-block-postvax rect {\n    opacity: 0.4; }\n  .postvax-chart .svg-holder g.pending-block-postvax text {\n    font-weight: 300;\n    font-size: 0.85rem;\n    fill: black; }\n  .postvax-chart .svg-holder g.pending-block-postvax text {\n    text-anchor: end;\n    dominant-baseline: auto; }\n  .postvax-chart .y-axis-title {\n    font-weight: 300;\n    font-size: 0.85rem; }\n  .postvax-chart span.chart-legend {\n    float: right; }\n  .postvax-chart svg.legend-line {\n    width: 24px;\n    height: 15px; }\n  .postvax-chart svg.legend-line path {\n    stroke-width: 3; }\n  .postvax-chart svg.series2-legend-line path {\n    stroke: #dc4567; }\n  .postvax-chart svg.series1-legend-line path {\n    stroke: #1f2574; }\n  .postvax-chart svg.series3-legend-line path {\n    stroke: #cccccc; }\n  .postvax-chart div.tooltip-container {\n    font-weight: 300;\n    font-size: 0.75rem;\n    line-height: 2;\n    color: black;\n    text-align: center; }\n  .postvax-chart .tooltip-container {\n    position: absolute;\n    z-index: 10;\n    visibility: hidden;\n    background: #fff;\n    width: 280px; }\n  .postvax-chart .tooltip-container {\n    pointer-events: none;\n    /* padding: 10px; */\n    padding: 1rem 2rem;\n    box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.14);\n    /* box-shadow: -12px 11px 5px -4px rgba(0, 0, 0, 0.4); */\n    border: none; }\n  .postvax-chart .pending-caveat {\n    font-style: italic; }\n  .postvax-chart a.dlbutton {\n    border-radius: 3px;\n    background-color: aqua;\n    color: blue;\n    font-weight: 300;\n    font-size: 0.5rem; }\n\n.diagonal-stripe-1 {\n  background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMCcgaGVpZ2h0PScxMCc+CiAgPHJlY3Qgd2lkdGg9JzEwJyBoZWlnaHQ9JzEwJyBmaWxsPSd3aGl0ZScvPgogIDxwYXRoIGQ9J00tMSwxIGwyLC0yCiAgICAgICAgICAgTTAsMTAgbDEwLC0xMAogICAgICAgICAgIE05LDExIGwyLC0yJyBzdHJva2U9J2JsYWNrJyBzdHJva2Utd2lkdGg9JzEnLz4KPC9zdmc+Cg==");\n  background-repeat: repeat; }\n\n.d-hide {\n  display: none; }\n');var yt={cases:{weeks:{chartName:"#postvax-cases-chart",series_fields:["BREAKTHROUGH_CASE_RATE","UNVAX_CASE_RATE"],series_colors:["#1f2574","#dc4567"],x_axis_field:"DATE",dataUrl:"postvax/california.json",days_to_show:120,root_id:"postvax-cases",pending_days:7,pre_mult:1}},hospitalizations:{weeks:{chartName:"#postvax-hospitalizations-chart",series_fields:["BREAKTHROUGH_HOSP_RATE","UNVAX_HOSP_RATE"],series_colors:["#1f2574","#dc4567"],x_axis_field:"DATE",dataUrl:"postvax/california.json",days_to_show:120,earliest_date:"2021-07-24",root_id:"postvax-hospitalizations",pending_days:14,pre_mult:10}},deaths:{weeks:{chartName:"#postvax-deaths-chart",series_fields:["BREAKTHROUGH_DEATH_DOD_RATE","UNVAX_DEATH_DOD_RATE"],series_colors:["#1f2574","#dc4567"],x_axis_field:"DATE",dataUrl:"postvax/california.json",days_to_show:120,root_id:"postvax-deaths",pending_days:21,pre_mult:10}},desktop:{fontSize:14,width:615,height:400,margin:{left:50,top:30,right:2,bottom:45}},tablet:{fontSize:14,width:400,height:300,margin:{left:50,top:30,right:2,bottom:45}},mobile:{fontSize:12,width:400,height:300,margin:{left:50,top:30,right:2,bottom:45}},retina:{fontSize:12,width:400,height:300,margin:{left:50,top:30,right:2,bottom:45}}};function bt(t,e,i,a,s,{root_id:n="barid",line_id:r="line_s0",color:o="black",crop_floor:l=!0}){s.domain()[1],a.domain()[1];let h=t.append("g").attr("class","fg-line "+n+" "+r);"line_s3"==r&&h.attr("stroke-dasharray","2 6"),h.append("path").datum(e).attr("d",d3.line().x((function(t,e){return a(e)})).y((function(t){return s(l?Math.max(0,t[i]):t[i])})))}function _t(t,e,i,a,s,{week_modulo:n=3,root_id:r="barid"}){const o=this.dimensions.height-this.dimensions.margin.bottom;let l=t.append("g").attr("class","date-axis");e.forEach(((t,s)=>{const r=t[i].split("-"),h=parseInt(r[0]),c=parseInt(r[1]);if(s%n==0){const t=parseInt(r[2]);let i=l.append("g").attr("class","x-tick");if(0==s||s==e.length-1){const e=c+"/"+t+"/"+h;let n=0==s?"start":"end";i.append("text").text(e).attr("style","font-family:sans-serif; font-weight:300; font-size: 0.85rem; fill:black;text-anchor: "+n+"; dominant-baseline:hanging;").attr("x",a(s)).attr("y",o+1+4+12)}}}))}function vt(t,e,i,{y_fmt:a="num",root_id:s="barid"}){const n=function(t,{hint:e="num"}){const i=t.domain()[1],a=Math.log10(i),s=Math.floor(a),n=Math.pow(10,s),r=a-s;if(r<.176)var o=5;else if(r<.477)o=2;else if(r<.778)o=1;else o=.5;let l=n/o;"integer"==e&&l<1&&(l=1);return l}(i,{hint:a});let r=t.append("g").attr("class","left-y-axis");const o=i.domain()[1],l=e.domain()[0],h=e.domain()[1];let c=function(t,{hint:e="num",digits:i=0}){if("pct"==e){const e=t<.01?2:t<.1?1:0;return new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:e,maximumFractionDigits:e}).format}if(t<4e3){const i="integer"==e?0:t<.1?2:t<10?1:0;return new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:i,maximumFractionDigits:i}).format}if(t<1e6){const e=t<4e3?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e3)+"K"}}if(t<1e9){const e=t<4e6?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e6)+"M"}}{const e=t<4e9?1:0,i=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:e,maximumFractionDigits:e});return function(t){return i.format(t/1e3)+"M"}}}(o,{hint:a});for(let t=0;t<=o;t+=n){let a=c(t),s=r.append("g").attr("class","y-tick");s.append("line").attr("style","stroke-width: 0.5px; stroke:black; opacity:0.15;").attr("x1",e(h)).attr("y1",i(t)).attr("x2",e(l)).attr("y2",i(t)),s.append("text").text(a).attr("style","font-family:sans-serif; font-weight:300; font-size: 0.85rem; fill:black;text-anchor: end; dominant-baseline:middle;").attr("x",e(l)-10).attr("y",i(t))}}function xt(t,e,i,a,s){let n=this.tooltip,r=this.getTooltipContent(i);n.html(r),n.style("left",`${Math.min(this.dimensions.width-280,t.offsetX)}px`),n.style("top",`${t.offsetY+120}px`),n.style("visibility","visible"),this.svg.selectAll("g.tt-marker").remove();const o=this.dimensions.margin.top,l=this.dimensions.height-this.dimensions.margin.bottom-o;this.svg.append("g").attr("class","tt-marker").append("rect").attr("x",a(i)-.5).attr("y",o).attr("width",1).attr("height",l)}function Et(){this.tooltip,this.tooltip.style("visibility","hidden"),this.svg.selectAll("g.tt-marker").remove()}function Tt({tooltip_func:t=null,extras_func:e=null,chartdata:i=null,series_fields:a=null,series_colors:s=null,x_axis_field:n=null,line_date_offset:r=0,y_fmt:o="num",crop_floor:l=!1,root_id:h="postvaxid"}){console.log("renderChart",h),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg"),this.svg.attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]),this.svg.append("g").attr("transform","translate(0,0)").attr("style","fill:#CCCCCC;"),this.tooltip=d3.select(this.chartOptions.chartName).append("div").attr("class","tooltip-container").text("Empty Tooltip");let c=Math.max(d3.max(i,(t=>t[a[0]])),d3.max(i,(t=>t[a[1]])));this.yline=d3.scaleLinear().domain([0,c]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top]);const d=r;this.xline=d3.scaleLinear().domain([d+0,d+i.length-1]).range([this.dimensions.margin.left,this.dimensions.width-this.dimensions.margin.right]),a.forEach(((t,e)=>{bt.call(this,this.svg,i,t,this.xline,this.yline,{root_id:h+"_l"+(e+1),line_id:"line_s"+(e+1),crop_floor:l,color:s[e]})})),vt.call(this,this.svg,this.xline,this.yline,{y_fmt:o,root_id:h}),_t.call(this,this.svg,i,n,this.xline,this.yline,{week_modulo:1,root_id:h}),e&&e.call(this,this.svg),this.svg.on("mousemove focus",(t=>{let e=d3.pointer(t),i=function(t,e,i){let a=i[0];i[1];let s=t.invert(a);return s>=0&&s<=t.domain()[1]?Math.round(s):null}(this.xline,this.yline,e);null!=i?xt.call(this,t,e,i,this.xline,this.yline):Et.call(this)})).on("mouseleave touchend blur",(t=>{Et.call(this)}))}class wt extends window.HTMLElement{connectedCallback(){this.translationsObj=h(this),this.chartConfigFilter=this.dataset.chartConfigFilter,this.chartConfigKey=this.dataset.chartConfigKey,console.log("Loading Postvax Chart",this.chartConfigKey,this.chartConfigFilter),this.chartOptions=yt[this.chartConfigKey][this.chartConfigFilter],c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=yt[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{c(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=yt[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dataUrl=i+this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),n(this)}ariaLabel(t,e){return""}getLegendText(){return[]}renderExtras(t){}getTooltipContent(t){const e=this.chartdata[t],i={WEEKDATE:O(e.DATE),VCOUNT:_(e[this.chartOptions.series_fields[0]],{format:"number"}),UCOUNT:_(e[this.chartOptions.series_fields[1]],{format:"number"})};return L(this.translationsObj.tooltipContent,i)}renderComponent(){console.log("Rendering Post Vax Chart");let t=this.chartdata.length-1,e=this.chartdata[t][this.chartOptions.series_fields[1]]/this.chartdata[t][this.chartOptions.series_fields[0]],i=this.chartdata[t].DATE;const a={BEGIN_IMPACT_DATE:O(this.chartdata[t-6].DATE),END_IMPACT_DATE:O(i),RATE_RATIO:_(e,{format:"number"}),RATE_PERCENT:_(e,{format:"number"})};this.translationsObj.post_chartTitle=L(this.translationsObj.chartTitleState,a),this.translationsObj.post_chartImpactStatement=L(this.translationsObj.chartImpactStatement,a),this.translationsObj.post_xaxis_legend=L(this.translationsObj.xaxis_legend,a),this.translationsObj.post_yaxis_legend=L(this.translationsObj.yaxis_legend_daily,a),this.translationsObj.post_series1_legend=L(this.translationsObj.series1_legend,a),this.translationsObj.post_series2_legend=L(this.translationsObj.series2_legend,a),this.translationsObj.post_series3_legend=L(this.translationsObj.series3_legend,a),this.translationsObj.post_pending_legend=L(this.translationsObj.pending_legend,a),this.translationsObj.pending_mode=this.pending_mode,this.innerHTML=ft.call(this,this.chartOptions,this.translationsObj);let s=this.chartOptions.series_fields,n=this.chartOptions.series_colors,r={tooltip_func:this.tooltip,extras_func:this.renderExtras,chartdata:this.chartdata,series_fields:s,series_colors:n,pending_legend:this.translationsObj.pending_legend,x_axis_field:this.chartOptions.x_axis_field,y_fmt:"number",root_id:this.chartOptions.root_id};Tt.call(this,r)}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){if(this.metadata=t.meta,this.chartdata=t.data,"earliest_date"in this.chartOptions){let t=0;for(let e=0;e<this.chartdata.length&&this.chartdata[e].DATE!=this.chartOptions.earliest_date;e++)t+=1;t>0&&this.chartdata.splice(0,t)}let e=parseInt(function(t,e=""){const i=window.location.search,a=new URLSearchParams(i);return a.has(t)?a.get(t):e}("days",""+this.chartOptions.days_to_show));console.log("days to show",e);let i=this.chartOptions.pending_days;this.chartdata.splice(this.chartdata.length-i,i),this.chartdata.length>e&&this.chartdata.splice(0,this.chartdata.length-e),this.chartdata.forEach((t=>{t[this.chartOptions.series_fields[0]]*=this.chartOptions.pre_mult,t[this.chartOptions.series_fields[1]]*=this.chartOptions.pre_mult})),this.renderComponent()}.bind(this))}}window.customElements.define("cagov-chart-dashboard-postvax-chart",wt);function At(t,e){fetch("https://files.covid19.ca.gov/img/generated/sparklines/"+t).then((function(t){return t.text().then((function(t){let i=document.querySelector(e);i&&(i.innerHTML=t)}))}))}At("sparkline-cases.svg",".sparkline-cases"),At("sparkline-tests.svg",".sparkline-tests"),At("sparkline-deaths.svg",".sparkline-deaths"),At("sparkline-vaccines.svg",".sparkline-vax"),document.getElementById("location-query"),document.getElementById("clearCounty");var Ct=document.querySelector(".col-lg-10");Ct.offsetWidth>920||Ct.offsetWidth>910&&Ct.offsetWidth<920||Ct.offsetWidth>800&&Ct.offsetWidth<910||Ct.offsetWidth>700&&Ct.offsetWidth<879||Ct.offsetWidth>600&&Ct.offsetWidth<700||Ct.offsetWidth>500&&Ct.offsetWidth;let Ot=document.querySelectorAll(".js-toggle-group");Ot.forEach((t=>{t.addEventListener("click",(function(t){t.preventDefault(),console.log("Reset Group Toggles"),Ot.forEach((t=>{t.classList.remove("toggle-active")})),document.getElementById("gender-graph").style.display="none",document.getElementById("ethnicity-graph").style.display="none",document.getElementById("age-graph").style.display="none",this.classList.contains("gender")&&(document.getElementById("gender-graph").style.display="block",this.classList.add("toggle-active")),this.classList.contains("age")&&(document.getElementById("age-graph").style.display="block",this.classList.add("toggle-active")),this.classList.contains("ethnicity")&&(document.getElementById("ethnicity-graph").style.display="block"),this.classList.add("toggle-active")}))}));let Lt=document.querySelectorAll(".js-toggle-group-postvax");Lt.forEach((t=>{t.addEventListener("click",(function(t){t.preventDefault(),console.log("Reset Group Toggles"),Lt.forEach((t=>{t.classList.remove("toggle-active")})),document.getElementById("postvax-cases-chart").style.display="none",document.getElementById("postvax-hospitalizations-chart").style.display="none",document.getElementById("postvax-deaths-chart").style.display="none",this.classList.contains("cases")&&(document.getElementById("postvax-cases-chart").style.display="block",this.classList.add("toggle-active")),this.classList.contains("hospitalizations")&&(document.getElementById("postvax-hospitalizations-chart").style.display="block",this.classList.add("toggle-active")),this.classList.contains("deaths")&&(document.getElementById("postvax-deaths-chart").style.display="block"),this.classList.add("toggle-active")}))}));
