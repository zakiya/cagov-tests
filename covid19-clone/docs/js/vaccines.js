const t="https://raw.githubusercontent.com/cagov/covid-static-data/7cf5fc39e0bfc91658c7f9bd5ac985178fee43f8/data/vaccine-equity/",e="https://raw.githubusercontent.com/cagov/covid-static/staging/data/vaccine-hpi//v2/",i="https://raw.githubusercontent.com/cagov/covid-static/staging/data/vaccine-hpi/v2/";function a(t,e,i,a){var n,s=!1,r=0;function o(){n&&clearTimeout(n)}function l(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];var d=this,p=Date.now()-r;function u(){r=Date.now(),i.apply(d,c)}function g(){n=void 0}s||(a&&!n&&u(),o(),void 0===a&&p>t?u():!0!==e&&(n=setTimeout(a?g:u,void 0===a?t-p:t)))}return"boolean"!=typeof e&&(a=i,i=e,e=void 0),l.cancel=function(){o(),s=!0},l}function n(t,e,i){return void 0===i?a(t,e,!1):a(t,i,!1!==e)}function s(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}function r(t){let e={};return t.querySelectorAll("[data-label]").forEach((t=>{e[t.dataset.label]=t.innerHTML})),t.querySelectorAll("[data-group]").forEach((t=>{let i=t.getAttribute("data-group"),a=t.querySelectorAll("[data-item]");if(null!==i&&null!==a){let t={};a.forEach((e=>{let i=e.getAttribute("data-item");t[i]=e.innerHTML})),e[i]=t}})),e}function o(){window.charts={};const t=()=>{let t=window.innerWidth,e=(window.innerHeight,(window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: 75.6dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min--moz-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)").matches)||window.devicePixelRatio&&window.devicePixelRatio>=2)&&/(iPad|iPhone|iPod)/g.test(navigator.userAgent)),i=window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches)||window.devicePixelRatio&&window.devicePixelRatio>1.3;(screen.orientation||{}).type||screen.mozOrientation||screen.msOrientation,void 0!==window.charts&&(t<=576?(window.charts.displayType="mobile",!0!==i&&!0!==e||(window.charts.displayType="retina")):window.charts.displayType=t>576&&t<=768?"tablet":"desktop")},e=()=>{t()};window.addEventListener("resize",e),e()}function l(t,e=".svg-holder",i="ltr"){let a=t.querySelector(e);null!=a&&a.setAttribute("dir",i)}function c(t,e){for(const i in e){const a=e[i];t=(t=(t=t.replace("{{"+i+"}}",a)).replace("{"+i+"}",a)).replace("("+i+")",a)}return t}function h(t){const e=t.split("-"),i=+e[0],a=+e[1],n=+e[2];return new Date(i,a-1,n)}function d(t,e={month:"long",day:"numeric",year:"numeric"}){return t.toLocaleString(document.documentElement.lang,e)}s("cagov-chart-vaccines-hpi-by-people .bar-lower-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-vaccines-hpi-by-people .bar-lower-label {\n  font-weight: normal;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-people .bar-upper-label-1 {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-people .bar-upper-label-2 {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-people .bottom-annotation {\n  font-weight: 300;\n  font-size: 0.65rem; }\n\ncagov-chart-vaccines-hpi-by-people .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-vaccines-hpi-by-people .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-people #hatch1 {\n  stroke: #2772B3;\n  stroke-width: 1.5; }\n\ncagov-chart-vaccines-hpi-by-people #hatch2 {\n  stroke: #9FCAE0;\n  stroke-width: 1.5; }\n\ncagov-chart-vaccines-hpi-by-people #hatch3 {\n  stroke: #A7DAA2;\n  stroke-width: 1.5; }\n\ncagov-chart-vaccines-hpi-by-people #hatch4 {\n  stroke: #11873B;\n  stroke-width: 1.5; }\n\ncagov-chart-vaccines-hpi-by-people #hatchL {\n  stroke: #000000;\n  stroke-width: 1.5; }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group1 .hpi-bar-1 {\n  fill: url(#hatch1); }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group1 .hpi-bar-2 {\n  fill: #2772B3; }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group2 .hpi-bar-1 {\n  fill: url(#hatch2); }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group2 .hpi-bar-2 {\n  fill: #9FCAE0; }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group3 .hpi-bar-1 {\n  fill: url(#hatch3); }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group3 .hpi-bar-2 {\n  fill: #A7DAA2; }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group4 .hpi-bar-1 {\n  fill: url(#hatch4); }\n\ncagov-chart-vaccines-hpi-by-people #hpi-bar-group4 .hpi-bar-2 {\n  fill: #11873B; }\n\ncagov-chart-vaccines-hpi-by-people #legend-box-1 {\n  fill: url(#hatchL); }\n\ncagov-chart-vaccines-hpi-by-people #legend-box-2 {\n  fill: #000000; }\n\n.d-hide {\n  display: none; }\n");let p=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}),u=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:1,maximumFractionDigits:1}),g=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),m=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:3,maximumFractionDigits:3}),b=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0}),y=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1}),v=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),f=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:3,maximumFractionDigits:3});function w(t,{format:e="number",min_decimals:i=1}){return"integer"==e?p.format(t):"percent"==e?0==t?b.format(t):t<5e-5?f.format(t):t<5e-4?v.format(t):0==i?b.format(t):y.format(t):0==t?p.format(t):t<.005?m.format(t):t<.05?g.format(t):0==i?p.format(t):1==i?u.format(t):2==i?g.format(t):m.format(t)}class x extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovVaccinationGroupsAge"),this.translationsObj=r(this),this.innerHTML=function({chartTitle:t="Vaccines by number of people vaccindated",chartDescription:e="",footerDisplayText:i="Updated {PUBLISHED_DATE} with data from {LATEST_ADMINISTERED_DATE}"}){return`\n    <div class="py-2">\n    <div class="container">\n      <div class="col-lg-12 bg-white py-4">\n        <div class="row">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n            <div class="chart-title">${t}</div>\n            <div class="small-text">${e}</div>\n            <div class="svg-holder"></div>\n          </div>\n        </div>\n        ${null!==i?`<div class="row">\n        <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0 pt-2">\n          <p class="chart-data-label small-text">${i}</p>\n        </div>\n      </div>`:""}\n      </div>\x3c!--END col-12--\x3e\n    </div>\x3c!--END CONTAINER--\x3e\n  </div>`}(this.translationsObj),this.nbr_bars=4,this.chartOptions={dataUrl:i+"vaccine-hpi.json",desktop:{bar_hspace:120,fontSize:14,height:400,width:120*this.nbr_bars,margin:{top:60,right:10,bottom:52,left:10}},tablet:{bar_hspace:120,fontSize:14,height:400,width:120*this.nbr_bars,margin:{top:60,right:10,bottom:52,left:10}},mobile:{bar_hspace:90,fontSize:12,height:400,width:90*this.nbr_bars,margin:{top:60,right:10,bottom:52,left:10}},retina:{bar_hspace:90,fontSize:12,height:400,width:90*this.nbr_bars,margin:{top:60,right:10,bottom:52,left:10}}},o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",n(200,!1,(()=>{o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]}))),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]);this.svg.append("defs").selectAll("pattern").data(["1","2","3","4","L"]).join("pattern").attr("id",(t=>"hatch"+t)).attr("x",0).attr("x",0).attr("width",4).attr("height",4).attr("patternUnits","userSpaceOnUse").append("path").attr("d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2"),this.svg.append("g").attr("transform","translate(0,0)"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),l(this)}getLegendText(){return[this.translationsObj.legendLabel1,this.translationsObj.legendLabel2]}getChartTitle({chartTitle:t="Temp Title"}){return t}ariaLabel(t){let e=c(this.translationsObj.barLabel,{N:t.D.HPIQUARTILE});return"PARTIALLY_VACCINATED_RATIO"==t.KEY?e+=`${w(t.D.PARTIALLY_VACCINATED_RATIO,{format:"percent"})} ${this.translationsObj.legendLabel1}`:e+=`${w(t.D.FULLY_VACCINATED_RATIO,{format:"percent"})} ${this.translationsObj.legendLabel2}`,e}writeBars(t,e,i,a,n){let s=t.append("g").selectAll("g").data(e).join("g").attr("id",((t,e)=>"hpi-bar-group"+(e+1))).attr("transform",((t,e)=>`translate(${a(e+1)},0)`));s.selectAll("rect").data((t=>["PARTIALLY_VACCINATED_RATIO","FULLY_VACCINATED_RATIO"].map((e=>({KEY:e,D:t}))))).join("rect").attr("class","bg-bar").attr("class",((t,e)=>"hpi-bar-"+(e+1))).attr("x",((t,e)=>n(e))).attr("y",(t=>i(t.D[t.KEY]))).attr("width",(t=>n.bandwidth())).attr("height",(t=>i(0)-i(t.D[t.KEY]))).attr("tabindex","0").attr("aria-label",((t,e)=>`${this.ariaLabel(t)}`)),s.selectAll("g").data((t=>["PARTIALLY_VACCINATED_RATIO","FULLY_VACCINATED_RATIO"].map((e=>({KEY:e,D:t}))))).join("text").attr("class","bar-upper-label-1").attr("y",((t,e)=>i(t.D[t.KEY])-18)).attr("x",((t,e)=>n(e)+n.bandwidth()/2)).text((t=>w(t.D[t.KEY],{format:"percent"}))).attr("text-anchor","middle");let r=["PARTIALLY_VACCINATED","FULLY_VACCINATED"];s.selectAll("g").data((t=>["PARTIALLY_VACCINATED_RATIO","FULLY_VACCINATED_RATIO"].map((e=>({KEY:e,D:t}))))).join("text").attr("class","bar-upper-label-2").attr("y",((t,e)=>i(t.D[t.KEY])-4)).attr("x",((t,e)=>n(e)+n.bandwidth()/2)).text(((t,e)=>w(t.D[r[e]],{format:"integer"}))).attr("text-anchor","middle"),s.append("text").attr("class","bar-lower-label").attr("y",((t,e)=>i(0)+20)).attr("x",((t,e)=>a.bandwidth()/2)).text((t=>c(this.translationsObj.barLabel,{N:t.HPIQUARTILE}))).attr("text-anchor","middle")}writeLegendTextAt(t,e,i,a){if(e.length>=40){const n=e.split(" "),s=Math.ceil(n.length/2)+1,r=n.splice(0,s).join(" "),o=n.join(" "),l=12;t.append("text").text(r).attr("class","legend-caption").attr("y",i).attr("x",a).attr("dominant-baseline","middle").attr("text-anchor","start"),t.append("text").text(o).attr("class","legend-caption").attr("y",i+l).attr("x",a).attr("dominant-baseline","middle").attr("text-anchor","start")}else t.append("text").text(e).attr("class","legend-caption").attr("y",i).attr("x",a).attr("dominant-baseline","middle").attr("text-anchor","start")}writeLegend(t,e,i,a,n){const s=12,r=this.dimensions.margin.top/3,o=this.getLegendText(),l=this.dimensions.width/2;let c=t.append("g");c.append("rect").attr("id","legend-box-1").attr("class","legend-block").attr("y",r).attr("x",0).attr("width",s).attr("height",s),this.writeLegendTextAt(c,o[0],r+6+1,18),c.append("rect").attr("id","legend-box-2").attr("class","legend-block").attr("y",r).attr("x",l).attr("width",s).attr("height",s),this.writeLegendTextAt(c,o[1],r+6+1,l+18)}writeExtraTextAt(t,e,i,a,n){if(e.length>=45){const s=e.split(" "),r=Math.ceil(s.length/2)+1,o=s.splice(0,r).join(" "),l=s.join(" "),c=5;t.append("text").text(o).attr("class","bottom-annotation").attr("y",a-c).attr("x",i).attr("text-anchor",n),t.append("text").text(l).attr("class","bottom-annotation").attr("y",a+c).attr("x",i).attr("text-anchor",n)}else t.append("text").text(e).attr("class","bottom-annotation").attr("y",a).attr("x",i).attr("text-anchor",n)}writeExtras(t,e,i,a,n){const s=this.dimensions.height-3*this.dimensions.margin.bottom/7;this.dimensions.margin.top,this.getLegendText(),this.dimensions.width;let r=t.append("g");r.append("line").attr("stroke","#000000").attr("x1",0).attr("y1",s).attr("y2",s).attr("x2",this.dimensions.width).attr("stroke-width",1),r.append("line").attr("stroke","#000000").attr("x1",this.dimensions.width).attr("y1",s).attr("x2",this.dimensions.width-3).attr("y2",s-3).attr("stroke-width",1),r.append("line").attr("stroke","#000000").attr("x1",this.dimensions.width).attr("y1",s).attr("x2",this.dimensions.width-3).attr("y2",s+3).attr("stroke-width",1),this.writeExtraTextAt(r,this.translationsObj.annotationLeast,0,s+16,"start"),this.writeExtraTextAt(r,this.translationsObj.annotationMost,this.dimensions.width,s+16,"end")}renderChart(){let t=this.alldata,e=t.map((t=>t.HPIQUARTILE));this.dimensions.width=this.dimensions.margin.left+this.dimensions.bar_hspace*e.length+this.dimensions.margin.right;let i=h(this.metadata.PUBLISHED_DATE),a=h(this.metadata.LATEST_ADMINISTERED_DATE);i.getTime()==a.getTime()&&a.setDate(a.getDate()-1);let n={PUBLISHED_DATE:d(i),LATEST_ADMINISTERED_DATE:d(a)},s=c(this.translationsObj.footerText,n);d3.select(this.querySelector(".chart-data-label")).text(s);let r=d3.max(t,(t=>Math.max(t.PARTIALLY_VACCINATED_RATIO,t.FULLY_VACCINATED_RATIO)));d3.select(this.querySelector("svg")).attr("viewBox",[0,0,this.dimensions.width,this.dimensions.height]),this.yScale=d3.scaleLinear().domain([0,r]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top]),this.xScaleOuter=d3.scaleBand().domain(e).range([this.dimensions.margin.left,this.dimensions.width-this.dimensions.margin.right]).paddingInner(1/6).paddingOuter(0),this.xScaleInner=d3.scaleBand().domain([0,1]).range([0,this.xScaleOuter.bandwidth()]).paddingInner(3/19).paddingOuter(0),this.svg.selectAll("g").remove(),this.writeBars.call(this,this.svg,t,this.yScale,this.xScaleOuter,this.xScaleInner),this.writeLegend.call(this,this.svg,t,this.yScale,this.xScaleOuter,this.xScaleInner),this.writeExtras.call(this,this.svg,t,this.yScale,this.xScaleOuter,this.xScaleInner)}retrieveData(t){let e=this;window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data,console.log("New HPI People Data",this.alldata),this.renderChart.call(e)}.bind(this))}}window.customElements.define("cagov-chart-vaccines-hpi-by-people",x);s("cagov-chart-vaccines-hpi-by-dose .bar-lower-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-vaccines-hpi-by-dose .bar-lower-label {\n  font-weight: normal;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-dose .bar-upper-label-1 {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-dose .bar-upper-label-2 {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-dose .bottom-annotation {\n  font-weight: 300;\n  font-size: 0.65rem; }\n\ncagov-chart-vaccines-hpi-by-dose .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-vaccines-hpi-by-dose .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccines-hpi-by-dose .main-bar-1 {\n  fill: #2772B3; }\n\ncagov-chart-vaccines-hpi-by-dose .main-bar-2 {\n  fill: #9FCAE0; }\n\ncagov-chart-vaccines-hpi-by-dose .main-bar-3 {\n  fill: #A7DAA2; }\n\ncagov-chart-vaccines-hpi-by-dose .main-bar-4 {\n  fill: #11873B; }\n\ncagov-chart-vaccines-hpi-by-dose .legend-block {\n  fill: #000000; }\n\n.d-hide {\n  display: none; }\n");class T extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovVaccinationGroupsAge"),this.translationsObj=r(this),this.innerHTML=function({chartTitle:t="Vaccines by doses administered",chartDescription:e="",footerDisplayText:i="Updated {PUBLISHED_DATE} with data from {LATEST_ADMINISTERED_DATE}"}){return`\n    <div class="col-lg-10 mx-auto pt-2">\n      <div class="bg-white pt-4">\n        <div class="chart-title">${t}</div>\n        <div class="small-text">${e}</div>\n        <div class="svg-holder"></div>\n      </div>\n      ${null!==i?`\n        <p class="chart-data-label small-text mb-2">${i}</p>\n      `:""}\n    </div>`}(this.translationsObj),this.nbr_bars=4,this.chartOptions={dataUrl:e+"vaccine-hpi.json",desktop:{bar_hspace:120,fontSize:14,height:400,width:120*this.nbr_bars,margin:{top:70,right:0,bottom:52,left:0}},tablet:{bar_hspace:120,fontSize:14,height:400,width:120*this.nbr_bars,margin:{top:70,right:0,bottom:52,left:0}},mobile:{bar_hspace:90,fontSize:12,height:400,width:90*this.nbr_bars,margin:{top:70,right:10,bottom:52,left:10}},retina:{bar_hspace:90,fontSize:12,height:400,width:90*this.nbr_bars,margin:{top:70,right:10,bottom:52,left:0}}},o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",n(200,!1,(()=>{o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]}))),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl),l(this)}getLegendText(){return[this.translationsObj.legendLabel1]}getChartTitle({chartTitle:t="Temp Title"}){return t}ariaLabel(t,e){const i=c(this.translationsObj.barLabel,{N:t.HPIQUARTILE});return`${w(t.COMBINED_DOSES/e,{format:"percent"})} ${this.translationsObj.legendLabel1} in ${i}`}writeBars(t,e,i,a,n){let s=t.append("g").selectAll("g").data(e).join("g");s.append("rect").attr("class","main-bar").attr("class",((t,e)=>"main-bar-"+(e+1))).attr("x",((t,e)=>a(e))).attr("y",(t=>i(t.COMBINED_DOSES/n))).attr("width",(t=>a.bandwidth())).attr("height",(t=>i(0)-i(t.COMBINED_DOSES/n))).attr("tabindex","0").attr("aria-label",((t,e)=>`${this.ariaLabel(t,n)}`)),s.append("text").attr("class","bar-upper-label-1").attr("y",((t,e)=>i(t.COMBINED_DOSES/n)-18)).attr("x",((t,e)=>a(e)+a.bandwidth()/2)).text((t=>w(t.COMBINED_DOSES/n,{format:"percent"}))).attr("text-anchor","middle"),s.append("text").attr("class","bar-upper-label-2").attr("y",((t,e)=>i(t.COMBINED_DOSES/n)-4)).attr("x",((t,e)=>a(e)+a.bandwidth()/2)).text(((t,e)=>w(t.COMBINED_DOSES,{format:"integer"}))).attr("text-anchor","middle"),s.append("text").attr("class","bar-lower-label").attr("y",((t,e)=>i(0)+20)).attr("x",((t,e)=>a(e)+a.bandwidth()/2)).text((t=>c(this.translationsObj.barLabel,{N:t.HPIQUARTILE}))).attr("text-anchor","middle")}writeLegend(t,e,i,a){const n=this.dimensions.margin.top/3,s=this.getLegendText();this.dimensions.width;let r=t.append("g");r.append("rect").attr("class","legend-block").attr("y",n).attr("x",0).attr("width",12).attr("height",12),r.append("text").text(s[0]).attr("class","legend-caption").attr("y",n+6+1).attr("x",18).attr("dominant-baseline","middle").attr("text-anchor","start")}writeExtras(t,e,i,a){const n=this.dimensions.height-3*this.dimensions.margin.bottom/7;this.dimensions.margin.top,this.getLegendText(),this.dimensions.width;let s=t.append("g");s.append("line").attr("stroke","#000000").attr("x1",0).attr("y1",n).attr("y2",n).attr("x2",this.dimensions.width).attr("stroke-width",1),s.append("line").attr("stroke","#000000").attr("x1",this.dimensions.width).attr("y1",n).attr("x2",this.dimensions.width-3).attr("y2",n-3).attr("stroke-width",1),s.append("line").attr("stroke","#000000").attr("x1",this.dimensions.width).attr("y1",n).attr("x2",this.dimensions.width-3).attr("y2",n+3).attr("stroke-width",1),s.append("text").text(this.translationsObj.annotationLeast).attr("class","bottom-annotation").attr("y",n+16).attr("x",0).attr("text-anchor","start"),s.append("text").text(this.translationsObj.annotationMost).attr("class","bottom-annotation").attr("y",n+16).attr("x",this.dimensions.width).attr("text-anchor","end")}renderChart(){let t=this.alldata,e=0;t.forEach((t=>{e+=t.COMBINED_DOSES}));let i=t.map((t=>t.HPIQUARTILE-1));this.dimensions.width=this.dimensions.margin.left+this.dimensions.bar_hspace*i.length+this.dimensions.margin.right;let a=h(this.metadata.PUBLISHED_DATE),n=h(this.metadata.LATEST_ADMINISTERED_DATE);a.getTime()==n.getTime()&&n.setDate(n.getDate()-1);let s={PUBLISHED_DATE:d(a),LATEST_ADMINISTERED_DATE:d(n)},r=c(this.translationsObj.footerText,s);d3.select(this.querySelector(".chart-data-label")).text(r);let o=d3.max(t,(t=>t.COMBINED_DOSES/e));d3.select(this.querySelector("svg")).attr("viewBox",[0,0,this.dimensions.width,this.dimensions.height]),this.yScale=d3.scaleLinear().domain([0,o]).nice().range([this.dimensions.height-this.dimensions.margin.bottom,this.dimensions.margin.top]),this.xScale=d3.scaleBand().domain(i).range([this.dimensions.margin.left,this.dimensions.width-this.dimensions.margin.right]).paddingInner(7/60).paddingOuter(0),this.svg.selectAll("g").remove(),this.writeBars.call(this,this.svg,t,this.yScale,this.xScale,e),this.writeLegend.call(this,this.svg,t,this.yScale,this.xScale),this.writeExtras.call(this,this.svg,t,this.yScale,this.xScale)}retrieveData(t){let e=this;window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data,console.log("New HPI Dose Data",this.alldata),this.renderChart.call(e)}.bind(this))}}window.customElements.define("cagov-chart-vaccines-hpi-by-dose",T);function E(t,e,i,a,n){const s=this.getLegendText();if(0==s.length)return;const r=1.2*a.bandwidth(),o=this.dimensions.margin.top/2,l=this.dimensions.width/2;let c=t.append("g");c.append("rect").attr("fill","#92C5DE").attr("class","legend-block").attr("y",o).attr("x",0).attr("width",r).attr("height",r),c.append("text").text(s[0]).attr("class","legend-caption").attr("y",o+r/2+1).attr("x",2*r).attr("dominant-baseline","middle").attr("text-anchor","start"),n&&s.length>1&&(c.append("rect").attr("fill","#1f2574").attr("y",o-a.bandwidth()/2).attr("x",l).attr("width",(t=>4)).attr("height",2*a.bandwidth()),c.append("text").text(s[1]).attr("class","legend-caption").attr("y",o+r/2).attr("x",l+15).attr("dominant-baseline","middle").attr("text-anchor","start"))}function A(t,e,i,a,n,s,r="barid"){let o=i.domain()[1],l=this,c=t.append("g").selectAll("g").data(e).enter().append("g");c.append("rect").attr("class","bg-bar").attr("fill","#f2f5fc").attr("y",((t,e)=>a(t.CATEGORY))).attr("x",(t=>i(0))).attr("width",(t=>i(o))).attr("height",a.bandwidth()),c.append("rect").attr("class","fg-bar").attr("fill","#92C5DE").attr("y",((t,e)=>a(t.CATEGORY))).attr("x",(t=>i(0))).attr("width",(t=>i(t.METRIC_VALUE))).attr("height",a.bandwidth()).attr("id",((t,e)=>r+"-"+e)),c.append("rect").attr("class","hot-bar").attr("fill","#00ff00").attr("fill-opacity",0).attr("y",((t,e)=>a(t.CATEGORY))).attr("x",(t=>i(0))).attr("width",(t=>i(o))).attr("height",a.bandwidth()).attr("tabindex","0").attr("aria-label",((t,e)=>`${this.ariaLabel(t,n)}`)).on("mouseover focus",(function(t,e,i){d3.select(this.parentNode).select(".fg-bar").transition().duration(200).style("fill","#003D9D"),s&&(s.html(l.getTooltip(e,n)),s.style("left","20px"),s.style("top",`${t.offsetY+120}px`),s.style("visibility","visible"))})).on("mouseout blur",(function(t){d3.select(this.parentNode).select(".fg-bar").transition().duration(200).style("fill","#92C5DE"),s&&(d3.select(this).transition(),s.style("visibility","hidden"))})),n&&c.append("rect").attr("fill","#1f2574").attr("fill-opacity",((t,e)=>-1==n[e].METRIC_VALUE?0:1)).attr("y",((t,e)=>a(t.CATEGORY)-a.bandwidth()/2)).attr("x",((t,e)=>i(n[e].METRIC_VALUE)-2)).attr("width",(t=>4)).attr("height",2*a.bandwidth()),c.append("text").attr("class","bar-label").attr("y",((t,e)=>a(t.CATEGORY)+a.bandwidth()/2)).attr("x",(t=>i(o)+12)).text((t=>w(t.METRIC_VALUE,{format:"percent"}))).attr("dominant-baseline","middle").attr("text-anchor","start"),c.append("text").attr("class","bar-cat").attr("y",((t,e)=>a(t.CATEGORY)-8)).attr("x",(t=>i(0))).text((t=>t.CATEGORY)).attr("text-anchor","start")}function C(t=null,e=null,i=null,a="barid"){let n=this.alldata,s=n.map((t=>t.CATEGORY));this.dimensions.height=this.dimensions.margin.top+60*s.length,d3.select(this.querySelector("svg")).attr("viewBox",[0,0,this.dimensions.width,this.dimensions.height]),this.y=d3.scaleBand().domain(s).range([this.dimensions.margin.top,this.dimensions.height-this.dimensions.margin.bottom]).paddingInner(5/6).paddingOuter(.5),this.max_x_domain=this.x=d3.scaleLinear().domain([0,1]).range([this.dimensions.margin.left,this.dimensions.width-(this.dimensions.margin.left+this.dimensions.margin.right)]),this.svg.selectAll("g").remove(),A.call(this,this.svg,n,this.x,this.y,e,i,a),E.call(this,this.svg,n,this.x,this.y,e),t&&t.call(this,this.svg,n,this.x,this.y)}s("cagov-chart-vaccination-groups-race-ethnicity .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-vaccination-groups-race-ethnicity .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccination-groups-race-ethnicity .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-vaccination-groups-race-ethnicity .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccination-groups-race-ethnicity div.tooltip-container {\n  font-weight: 300;\n  font-size: 0.75rem;\n  line-height: 2;\n  color: black;\n  text-align: center; }\n\ncagov-chart-vaccination-groups-race-ethnicity .tooltip-container {\n  position: absolute;\n  z-index: 10;\n  visibility: hidden;\n  background: #fff;\n  width: 280px; }\n\ncagov-chart-vaccination-groups-race-ethnicity .tooltip-container {\n  pointer-events: none;\n  /* padding: 10px; */\n  padding: 1rem 2rem;\n  box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.14);\n  /* box-shadow: -12px 11px 5px -4px rgba(0, 0, 0, 0.4); */\n  border: none; }\n\n.d-hide {\n  display: none; }\n");class L extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovVaccinationGroupsRaceEthnicity"),this.translationsObj=r(this),this.innerHTML=function({chartDisplayTitle:t="People with at least one dose of vaccine administered by race and ethnicity in [REGION]",chartDescription:e=null,chartDataLabel:i=null}){return`\n    <div class="col-lg-10 mx-auto pt-2">\n      <div class="bg-white pt-4">\n        <div class="chart-title">${t}</div>\n        \x3c!--<div class="small-text">${e}</div> --\x3e\n        <div class="svg-holder"></div>\n      </div>\n      ${null!==i?`\n        <p class="chart-data-label small-text mb-2">${i}</p>\n      `:""}\n    </div>`}(this.translationsObj),this.nbr_bars=9,this.bar_vspace=60,this.chartOptions={dataUrl:t+"race-ethnicity/vaccines_by_race_ethnicity_california.json",dataUrlCounty:t+"race-ethnicity/vaccines_by_race_ethnicity_<county>.json",state:"California",desktop:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:555,margin:{top:60,right:80,bottom:20,left:0}},tablet:{fontSize:14,height:60+this.nbr_bars*this.bar_vspace,width:555,margin:{top:60,right:80,bottom:20,left:0}},mobile:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:440,margin:{top:60,right:80,bottom:20,left:0}},retina:{fontSize:12,height:60+this.nbr_bars*(this.bar_vspace-2),width:320,margin:{top:60,right:80,bottom:20,left:0}}},o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-vaccination-groups-race-ethnicity").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),this.listenForLocations(),l(this)}getLegendText(){return[this.translationsObj.legendLabelVaccines,this.translationsObj.legendLabelPopulation]}getChartTitle({region:t="California",chartTitle:e="People with at least one dose of vaccine administered by race and ethnicity in California",chartTitleCounty:i="People with at least one dose of vaccine administered by race and ethnicity in [REGION]"}){let a=!1===("California"!==t)?e:i.replace("[REGION]",t+" County");return this.translationsObj.chartDisplayTitle=a,a}resetTitle({region:t="California",chartTitle:e="People with at least one dose of vaccine administered by race and ethnicity in California",chartTitleCounty:i="People with at least one dose of vaccine administered by race and ethnicity in [REGION]"}){this.translationsObj.chartDisplayTitle=this.getChartTitle({region:t,chartTitle:this.translationsObj.chartTitle,chartTitleCounty:this.translationsObj.chartTitleCounty}),this.querySelector(".chart-title").innerHTML=this.translationsObj.chartDisplayTitle}ariaLabel(t){return"ARIA BAR LABEL"}getTooltip(t,e){let i=this.translationsObj.chartBarCaption;"Other"==t.CATEGORY?i=this.translationsObj.chartBarCaptionOther:"Unknown"==t.CATEGORY&&(i=this.translationsObj.chartBarCaptionUnknown);let a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${w(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${w(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}renderExtras(t,e,i,a){}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){console.log("Region selected",t.detail.filterKey),this.county=t.detail.county;let e=this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,""));this.retrieveData(e,t.detail.county)}.bind(this),!1)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data,this.popdata=null,"POP_METRIC_VALUE"in this.alldata[0]&&(console.log("Pop data found for eth chart"),this.popdata=this.alldata.map((t=>({CATEGORY:t.CATEGORY,METRIC_VALUE:"Other"==t.CATEGORY||"Unknown"==t.CATEGORY?-1:t.POP_METRIC_VALUE}))));let i=h(this.metadata.PUBLISHED_DATE),a=h(this.metadata.LATEST_ADMIN_DATE);i.getTime()==a.getTime()&&a.setDate(a.getDate()-1);let n={PUBLISHED_DATE:d(i),LATEST_ADMINISTERED_DATE:d(a)},s=c(this.translationsObj.chartDataLabel,n);d3.select(this.querySelector(".chart-data-label")).text(s),C.call(this,this.renderExtras,this.popdata,this.tooltip,"ve-race-eth"),this.resetTitle({region:e,chartTitle:this.translationsObj.chartTitle,chartTitleCounty:this.translationsObj.chartCounty})}.bind(this))}}window.customElements.define("cagov-chart-vaccination-groups-race-ethnicity",L);s("cagov-chart-vaccination-groups-gender .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-vaccination-groups-gender .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccination-groups-gender .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-vaccination-groups-gender .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccination-groups-gender div.tooltip-container {\n  font-weight: 300;\n  font-size: 0.75rem;\n  line-height: 2;\n  color: black;\n  text-align: center; }\n\ncagov-chart-vaccination-groups-gender .tooltip-container {\n  position: absolute;\n  z-index: 10;\n  visibility: hidden;\n  background: #fff;\n  width: 280px; }\n\ncagov-chart-vaccination-groups-gender .tooltip-container {\n  pointer-events: none;\n  /* padding: 10px; */\n  padding: 1rem 2rem;\n  box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.14);\n  /* box-shadow: -12px 11px 5px -4px rgba(0, 0, 0, 0.4); */\n  border: none; }\n\n.d-hide {\n  display: none; }\n");class D extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovVaccinationGroupsGender"),this.translationsObj=r(this),this.innerHTML=function({chartDisplayTitle:t="People with at least one dose of vaccine administered by age in [REGION]",chartDescription:e=null,chartDataLabel:i=null}){return`\n    <div class="pt-2">\n    <div class="container">\n      <div class="col-lg-12 bg-white pt-4">\n        <div class="row">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n          <div class="chart-title">${t}</div>\n            \x3c!--<div class="small-text">${e}</div> --\x3e\n            <div class="svg-holder"></div>\n          </div>\n        </div>\n\n        ${null!==i?`<div class="row">\n        <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n          <p class="chart-data-label small-text mx-auto mb-2">${i}</p>\n        </div>\n      </div>`:""}\n      </div>\x3c!--END col-12--\x3e\n    </div>\x3c!--END CONTAINER--\x3e\n  </div>`}(this.translationsObj),this.nbr_bars=3;this.chartOptions={dataUrl:t+"gender/vaccines_by_gender_california.json",dataUrlCounty:t+"gender/vaccines_by_gender_<county>.json",desktop:{fontSize:14,height:60+60*this.nbr_bars,width:555,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+60*this.nbr_bars,width:555,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+58*this.nbr_bars,width:440,margin:{top:60,right:80,bottom:20,left:0}},retina:{fontSize:12,height:60+58*this.nbr_bars,width:320,margin:{top:60,right:80,bottom:20,left:0}}},o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-vaccination-groups-gender").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),this.listenForLocations(),l(this)}getLegendText(){return[this.translationsObj.legendLabelVaccines,this.translationsObj.legendLabelPopulation]}getChartTitle({region:t="California",chartTitle:e="People with at least one dose of vaccine administered by race and ethnicity in California",chartTitleCounty:i="People with at least one dose of vaccine administered by race and ethnicity in [REGION]"}){let a=!1===("California"!==t)?e:i.replace("[REGION]",t+" County");return this.translationsObj.chartDisplayTitle=a,a}resetTitle({region:t="California",chartTitle:e="People with at least one dose of vaccine administered by gender in California",chartTitleCounty:i="People with at least one dose of vaccine administered by gender in [REGION]"}){this.translationsObj.chartDisplayTitle=this.getChartTitle({region:t,chartTitle:this.translationsObj.chartTitle,chartTitleCounty:this.translationsObj.chartTitleCounty}),this.querySelector(".chart-title").innerHTML=this.translationsObj.chartDisplayTitle}ariaLabel(t){return"ARIA BAR LABEL"}getTooltip(t,e){let i=this.translationsObj.chartBarCaption;"Unknown/undifferentiated"==t.CATEGORY&&(i=this.translationsObj.chartBarCaptionUnknown);let a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${w(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${w(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){console.log("X County selected",t.detail.county),this.county=t.detail.county;let e=this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,""));this.retrieveData(e,t.detail.county)}.bind(this),!1)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data,this.popdata=null,"POP_METRIC_VALUE"in this.alldata[0]&&(console.log("Pop data found for gen chart"),this.popdata=this.alldata.map((t=>({CATEGORY:t.CATEGORY,METRIC_VALUE:"Unknown/undifferentiated"==t.CATEGORY?-1:t.POP_METRIC_VALUE}))));let i=h(this.metadata.PUBLISHED_DATE),a=h(this.metadata.LATEST_ADMIN_DATE);i.getTime()==a.getTime()&&a.setDate(a.getDate()-1);let n={PUBLISHED_DATE:d(i),LATEST_ADMINISTERED_DATE:d(a)},s=c(this.translationsObj.chartDataLabel,n);d3.select(this.querySelector(".chart-data-label")).text(s),C.call(this,null,this.popdata,this.tooltip,"ve-gender"),this.resetTitle({region:e,chartTitle:this.translationsObj.chartTitle,chartTitleCounty:this.translationsObj.chartCounty})}.bind(this))}}window.customElements.define("cagov-chart-vaccination-groups-gender",D);s("cagov-chart-vaccination-groups-age .bar-label .tick text {\n  text-transform: capitalize; }\n\ncagov-chart-vaccination-groups-age .bar-label {\n  font-weight: bold;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccination-groups-age .bar-cat {\n  font-weight: bold;\n  font-size: 0.95rem; }\n\ncagov-chart-vaccination-groups-age .legend-caption {\n  font-weight: 300;\n  font-size: 0.75rem; }\n\ncagov-chart-vaccination-groups-age div.tooltip-container {\n  font-weight: 300;\n  font-size: 0.75rem;\n  line-height: 2;\n  color: black;\n  text-align: center; }\n\ncagov-chart-vaccination-groups-age .tooltip-container {\n  position: absolute;\n  z-index: 10;\n  visibility: hidden;\n  background: #fff;\n  width: 280px; }\n\ncagov-chart-vaccination-groups-age .tooltip-container {\n  pointer-events: none;\n  /* padding: 10px; */\n  padding: 1rem 2rem;\n  box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.14);\n  /* box-shadow: -12px 11px 5px -4px rgba(0, 0, 0, 0.4); */\n  border: none; }\n\n.d-hide {\n  display: none; }\n");class O extends window.HTMLElement{connectedCallback(){console.log("Loading CAGovVaccinationGroupsAge"),this.translationsObj=r(this),this.innerHTML=function({chartDisplayTitle:t="People with at least one dose of vaccine administered by gender in [REGION]",chartDescription:e=null,chartDataLabel:i=null}){return`\n    <div class="pt-2">\n    <div class="container">\n      <div class="col-lg-12 bg-white pt-4">\n        <div class="row">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n            <div class="chart-title">${t}</div>\n            \x3c!--<div class="small-text">${e}</div> --\x3e\n            <div class="svg-holder"></div>\n          </div>\n        </div>\n        ${null!==i?`<div class="row">\n        <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n          <p class="chart-data-label small-text mx-auto mb-2">${i}</p>\n        </div>\n      </div>`:""}\n      </div>\x3c!--END col-12--\x3e\n    </div>\x3c!--END CONTAINER--\x3e\n  </div>`}(this.translationsObj),this.nbr_bars=4;this.chartOptions={dataUrl:t+"age/vaccines_by_age_california.json",dataUrlCounty:t+"age/vaccines_by_age_<county>.json",desktop:{fontSize:14,height:60+60*this.nbr_bars,width:555,margin:{top:60,right:80,bottom:0,left:0}},tablet:{fontSize:14,height:60+60*this.nbr_bars,width:555,margin:{top:60,right:80,bottom:0,left:0}},mobile:{fontSize:12,height:60+58*this.nbr_bars,width:440,margin:{top:60,right:80,bottom:0,left:0}},retina:{fontSize:12,height:60+58*this.nbr_bars,width:320,margin:{top:60,right:80,bottom:0,left:0}}},o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.dimensions=this.chartBreakpointValues;window.addEventListener("resize",(()=>{o(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate(0,0)"),this.tooltip=d3.select("cagov-chart-vaccination-groups-age").append("div").attr("class","tooltip-container").text("Empty Tooltip"),this.dataUrl=this.chartOptions.dataUrl,this.retrieveData(this.dataUrl,"California"),this.listenForLocations(),l(this)}getLegendText(){return[this.translationsObj.legendLabelVaccines,this.translationsObj.legendLabelPopulation]}getChartTitle({region:t="California",chartTitle:e="People with at least one dose of vaccine administered by race and ethnicity in California",chartTitleCounty:i="People with at least one dose of vaccine administered by race and ethnicity in [REGION]"}){let a=!1===("California"!==t)?e:i.replace("[REGION]",t+" County");return this.translationsObj.chartDisplayTitle=a,a}resetTitle({region:t="California",chartTitle:e="People with at least one dose of vaccine administered by age in California",chartTitleCounty:i="People with at least one dose of vaccine administered by age in [REGION]"}){this.translationsObj.chartDisplayTitle=this.getChartTitle({region:t,chartTitle:this.translationsObj.chartTitle,chartTitleCounty:this.translationsObj.chartTitleCounty}),this.querySelector(".chart-title").innerHTML=this.translationsObj.chartDisplayTitle}ariaLabel(t){return"ARIA BAR LABEL"}getTooltip(t,e){let i=this.translationsObj.chartBarCaption;"Other"==t.CATEGORY&&(i=this.translationsObj.chartBarCaptionOther);let a=e.filter((e=>e.CATEGORY==t.CATEGORY));return i=i.replace("{category}",`<span class='highlight-data'>${t.CATEGORY}</span>`),i=i.replace("{metric-value}",`<span class='highlight-data'>${w(t.METRIC_VALUE,{format:"percent"})}</span>`),i=i.replace("{metric-baseline-value}",`<span class='highlight-data'>${w(a[0].METRIC_VALUE,{format:"percent"})}</span>`),i}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(t){console.log("X County selected",t.detail.filterKey),this.county=t.detail.county;let e=this.chartOptions.dataUrlCounty.replace("<county>",this.county.toLowerCase().replace(/ /g,""));this.retrieveData(e,t.detail.county)}.bind(this),!1)}retrieveData(t,e){window.fetch(t).then((t=>t.json())).then(function(t){this.metadata=t.meta,this.alldata=t.data;let i=h(this.metadata.PUBLISHED_DATE),a=h(this.metadata.LATEST_ADMIN_DATE);i.getTime()==a.getTime()&&a.setDate(a.getDate()-1);let n={PUBLISHED_DATE:d(i),LATEST_ADMINISTERED_DATE:d(a)},s=c(this.translationsObj.chartDataLabel,n);d3.select(this.querySelector(".chart-data-label")).text(s);let r=t.data.filter((function(t){return"Unknown"!==t.CATEGORY}));this.alldata=r,this.popdata=null,"POP_METRIC_VALUE"in this.alldata[0]&&(console.log("Pop data found for age chart"),this.popdata=this.alldata.map((t=>({CATEGORY:t.CATEGORY,METRIC_VALUE:"Other"==t.CATEGORY||"Unknown"==t.CATEGORY?-1:t.POP_METRIC_VALUE})))),C.call(this,null,this.popdata,this.tooltip,"ve-age"),this.resetTitle({region:e,chartTitle:this.translationsObj.chartTitle,chartTitleCounty:this.translationsObj.chartCounty})}.bind(this))}}window.customElements.define("cagov-chart-vaccination-groups-age",O);class _{constructor(t){let e={label:"Unknown data",value:"Unknown data"};"string"==typeof t?e={label:t,value:t}:Array.isArray(t)?e={label:t[0],value:t[1]}:"object"==typeof t&&("label"in t||"value"in t)&&(e=t),this.label=e.label||e.value,this.value=e.value,"userData"in e&&(this.userData=e.userData)}get length(){return this.label.length}toString(){return`${this.label}`}valueOf(){return this.toString()}}class S{constructor(t,e){S.all=[];const i=this;S.count=(S.count||0)+1,this.count=S.count,this.isOpened=!1,this.input=S.query(t),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-owns",`awesomplete_list_${this.count}`),this.input.setAttribute("role","combobox"),this.options=e||{},this.configure({minChars:2,maxItems:10,autoFirst:!1,data:S.DATA,filter:S.FILTER_CONTAINS,sort:!1!==e.sort&&S.SORT_BYLENGTH,container:S.CONTAINER,item:S.ITEM,replace:S.REPLACE,tabSelect:!1},e),this.index=-1,this.container=this.container(t),this.ul=S.create("ul",{hidden:"hidden",role:"listbox",id:`awesomplete_list_${this.count}`,inside:this.container}),this.status=S.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-atomic":!0,inside:this.container,textContent:0!==this.minChars?`Type ${this.minChars} or more characters for results.`:"Begin typing for results."}),this.events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown(t){const e=t.keyCode;i.opened&&(13===e&&i.selected?(t.preventDefault(),t.stopImmediatePropagation(),i.select()):9===e&&i.selected&&i.tabSelect?i.select():27===e?i.close({reason:"esc"}):38!==e&&40!==e||(t.preventDefault(),i[38===e?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown(t){t.preventDefault()},click(t){let e=t.target;if(e!==this){for(;e&&!/li/i.test(e.nodeName);)e=e.parentNode;e&&0===t.button&&(t.preventDefault(),i.select(e,t.target))}}}},S.bind(this.input,this.events.input),S.bind(this.input.form,this.events.form),S.bind(this.ul,this.events.ul),this.input.hasAttribute("list")?(this.list=`#${this.input.getAttribute("list")}`,this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||e.list||[],S.all.push(this)}configure(t,e){Object.keys(t).forEach((i=>{const a=t[i],n=this.input.getAttribute(`data-${i.toLowerCase()}`);this[i]="number"==typeof a?parseInt(n,10):!1===a?null!==n:a instanceof Function?null:n,this[i]||0===this[i]||(this[i]=i in e?e[i]:a)}))}set list(t){if(Array.isArray(t))this.dataList=t;else if("string"==typeof t&&t.indexOf(",")>-1)this.dataList=t.split(/\s*,\s*/);else{const e=S.query(t);if(e&&e.children){const t=[],i=e=>{if(!e.disabled){const i=e.textContent.trim(),a=e.value||i,n=e.label||i;""!==a&&t.push({label:n,value:a})}};Array.prototype.slice.apply(e.children).forEach(i),this.dataList=t}}document.activeElement===this.input&&this.evaluate()}get list(){return this.dataList}get selected(){return this.index>-1}get opened(){return this.isOpened}close(t){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,this.status.setAttribute("hidden",""),S.fire(this.input,"awesomplete-close",t||{}))}open(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.status.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this.goto(0),S.fire(this.input,"awesomplete-open")}destroy(){if(S.unbind(this.input,this.events.input),S.unbind(this.input.form,this.events.form),!this.options.container){const{parentNode:t}=this.container;t.insertBefore(this.input,this.container),t.removeChild(this.container)}this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");const t=S.all.indexOf(this);-1!==t&&S.all.splice(t,1)}next(){const t=this.ul.children.length;let e=0;e=this.index<t-1?this.index+1:t?0:-1,this.goto(e)}previous(){const t=this.ul.children.length,e=this.index-1;this.goto(this.selected&&-1!==e?e:t-1)}goto(t){const e=this.ul.children;if(this.selected&&e[this.index].setAttribute("aria-selected","false"),this.index=t,t>-1&&e.length>0){e[t].setAttribute("aria-selected","true"),this.status.textContent=`${e[t].textContent}, list item ${t+1} of ${e.length}`,this.input.setAttribute("aria-activedescendant",`${this.ul.id}_item_${this.index}`),this.ul.scrollTop=e[t].offsetTop-this.ul.clientHeight+e[t].clientHeight;const i=this.suggestions[this.index];S.fire(this.input,"awesomplete-highlight",{selectedIndex:this.index,selectedText:`${i}`,selectedSuggestion:i})}}select(t,e){let i=t;if(t?this.index=S.siblingIndex(t):i=this.ul.children[this.index],i){const t=this.index,a=this.suggestions[t];S.fire(this.input,"awesomplete-select",{selectedIndex:t,selectedText:`${a}`,selectedSuggestion:a,origin:e||i})&&(this.replace(a),this.close({reason:"select"}),S.fire(this.input,"awesomplete-selectcomplete",{selectedIndex:t,selectedText:`${a}`,selectedSuggestion:a}))}}evaluate(){const t=this,{value:e}=this.input;if(e.length>=this.minChars&&this.dataList&&this.dataList.length>0){this.index=-1,this.ul.innerHTML="";const i=i=>new _(t.data(i,e)),a=i=>t.filter(i,e);this.suggestions=this.dataList.map(i).filter(a),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems);const n=(i,a)=>{t.ul.appendChild(t.item(i,e,a))};this.suggestions.forEach(n),0===this.ul.children.length?(this.status.textContent="No results found",this.close({reason:"nomatches"})):(this.open(),this.status.textContent=`${this.ul.children.length} results found`)}else this.close({reason:"nomatches"}),this.status.textContent="No results found"}static FILTER_CONTAINS(t,e){return RegExp(S.regExpEscape(e.trim()),"i").test(t)}static FILTER_STARTSWITH(t,e){return RegExp(`^${S.regExpEscape(e.trim())}`,"i").test(t)}static SORT_BYLENGTH(t,e){return t.length!==e.length?t.length-e.length:t<e?-1:1}static CONTAINER(t){return S.create("div",{className:"awesomplete",around:t})}static ITEM(t,e,i){const a=""===e.trim()?t:`${t}`.replace(RegExp(S.regExpEscape(e.trim()),"gi"),"<mark>$&</mark>");return S.create("li",{innerHTML:a,"aria-selected":"false",id:`awesomplete_list_${this.count}_item_${i}`})}static REPLACE(t){this.input.value=t.value||t.label}static DATA(t){return t}static query(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}static queryAll(t,e){return Array.prototype.slice.call((e||document).querySelectorAll(t))}static create(t,e){const i=document.createElement(t);return Object.keys(e).forEach((t=>{const a=e[t];if("inside"===t)S.query(a).appendChild(i);else if("around"===t){const t=S.query(a);t.parentNode.insertBefore(i,t),i.appendChild(t),null!=t.getAttribute("autofocus")&&t.focus()}else t in i?i[t]=a:i.setAttribute(t,a)})),i}static bind(t,e){if(t){const i=i=>{const a=e[i];i.split(/\s+/).forEach((e=>{t.addEventListener(e,a)}))};Object.keys(e).forEach(i)}}static unbind(t,e){if(t){const i=i=>{const a=e[i];i.split(/\s+/).forEach((e=>{t.removeEventListener(e,a)}))};Object.keys(e).forEach(i)}}static fire(t,e,i){const a=document.createEvent("HTMLEvents"),n=t=>{a[t]=i[t]};return a.initEvent(e,!0,!0),"object"==typeof i&&Object.keys(i).forEach(n),t.dispatchEvent(a)}static regExpEscape(t){return t.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}static siblingIndex(t){let e=0,i=t;for(;i;)i=i.previousElementSibling,i&&(e+=1);return e}}class I extends window.HTMLElement{processCountySearchInput(t){let e="";""==t&&(this.state.county="California",this.state.statewide=!0),this.countyList.forEach((i=>{i.toLowerCase()==t.toLowerCase()&&(e=i)})),e?(this.state.county=e,this.state.statewide=!1,document.querySelector("#location-query").value=e,console.log("emitCounty via search:",e),this.emitCounty(),document.querySelector("#county-query-error").style.display="none"):document.querySelector("#county-query-error").style.display="block"}handleURLPayload(){let t=document.location.href;if(-1!=t.indexOf("#location-")){let e=t.split("#location-")[1].replace("_"," ").replace("-"," "),i=document.querySelector("#location-query");"california"!=e&&(console.log("Triggering county search",e,i),this.processCountySearchInput(e))}}connectedCallback(){this.dataset.countyLabel&&this.dataset.countyLabel,this.state={},this.state.statewide=!1,this.innerHTML='\n    <div class="row d-flex justify-content-md-center">\n      <form class="form-inline" id="county-form">\n        <div class="form-group mx-sm-3 mb-2 pos-rel autocomplete-inline">\n          <label for="location-query" class="sr-only">County</label>\n          <div class="awesomplete">\n            <input aria-expanded="false" aria-owns="awesomplete_list_1"  aria-controls="awesomplete_list_1"  autocomplete="off" class="form-control form-control-lg" data-list="" data-multiple="" id="location-query" role="combobox" type="text" placeholder="Enter a county">\n            <button class="clear d-none" id="clearCounty"><span class="ca-gov-icon-close-line" aria-hidden="true"></span> <span class="underline">Clear</span></button>\n            <span class="visually-hidden" role="status" aria-live="assertive" aria-atomic="true">Type 2 or more characters for results.</span>\n          </div>\n        </div>\n      <button type="submit" class="btn btn-lightbg btn-bigger mb-2">Get county data</button>\n      </form>\n    </div>\n    <div class="row d-flex justify-content-md-center">\n      <span id="county-query-error" class="error-text d-none">County not found</span>\n    </div>',this.addListeners(),this.countyList=["Alameda","Alpine","Amador","Butte","Calaveras","Colusa","Contra Costa","Del Norte","El Dorado","Fresno","Glenn","Humboldt","Imperial","Inyo","Kern","Kings","Lake","Lassen","Los Angeles","Madera","Marin","Mariposa","Mendocino","Merced","Modoc","Mono","Monterey","Napa","Nevada","Orange","Placer","Plumas","Riverside","Sacramento","San Benito","San Bernardino","San Diego","San Francisco","San Joaquin","San Luis Obispo","San Mateo","Santa Barbara","Santa Clara","Santa Cruz","Shasta","Sierra","Siskiyou","Solano","Sonoma","Stanislaus","Sutter","Tehama","Trinity","Tulare","Tuolumne","Ventura","Yolo","Yuba"],this.setupAutoComp("#location-query","county",this.countyList);let t=this;document.querySelector("#county-form").addEventListener("submit",(function(e){e.preventDefault(),document.querySelector("#county-query-error").style.display="none";let i=document.querySelector("#location-query").value.trim();t.processCountySearchInput(i)})),this.handleURLPayload(),l(this,"div","ltr")}setupAutoComp(t,e,i){let a=this;const n={autoFirst:!0,filter:function(t,e){return S.FILTER_CONTAINS(t,e.match(/[^,]*$/)[0])},item:function(t,e){return S.ITEM(t,e.match(/[^,]*$/)[0])},replace:function(t){let e=t.value;a.processCountySearchInput(e)},list:i};new S(t,n)}emitCounty(){const t=new window.CustomEvent("county-selected",{detail:{county:this.state.county,statewide:this.state.statewide,reset:this.state.statewide,how:"emitCounty"}});this.dispatchEvent(t)}addListeners(){let t=this.querySelector("#location-query"),e=this.querySelector("#clearCounty");function i(){t&&t.value?e.classList.remove("d-none"):e.classList.add("d-none")}t.addEventListener("focus",i),t.addEventListener("input",i),t.addEventListener("blur",i),e.addEventListener("blur",i),e.addEventListener("click",function(i){i.preventDefault(),t.value="",this.state.county="California",this.state.statewide=!0,console.log("Emit county via clearbutton"),this.emitCounty(),e.classList.add("d-none"),document.querySelector("#county-query-error").style.display="none"}.bind(this))}}window.customElements.define("cagov-county-search",I);class R extends window.HTMLElement{connectedCallback(){this.resetText="Statewide",this.county="";let t=document.querySelector("cagov-county-search");t.addEventListener("county-selected",function(t){console.log("County-selected event: ",t.detail),t.detail.reset?this.innerHTML="":t.detail.statewide?this.innerHTML=this.template(!0):(this.county=t.detail.county,this.innerHTML=this.template(!1))}.bind(this),!1),this.addEventListener("click",(function(e){if(e.preventDefault(),e.target.classList.contains("js-toggle-county")){let i=e.target.textContent;if(!e.target.classList.contains("active")){let a=new window.CustomEvent("county-selected",{detail:{county:i,statewide:!1,reset:!1,how:"tab"}});e.target.classList.contains("statewide")&&(a=new window.CustomEvent("county-selected",{detail:{county:"California",statewide:!0,reset:!1,how:"tab"}})),t.dispatchEvent(a)}}}))}template(t){return`<div class="d-flex flex-column flex-md-row justify-content-center my-3">\n    <div class="text-center large-tabs">\n          <button class="large-tab js-toggle-county county ${t?"":"active"}">${this.county}</button>\n          <button class="large-tab js-toggle-county statewide ${t?"active":""}">${this.resetText}</button>\n        </div>\n    </div>`}}window.customElements.define("cagov-county-toggle-buttons",R);class k extends window.HTMLElement{connectedCallback(){this.addEventListener("click",(function(t){t.preventDefault();let e=t.target.textContent,i=t.target.dataset.key;if(null!=i&&!t.target.classList.contains("active")){let a=new window.CustomEvent("filter-selected",{detail:{filterKey:i,clickedFilterText:e}});this.resetActive(),t.target.classList.add("active"),this.dispatchEvent(a)}})),document.querySelector("cagov-chart-filter-buttons-vaccines.js-re-smalls").addEventListener("filter-selected",(function(t){if(null!=t.detail.filterKey){["race-ethnicity","gender","age"].forEach((e=>d3.selectAll("cagov-chart-vaccination-groups-"+e).attr("class","chart"+(e==t.detail.filterKey?"":" d-hide"))))}}))}resetActive(){this.querySelectorAll(".small-tab").forEach((t=>{t.classList.contains("active")&&t.classList.remove("active")}))}}window.customElements.define("cagov-chart-filter-buttons-vaccines",k),console.log("Loading vaccinations by group");
