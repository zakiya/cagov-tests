const t="https://files.covid19.ca.gov/data/to-review";class e{constructor(t){let e={label:"Unknown data",value:"Unknown data"};"string"==typeof t?e={label:t,value:t}:Array.isArray(t)?e={label:t[0],value:t[1]}:"object"==typeof t&&("label"in t||"value"in t)&&(e=t),this.label=e.label||e.value,this.value=e.value,"userData"in e&&(this.userData=e.userData)}get length(){return this.label.length}toString(){return`${this.label}`}valueOf(){return this.toString()}}class a{constructor(t,e){a.all=[];const i=this;a.count=(a.count||0)+1,this.count=a.count,this.isOpened=!1,this.input=a.query(t),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-owns",`awesomplete_list_${this.count}`),this.input.setAttribute("role","combobox"),this.options=e||{},this.configure({minChars:2,maxItems:10,autoFirst:!1,data:a.DATA,filter:a.FILTER_CONTAINS,sort:!1!==e.sort&&a.SORT_BYLENGTH,container:a.CONTAINER,item:a.ITEM,replace:a.REPLACE,tabSelect:!1},e),this.index=-1,this.container=this.container(t),this.ul=a.create("ul",{hidden:"hidden",role:"listbox",id:`awesomplete_list_${this.count}`,inside:this.container}),this.status=a.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-atomic":!0,inside:this.container,textContent:0!==this.minChars?`Type ${this.minChars} or more characters for results.`:"Begin typing for results."}),this.events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown(t){const e=t.keyCode;i.opened&&(13===e&&i.selected?(t.preventDefault(),t.stopImmediatePropagation(),i.select()):9===e&&i.selected&&i.tabSelect?i.select():27===e?i.close({reason:"esc"}):38!==e&&40!==e||(t.preventDefault(),i[38===e?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown(t){t.preventDefault()},click(t){let e=t.target;if(e!==this){for(;e&&!/li/i.test(e.nodeName);)e=e.parentNode;e&&0===t.button&&(t.preventDefault(),i.select(e,t.target))}}}},a.bind(this.input,this.events.input),a.bind(this.input.form,this.events.form),a.bind(this.ul,this.events.ul),this.input.hasAttribute("list")?(this.list=`#${this.input.getAttribute("list")}`,this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||e.list||[],a.all.push(this)}configure(t,e){Object.keys(t).forEach((a=>{const i=t[a],s=this.input.getAttribute(`data-${a.toLowerCase()}`);this[a]="number"==typeof i?parseInt(s,10):!1===i?null!==s:i instanceof Function?null:s,this[a]||0===this[a]||(this[a]=a in e?e[a]:i)}))}set list(t){if(Array.isArray(t))this.dataList=t;else if("string"==typeof t&&t.indexOf(",")>-1)this.dataList=t.split(/\s*,\s*/);else{const e=a.query(t);if(e&&e.children){const t=[],a=e=>{if(!e.disabled){const a=e.textContent.trim(),i=e.value||a,s=e.label||a;""!==i&&t.push({label:s,value:i})}};Array.prototype.slice.apply(e.children).forEach(a),this.dataList=t}}document.activeElement===this.input&&this.evaluate()}get list(){return this.dataList}get selected(){return this.index>-1}get opened(){return this.isOpened}close(t){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,this.status.setAttribute("hidden",""),a.fire(this.input,"awesomplete-close",t||{}))}open(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.status.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this.goto(0),a.fire(this.input,"awesomplete-open")}destroy(){if(a.unbind(this.input,this.events.input),a.unbind(this.input.form,this.events.form),!this.options.container){const{parentNode:t}=this.container;t.insertBefore(this.input,this.container),t.removeChild(this.container)}this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");const t=a.all.indexOf(this);-1!==t&&a.all.splice(t,1)}next(){const t=this.ul.children.length;let e=0;e=this.index<t-1?this.index+1:t?0:-1,this.goto(e)}previous(){const t=this.ul.children.length,e=this.index-1;this.goto(this.selected&&-1!==e?e:t-1)}goto(t){const e=this.ul.children;if(this.selected&&e[this.index].setAttribute("aria-selected","false"),this.index=t,t>-1&&e.length>0){e[t].setAttribute("aria-selected","true"),this.status.textContent=`${e[t].textContent}, list item ${t+1} of ${e.length}`,this.input.setAttribute("aria-activedescendant",`${this.ul.id}_item_${this.index}`),this.ul.scrollTop=e[t].offsetTop-this.ul.clientHeight+e[t].clientHeight;const i=this.suggestions[this.index];a.fire(this.input,"awesomplete-highlight",{selectedIndex:this.index,selectedText:`${i}`,selectedSuggestion:i})}}select(t,e){let i=t;if(t?this.index=a.siblingIndex(t):i=this.ul.children[this.index],i){const t=this.index,s=this.suggestions[t];a.fire(this.input,"awesomplete-select",{selectedIndex:t,selectedText:`${s}`,selectedSuggestion:s,origin:e||i})&&(this.replace(s),this.close({reason:"select"}),a.fire(this.input,"awesomplete-selectcomplete",{selectedIndex:t,selectedText:`${s}`,selectedSuggestion:s}))}}evaluate(){const t=this,{value:a}=this.input;if(a.length>=this.minChars&&this.dataList&&this.dataList.length>0){this.index=-1,this.ul.innerHTML="";const i=i=>new e(t.data(i,a)),s=e=>t.filter(e,a);this.suggestions=this.dataList.map(i).filter(s),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems);const n=(e,i)=>{t.ul.appendChild(t.item(e,a,i))};this.suggestions.forEach(n),0===this.ul.children.length?(this.status.textContent="No results found",this.close({reason:"nomatches"})):(this.open(),this.status.textContent=`${this.ul.children.length} results found`)}else this.close({reason:"nomatches"}),this.status.textContent="No results found"}static FILTER_CONTAINS(t,e){return RegExp(a.regExpEscape(e.trim()),"i").test(t)}static FILTER_STARTSWITH(t,e){return RegExp(`^${a.regExpEscape(e.trim())}`,"i").test(t)}static SORT_BYLENGTH(t,e){return t.length!==e.length?t.length-e.length:t<e?-1:1}static CONTAINER(t){return a.create("div",{className:"awesomplete",around:t})}static ITEM(t,e,i){const s=""===e.trim()?t:`${t}`.replace(RegExp(a.regExpEscape(e.trim()),"gi"),"<mark>$&</mark>");return a.create("li",{innerHTML:s,"aria-selected":"false",id:`awesomplete_list_${this.count}_item_${i}`})}static REPLACE(t){this.input.value=t.value||t.label}static DATA(t){return t}static query(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}static queryAll(t,e){return Array.prototype.slice.call((e||document).querySelectorAll(t))}static create(t,e){const i=document.createElement(t);return Object.keys(e).forEach((t=>{const s=e[t];if("inside"===t)a.query(s).appendChild(i);else if("around"===t){const t=a.query(s);t.parentNode.insertBefore(i,t),i.appendChild(t),null!=t.getAttribute("autofocus")&&t.focus()}else t in i?i[t]=s:i.setAttribute(t,s)})),i}static bind(t,e){if(t){const a=a=>{const i=e[a];a.split(/\s+/).forEach((e=>{t.addEventListener(e,i)}))};Object.keys(e).forEach(a)}}static unbind(t,e){if(t){const a=a=>{const i=e[a];a.split(/\s+/).forEach((e=>{t.removeEventListener(e,i)}))};Object.keys(e).forEach(a)}}static fire(t,e,a){const i=document.createEvent("HTMLEvents"),s=t=>{i[t]=a[t]};return i.initEvent(e,!0,!0),"object"==typeof a&&Object.keys(a).forEach(s),t.dispatchEvent(i)}static regExpEscape(t){return t.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}static siblingIndex(t){let e=0,a=t;for(;a;)a=a.previousElementSibling,a&&(e+=1);return e}}function i(t,e=".svg-holder",a="ltr"){let i=t.querySelector(e);null!=i&&i.setAttribute("dir",a)}class s extends window.HTMLElement{processCountySearchInput(t){let e="";""==t&&(this.state.county="California",this.state.statewide=!0),this.countyList.forEach((a=>{a.toLowerCase()==t.toLowerCase()&&(e=a)})),e?(this.state.county=e,this.state.statewide=!1,document.querySelector("#location-query").value=e,console.log("emitCounty via search:",e),this.emitCounty(),document.querySelector("#county-query-error").style.display="none"):document.querySelector("#county-query-error").style.display="block"}handleURLPayload(){let t=document.location.href;if(-1!=t.indexOf("#location-")){let e=t.split("#location-")[1].replace("_"," ").replace("-"," "),a=document.querySelector("#location-query");"california"!=e&&(console.log("Triggering county search",e,a),this.processCountySearchInput(e))}}connectedCallback(){this.dataset.countyLabel&&this.dataset.countyLabel,this.state={},this.state.statewide=!1,this.innerHTML='\n    <div class="row d-flex justify-content-md-center">\n      <form class="form-inline" id="county-form">\n        <div class="form-group mx-sm-3 mb-2 pos-rel autocomplete-inline">\n          <label for="location-query" class="sr-only">County</label>\n          <div class="awesomplete">\n            <input aria-expanded="false" aria-owns="awesomplete_list_1"  aria-controls="awesomplete_list_1"  autocomplete="off" class="form-control form-control-lg" data-list="" data-multiple="" id="location-query" role="combobox" type="text" placeholder="Enter a county">\n            <button class="clear d-none" id="clearCounty"><span class="ca-gov-icon-close-line" aria-hidden="true"></span> <span class="underline">Clear</span></button>\n            <span class="visually-hidden" role="status" aria-live="assertive" aria-atomic="true">Type 2 or more characters for results.</span>\n          </div>\n        </div>\n      <button type="submit" class="btn btn-lightbg btn-bigger mb-2">Get county data</button>\n      </form>\n    </div>\n    <div class="row d-flex justify-content-md-center">\n      <span id="county-query-error" class="error-text d-none">County not found</span>\n    </div>',this.addListeners(),this.countyList=["Alameda","Alpine","Amador","Butte","Calaveras","Colusa","Contra Costa","Del Norte","El Dorado","Fresno","Glenn","Humboldt","Imperial","Inyo","Kern","Kings","Lake","Lassen","Los Angeles","Madera","Marin","Mariposa","Mendocino","Merced","Modoc","Mono","Monterey","Napa","Nevada","Orange","Placer","Plumas","Riverside","Sacramento","San Benito","San Bernardino","San Diego","San Francisco","San Joaquin","San Luis Obispo","San Mateo","Santa Barbara","Santa Clara","Santa Cruz","Shasta","Sierra","Siskiyou","Solano","Sonoma","Stanislaus","Sutter","Tehama","Trinity","Tulare","Tuolumne","Ventura","Yolo","Yuba"],this.setupAutoComp("#location-query","county",this.countyList);let t=this;document.querySelector("#county-form").addEventListener("submit",(function(e){e.preventDefault(),document.querySelector("#county-query-error").style.display="none";let a=document.querySelector("#location-query").value.trim();t.processCountySearchInput(a)})),this.handleURLPayload(),i(this,"div","ltr")}setupAutoComp(t,e,i){let s=this;const n={autoFirst:!0,filter:function(t,e){return a.FILTER_CONTAINS(t,e.match(/[^,]*$/)[0])},item:function(t,e){return a.ITEM(t,e.match(/[^,]*$/)[0])},replace:function(t){let e=t.value;s.processCountySearchInput(e)},list:i};new a(t,n)}emitCounty(){const t=new window.CustomEvent("county-selected",{detail:{county:this.state.county,statewide:this.state.statewide,reset:this.state.statewide,how:"emitCounty"}});this.dispatchEvent(t)}addListeners(){let t=this.querySelector("#location-query"),e=this.querySelector("#clearCounty");function a(){t&&t.value?e.classList.remove("d-none"):e.classList.add("d-none")}t.addEventListener("focus",a),t.addEventListener("input",a),t.addEventListener("blur",a),e.addEventListener("blur",a),e.addEventListener("click",function(a){a.preventDefault(),t.value="",this.state.county="California",this.state.statewide=!0,console.log("Emit county via clearbutton"),this.emitCounty(),e.classList.add("d-none"),document.querySelector("#county-query-error").style.display="none"}.bind(this))}}window.customElements.define("cagov-county-search",s);class n extends window.HTMLElement{connectedCallback(){this.resetText="Statewide",this.county="";let t=document.querySelector("cagov-county-search");t.addEventListener("county-selected",function(t){console.log("County-selected event: ",t.detail),t.detail.reset?this.innerHTML="":t.detail.statewide?this.innerHTML=this.template(!0):(this.county=t.detail.county,this.innerHTML=this.template(!1))}.bind(this),!1),this.addEventListener("click",(function(e){if(e.preventDefault(),e.target.classList.contains("js-toggle-county")){let a=e.target.textContent;if(!e.target.classList.contains("active")){let i=new window.CustomEvent("county-selected",{detail:{county:a,statewide:!1,reset:!1,how:"tab"}});e.target.classList.contains("statewide")&&(i=new window.CustomEvent("county-selected",{detail:{county:"California",statewide:!0,reset:!1,how:"tab"}})),t.dispatchEvent(i)}}}))}template(t){return`<div class="d-flex flex-column flex-md-row justify-content-center my-3">\n    <div class="text-center large-tabs">\n          <button class="large-tab js-toggle-county county ${t?"":"active"}">${this.county}</button>\n          <button class="large-tab js-toggle-county statewide ${t?"active":""}">${this.resetText}</button>\n        </div>\n    </div>`}}window.customElements.define("cagov-county-toggle-buttons",n);class r extends window.HTMLElement{connectedCallback(){this.addEventListener("click",(function(t){t.preventDefault();let e=t.target.textContent,a=t.target.dataset.key;if(null!=a&&!t.target.classList.contains("active")){let i=new window.CustomEvent("filter-selected",{detail:{filterKey:a,clickedFilterText:e}});this.resetActive(),t.target.classList.add("active"),this.dispatchEvent(i)}}));let t=this.querySelector("button[data-key='deaths']");document.querySelector("cagov-county-search").addEventListener("county-selected",function(e){t&&(e.detail.statewide?t.style.display="block":t.style.display="none",t.classList.contains("active")&&(t.classList.remove("active"),this.querySelector("button").classList.add("active")))}.bind(this),!1)}resetActive(){this.querySelectorAll(".small-tab").forEach((t=>{t.classList.contains("active")&&t.classList.remove("active")}))}}function l(t,e){void 0===e&&(e={});var a=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===a&&i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}window.customElements.define("cagov-chart-filter-buttons",r);function o(t,e,a,i,s){d3.selectAll("."+a).remove(),t.style("opacity",.5),d3.select(e).append("div").attr("class","chart-overlaybox-container "+a).style("visibility","visible").style("left",(i.width-250)/2+"px").style("top",(i.height-125)/2+"px").append("div").attr("class","chart-overlaybox").text(s)}function c(t,e){d3.selectAll("."+e).remove(),t.style("opacity",1)}l("cagov-chart-re-100k {\n  min-width: 300px; }\n  cagov-chart-re-100k .change-from-month-labels {\n    font-size: 0.75em;\n    text-anchor: unset; }\n  cagov-chart-re-100k .bar-chart-label.label {\n    font-size: 0.85rem; }\n  cagov-chart-re-100k .label {\n    font-weight: normal;\n    color: #1f2574; }\n  cagov-chart-re-100k .chart-tooltip--re100k {\n    min-width: 100px; }\n  cagov-chart-re-100k .withheld-label {\n    font-size: 0.85em; }\n");let h=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}),d=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:1,maximumFractionDigits:1}),p=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),u=new Intl.NumberFormat("us",{style:"decimal",minimumFractionDigits:3,maximumFractionDigits:3}),g=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0}),m=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1}),E=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2}),y=new Intl.NumberFormat("us",{style:"percent",minimumFractionDigits:3,maximumFractionDigits:3});function T(t,{format:e="number",min_decimals:a=1}){return"integer"==e?h.format(t):"percent"==e?0==t?g.format(t):t<5e-5?y.format(t):t<5e-4?E.format(t):0==a?g.format(t):m.format(t):0==t?h.format(t):t<.005?u.format(t):t<.05?p.format(t):0==a?h.format(t):1==a?d.format(t):2==a?p.format(t):u.format(t)}function v(t,e,a){let i=this,s=this.svg,n=this.x,r=this.y,l=this.yAxis,h=this.color,d=this.tooltip,p=this.selectedMetricDescription,u=this.filterString(a),g=this.legendString(),m=this.translationsObj,E=this.chartBreakpointValues,y=this.appliedSuppressionStatus,v=this.selectedMetric;s.selectAll("g").remove(),s.selectAll("rect").remove(),s.selectAll("text").remove(),s.selectAll("path").remove();let C=s.append("g").selectAll("g").data(t).enter().append("g").attr("fill",(t=>h(t.key))).selectAll("rect").data((t=>t)).enter();C.append("rect").attr("x",(t=>n(t[0]))).attr("y",(t=>r(t.data.DEMOGRAPHIC_SET_CATEGORY))).attr("width",(t=>n(t[1])-n(t[0]))).attr("height","10px"),C.append("rect").attr("x",(t=>n(t[0]))).attr("y",(t=>r(t.data.DEMOGRAPHIC_SET_CATEGORY)-10)).attr("width",(t=>n(t[1])-n(t[0]))).attr("height","30px").attr("fill","transparent").attr("tabindex","0").attr("aria-label",((t,e)=>{let a=i.toolTipCaption(t.data.DEMOGRAPHIC_SET_CATEGORY,t.data.METRIC_VALUE_PER_100K?t.data.METRIC_VALUE_PER_100K:0,p,t);return"Total"===t.data.APPLIED_SUPPRESSION?a=m["data-missing-applied-suppression-total--"+v.toLowerCase()]||"":"Population"===t.data.APPLIED_SUPPRESSION&&(a=m["data-missing-applied-suppression-population--"+v.toLowerCase()]||""),a=a.replace(/(<([^>]+)>)/gi," "),a=a.replace(/\s+/g," "),a=a.trim(),a})).on("mouseover focus",(function(t,e){d3.select(this).transition();let a=i.toolTipCaption(e.data.DEMOGRAPHIC_SET_CATEGORY,e.data.METRIC_VALUE_PER_100K?e.data.METRIC_VALUE_PER_100K:0,p,e);("Population"===e.APPLIED_SUPPRESSION||"Total"===e.APPLIED_SUPPRESSION)&&(a=""),d.html(`<div class="chart-tooltip"><div >${a}</div></div>`),d.style("visibility","visible"),d.style("left","90px"),d.style("top",`${t.offsetY+230}px`)})).on("mouseout",(function(t){d3.select(this).transition(),d.style("visibility","hidden")}));let b="chartOverlay-cagov-chart-re-100k";null!==y?o(s,"cagov-chart-re-100k",b,E,m[y]?m[y]:""):c(s,b),s.append("g").call(l),s.append("g").attr("class","bars").selectAll(".bars").data(e).join((t=>{t.append("text").attr("class",(t=>"Population"===t.APPLIED_SUPPRESSION?"bars bars-unknown":"bars")).attr("y",(t=>r(t.DEMOGRAPHIC_SET_CATEGORY)+9)).attr("x",(t=>385)).attr("height",r.bandwidth()).text((t=>"None"===t.APPLIED_SUPPRESSION&&null!==t.METRIC_VALUE_PER_100K?t.METRIC_VALUE_PER_100K?T(t.METRIC_VALUE_PER_100K,{format:"number",min_decimals:this.decimal_display_places}):0:"Total"===t.APPLIED_SUPPRESSION||"Population"===t.APPLIED_SUPPRESSION?"":void 0)).attr("text-anchor","end")})),s.append("g").attr("class","more-than-labels").selectAll(".more-than-labels").data(e).join((t=>{t.append("text").attr("class","more-than-labels").attr("y",(t=>r(t.DEMOGRAPHIC_SET_CATEGORY)+25)).attr("x",(t=>415)).attr("height",r.bandwidth()).html((t=>"None"===t.APPLIED_SUPPRESSION?parseFloat(t.PCT_FROM_LOWEST_VALUE).toFixed(1)>1?`<tspan class="highlight-data">${parseFloat(t.PCT_FROM_LOWEST_VALUE).toFixed(1)}</tspan> times the lowest rate`:"Lowest rate":"")).attr("text-anchor","end")})),s.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(e).join((t=>{t.append("text").attr("y",(t=>r(t.DEMOGRAPHIC_SET_CATEGORY)+25)).attr("x",(t=>"None"==t.APPLIED_SUPPRESSION?250:0)).attr("height",r.bandwidth()).html((t=>"Population"===t.APPLIED_SUPPRESSION?`<tspan class="withheld-label">${m["data-missing-applied-suppression-population--"+v.toLowerCase()]||""}</tspan>`:"Total"===t.APPLIED_SUPPRESSION?`<tspan class="withheld-label">${m["data-missing-applied-suppression-total--"+v.toLowerCase()]||""}</tspan>`:"None"===t.APPLIED_SUPPRESSION?`<tspan class="highlight-data">\n            ${parseFloat(100*t.METRIC_VALUE_PER_100K_CHANGE_30_DAYS_AGO).toFixed(1)}%</tspan>\n            ${m.chartLineDiff}`:(console.log("unexpected applied suppression",t.APPLIED_SUPPRESSION),""))).attr("text-anchor",(t=>"None"==t.APPLIED_SUPPRESSION?"end":"start"))})),s.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(e).join((t=>{t.append("svg").attr("y",(t=>r(t.DEMOGRAPHIC_SET_CATEGORY)+15)).attr("x",(t=>3)).html((t=>"None"===t.APPLIED_SUPPRESSION?!t.METRIC_VALUE_PER_100K_CHANGE_30_DAYS_AGO||Math.abs(t.METRIC_VALUE_PER_100K_CHANGE_30_DAYS_AGO)<5e-4?'<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16.4155 8.8403L13.0689 12.013C12.8394 12.2306 12.4721 12.2234 12.2554 11.9949C12.0388 11.7663 12.0483 11.4018 12.2807 11.1815L14.5958 8.98667L1.0023 8.9417L0.784831 8.9417C0.629791 8.93708 0.495915 8.90016 0.388909 8.7873C0.284502 8.67717 0.227827 8.53225 0.231476 8.37719C0.2349 8.22757 0.297533 8.095 0.410888 7.98753C0.563911 7.84246 0.720296 7.81444 0.823716 7.81572L1.0023 7.816L14.6338 7.79526L12.449 5.49078C12.2324 5.26226 12.2419 4.89773 12.4743 4.67745C12.7038 4.45985 13.0712 4.46706 13.2878 4.69558L16.4409 8.02148C16.6573 8.25543 16.6478 8.62 16.4155 8.8403Z" fill="#1F2574"/>\n</svg>':parseFloat(t.METRIC_VALUE_PER_100K_CHANGE_30_DAYS_AGO)>0?'<svg width="15" height="10" viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 0.581819V5.19326C17 5.50954 16.742 5.77116 16.4271 5.77116C16.1122 5.77116 15.8543 5.51344 15.8543 5.19326V2.00308L10.1901 7.93042C10.0839 8.03975 9.93972 8.09832 9.78419 8.09832C9.63244 8.09832 9.48828 8.03975 9.37826 7.93042L6.11944 4.64647L0.971201 9.8321C0.86118 9.94143 0.720802 10 0.565271 10C0.413518 10 0.26936 9.94143 0.15934 9.8321C0.0531121 9.72667 0 9.59001 0 9.43381C0 9.22295 0.0872582 9.09018 0.15934 9.01601L5.70966 3.42434C5.81968 3.315 5.96006 3.25643 6.11559 3.25643C6.26734 3.25643 6.4115 3.315 6.52152 3.42434L9.78035 6.70829L15.0158 1.1558H11.8403C11.5254 1.1558 11.2674 0.898078 11.2674 0.5779C11.2674 0.26162 11.5254 0 11.8403 0H16.4233C16.742 0.00390471 17 0.261621 17 0.581819H17Z" fill="#FF8000"/>\n  </svg>':'<svg width="15" height=10 viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 9.41818V4.80674C17 4.49046 16.742 4.22884 16.4271 4.22884C16.1122 4.22884 15.8543 4.48656 15.8543 4.80674V7.99692L10.1901 2.06958C10.0839 1.96025 9.93972 1.90168 9.78419 1.90168C9.63244 1.90168 9.48828 1.96025 9.37826 2.06958L6.11944 5.35353L0.971201 0.167904C0.86118 0.0585697 0.720802 0 0.565271 0C0.413518 0 0.26936 0.0585717 0.15934 0.167904C0.0531121 0.273332 0 0.409992 0 0.566192C0 0.777052 0.0872582 0.909822 0.15934 0.983993L5.70966 6.57566C5.81968 6.685 5.96006 6.74357 6.11559 6.74357C6.26734 6.74357 6.4115 6.685 6.52152 6.57566L9.78035 3.29171L15.0158 8.8442H11.8403C11.5254 8.8442 11.2674 9.10192 11.2674 9.4221C11.2674 9.73838 11.5254 10 11.8403 10H16.4233C16.742 9.9961 17 9.73838 17 9.41818H17Z" fill="#003D9D"/>\n  </svg>':""))})),s.append("path").attr("d",d3.line()([[n(a),30],[n(a),650]])).attr("stroke","#1F2574").attr("opacity","0.25").style("stroke-dasharray","5, 5").style("stroke","#1F2574");let _=n(a),f="middle";_<.3*this.dimensions.width?f="start":_>=.66*this.dimensions.width&&(f="end"),s.append("g").append("text").text(u).attr("x",n(a)).attr("y",25).attr("text-anchor",f).attr("fill","#1F2574").attr("class","label bar-chart-label"),s.append("rect").attr("x",0).attr("y",-20).attr("width",15).attr("height",15).attr("fill","#FFCF44"),s.append("text").attr("x",25).attr("y",-12).attr("class","legend-label").attr("dy","0.35em").text(g)}function C(){let t=new Map;return t.set("African American","Black"),t.set("Native Hawaiian and other Pacific Islander","Native Hawaiian and other Pacific Islander (NHPI)"),t.set("American Indian","American Indian or Alaska Native (AI/AN)"),t}function b(t){let e={};return t.querySelectorAll("[data-label]").forEach((t=>{e[t.dataset.label]=t.innerHTML})),t.querySelectorAll("[data-group]").forEach((t=>{let a=t.getAttribute("data-group"),i=t.querySelectorAll("[data-item]");if(null!==a&&null!==i){let t={};i.forEach((e=>{let a=e.getAttribute("data-item");t[a]=e.innerHTML})),e[a]=t}})),e}function _(){window.charts={};const t=()=>{let t=window.innerWidth,e=(window.innerHeight,(window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx), only screen and (min-resolution: 75.6dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min--moz-device-pixel-ratio: 2), only screen and (min-device-pixel-ratio: 2)").matches)||window.devicePixelRatio&&window.devicePixelRatio>=2)&&/(iPad|iPhone|iPod)/g.test(navigator.userAgent)),a=window.matchMedia&&(window.matchMedia("only screen and (min-resolution: 124dpi), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 48.8dpcm)").matches||window.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (min-device-pixel-ratio: 1.3)").matches)||window.devicePixelRatio&&window.devicePixelRatio>1.3;(screen.orientation||{}).type||screen.mozOrientation||screen.msOrientation,void 0!==window.charts&&(t<=576?(window.charts.displayType="mobile",!0!==a&&!0!==e||(window.charts.displayType="retina")):window.charts.displayType=t>576&&t<=768?"tablet":"desktop")},e=()=>{t()};window.addEventListener("resize",e),e()}class f extends window.HTMLElement{connectedCallback(){this.chartOptions={subgroups:["METRIC_VALUE_PER_100K","WORST_VALUE_DELTA"],dataUrl:t+"/equitydash/cumulative-california.json",dataStatewideRateUrl:t+"/equitydash/cumulative-combined.json",state:"California",county:"California",chartColors:["#FFCF44","#F2F5FC"],selectedMetric:"cases",selectedMetricDescription:"cases",desktop:{is_single_col:!1,height:642,width:450,margin:{top:20,right:30,bottom:10,left:10}},tablet:{is_single_col:!0,height:642,width:450,margin:{top:20,right:30,bottom:10,left:10}},mobile:{is_single_col:!0,height:642,width:450,margin:{top:20,right:30,bottom:10,left:10}},retina:{is_single_col:!0,height:642,width:450,margin:{top:20,right:30,bottom:10,left:10}}},_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"];var e,a;window.addEventListener("resize",(()=>{_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.dimensions=this.chartBreakpointValues,this.translationsObj=b(this),this.selectedMetric="cases",this.selectedMetricDescription="cases",this.county="California",this.drawBars=v,this.chartTitle=function(){let t="California"===this.county;return this.translationsObj["chartTitle--"+this.selectedMetric].replace("placeholderForDynamicLocation",t?this.county:this.county+" County ")},this.description=function(t){return this.translationsObj["chartDescription--"+this.selectedMetric]},this.legendString=function(){return this.translationsObj["chartLegend--"+this.selectedMetric]},this.filterString=function(t){let e="California"===this.county,a="chartFilterLegendPfxState--"+this.selectedMetric,i=this.translationsObj[a]+T(t,{format:"integer"});return i=i.replace("placeholderForDynamicLocation",e?this.county:this.county+" County "),i},this.toolTipCaption=function(t,e,a,i){if("Total"===i.data.APPLIED_SUPPRESSION)return this.translationsObj["data-missing-applied-suppression-total--"+this.selectedMetric.toLowerCase()]||"";if("Population"===i.data.APPLIED_SUPPRESSION)return this.translationsObj["data-missing-applied-suppression-population--"+this.selectedMetric.toLowerCase()]||"";return this.translationsObj["chartToolTip-caption"].replace("placeholderDEMO_CAT",t).replace("placeholderMETRIC_100K",T(e,{format:"number",min_decimals:this.decimal_display_places})).replace("placeholderFilterScope",a)},this.innerHTML=(e=this.chartTitle(),a=this.description(this.selectedMetricDescription),`<div class="chart py-2">\n    <div class="bg-white py-4">\n      <div class="mx-auto">\n        <div class="chart-title">${e}</div>\n        <p class="small-text chart-description">${a}</p>\n        <div class="svg-holder"></div>\n      </div>\n    </div>\n  </div>\x3c!--END BG lightblue--\x3e`),this.classList.remove("d-none"),this.tooltip=d3.select("cagov-chart-re-100k").append("div").attr("class","tooltip-container tooltip-container--re100k").text("an empty tooltip"),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.dimensions.width,this.dimensions.height]).append("g").attr("transform","translate("+this.dimensions.margin.left+","+this.dimensions.margin.top+")"),this.subgroups=this.chartOptions.subgroups,this.color=d3.scaleOrdinal().domain(this.subgroups).range(this.chartOptions.chartColors),this.dataUrl=this.chartOptions.dataUrl,this.dataStatewideRateUrl=this.chartOptions.dataStatewideRateUrl,this.retrieveData(this.dataUrl,this.dataStatewideRateUrl),this.listenForLocations(),this.county=this.chartOptions.state,this.resetTitle(),this.resetDescription(),i(this)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(e){this.county=e.detail.county,"deaths"===this.selectedMetric&&(this.selectedMetric="cases"),this.dataUrl=t+"/equitydash/cumulative-"+this.county.toLowerCase().replace(/ /g,"")+".json",this.retrieveData(this.dataUrl,this.dataStatewideRateUrl),this.resetTitle(),this.resetDescription()}.bind(this),!1),document.querySelector("cagov-chart-filter-buttons.js-re-smalls").addEventListener("filter-selected",function(t){if(null!=t.detail.filterKey){this.selectedMetricDescription=t.detail.clickedFilterText.toLowerCase();let e="chartMetricName--"+t.detail.filterKey;e in this.translationsObj&&(this.selectedMetricDescription=this.translationsObj[e]),this.selectedMetric=t.detail.filterKey,this.retrieveData(this.dataUrl,this.dataStatewideRateUrl),this.resetDescription(),this.resetTitle()}}.bind(this),!1)}resetTitle(){this.querySelector(".chart-title").innerHTML=this.chartTitle()}resetDescription(){this.querySelector(".chart-description").innerHTML=this.description(this.selectedMetricDescription)}checkAppliedDataSuppression(t){let e=null,a=t.map((t=>t.DEMOGRAPHIC_SET_CATEGORY)),i={None:0,Total:0,Population:0,CountySuppressed:!1,TotalSuppression:0};return t.map((t=>{i[t.APPLIED_SUPPRESSION]=i[t.APPLIED_SUPPRESSION]+1,"None"!==t.APPLIED_SUPPRESSION&&(i.TotalSuppression=i.TotalSuppression+1)})),a.length===i.TotalSuppression&&(i.CountySuppressed=!0,e="applied-suppression-total"),e}render(){let t=this.alldata.filter((t=>t.METRIC===this.selectedMetric&&"Other"!==t.DEMOGRAPHIC_SET_CATEGORY&&"Unknown"!==t.DEMOGRAPHIC_SET_CATEGORY)),e=C();t.forEach((t=>{t.METRIC_VALUE_PER_100K_CHANGE_30_DAYS_AGO=0,t.METRIC_VALUE_PER_100K_30_DAYS_AGO&&(t.METRIC_VALUE_PER_100K_CHANGE_30_DAYS_AGO=t.METRIC_VALUE_PER_100K_DELTA_FROM_30_DAYS_AGO/t.METRIC_VALUE_PER_100K_30_DAYS_AGO),e.get(t.DEMOGRAPHIC_SET_CATEGORY)&&(t.DEMOGRAPHIC_SET_CATEGORY=e.get(t.DEMOGRAPHIC_SET_CATEGORY))}));let a=t.filter((t=>null!==t.DISPROPORTIONALITY_RATIO)),i=t.filter((t=>null===t.DISPROPORTIONALITY_RATIO));a.sort((function(t,e){return d3.descending(t.METRIC_VALUE_PER_100K,e.METRIC_VALUE_PER_100K)})),t=a.concat(i),this.appliedSuppressionStatus=this.checkAppliedDataSuppression(t);let s=t.map((t=>t.DEMOGRAPHIC_SET_CATEGORY)),n=d3.stack().keys(this.subgroups)(t);this.y=d3.scaleBand().domain(s).range([this.dimensions.margin.top,this.dimensions.height-this.dimensions.margin.bottom]).padding([.6]),this.yAxis=t=>t.attr("class","bar-label").attr("transform","translate(5,-32)").call(d3.axisLeft(this.y).tickSize(0)).call((t=>t.selectAll(".domain").remove()));let r=this.combinedData[this.selectedMetric]?this.combinedData[this.selectedMetric].METRIC_VALUE_PER_100K:null,l=d3.max(n,(t=>d3.max(t,(t=>t[1]))));null!==r&&(l=Math.max(l,r)),this.decimal_display_places=l>=20?0:l>=2?1:2;let o=this.dimensions.is_single_col?60:40;this.x=d3.scaleLinear().domain([0,l]).range([0,this.dimensions.width-this.dimensions.margin.right-o]),this.xAxis=t=>t.attr("transform","translate(0,"+this.dimensions.width+")").call(d3.axisBottom(this.x).ticks(width/50,"s")).remove(),this.drawBars(n,t,r)}retrieveData(t,e){Promise.all([window.fetch(t),window.fetch(e)]).then((function(t){return Promise.all(t.map((function(t){return t.json()})))})).then(function(t){this.alldata=t[0],this.combinedData=t[1],this.render()}.bind(this))}}window.customElements.define("cagov-chart-re-100k",f);function A({component:t,svg:e,x1:a,x2:i,y:s,yAxis:n,stackedData1:r,stackedData2:l,color1:o,color2:h,data:d,tooltip:p,selectedMetric:u,translationsObj:g,legendScope:m="",legendScopeStatewide:E="",appliedSuppressionStatus:y,chartBreakpointValues:T}){e.selectAll("g").remove(),e.selectAll("rect").remove(),e.selectAll("text").remove();let v="chartOverlay-svg-holder-second";null!==y?function(t,e,a,i){d3.selectAll("."+a).remove(),t.style("opacity",.5)}(e,0,v):c(e,v),e.append("g").selectAll("g").data(r).enter().append("g").attr("fill",(t=>h(t.key))).selectAll("rect").data((t=>t)).enter().append("rect").attr("x",(t=>a(t[0]))).attr("y",(t=>s(t.data.DEMOGRAPHIC_SET_CATEGORY))).attr("width",(t=>a(t[1])-a(t[0]))).attr("height","10px").attr("tabindex","0").on("mouseover focus",(function(t,e){d3.select(this).transition()})).on("mouseout",(function(t){d3.select(this).transition(),p.style("visibility","hidden")})),e.append("g").call(n);let C=t.dimensions.is_single_col?25:5;e.append("g").attr("class","bars").selectAll(".bars").data(d).join((t=>{t.append("text").attr("class","bars").attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+8)).attr("x",(t=>a(100)+C)).attr("height",s.bandwidth()).text((t=>t.METRIC_TOTAL_PERCENTAGE?parseFloat(t.METRIC_TOTAL_PERCENTAGE).toFixed(1)+"%":"0%")).attr("text-anchor","end")})),e.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(d).join((t=>{t.append("text").attr("class","change-from-month-labels").attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+27)).attr("x",(t=>"Population"===t.APPLIED_SUPPRESSION||"Total"===t.APPLIED_SUPPRESSION?i(1):i(1)+20)).attr("height",s.bandwidth()).html((t=>"Population"===t.APPLIED_SUPPRESSION?`${g["data-missing-applied-suppression-population--"+u.toLowerCase()]||""}`:"Total"===t.APPLIED_SUPPRESSION?`${g["data-missing-applied-suppression-total--"+u.toLowerCase()]||""}`:t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO?`<tspan class="highlight-data">${parseFloat(t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO).toFixed(1)}%</tspan> ${g.chartLineDiff}`:`<tspan class="highlight-data">0%</tspan> ${g.chartLineDiff}`)).attr("text-anchor","end")})),e.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(d).join((t=>{t.append("svg").attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+15)).attr("x",(t=>i(1))).html((t=>"Population"===t.APPLIED_SUPPRESSION||"Total"===t.APPLIED_SUPPRESSION?"":!t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO||Math.abs(t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO)<.05?'<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M16.4155 8.8403L13.0689 12.013C12.8394 12.2306 12.4721 12.2234 12.2554 11.9949C12.0388 11.7663 12.0483 11.4018 12.2807 11.1815L14.5958 8.98667L1.0023 8.9417L0.784831 8.9417C0.629791 8.93708 0.495915 8.90016 0.388909 8.7873C0.284502 8.67717 0.227827 8.53225 0.231476 8.37719C0.2349 8.22757 0.297533 8.095 0.410888 7.98753C0.563911 7.84246 0.720296 7.81444 0.823716 7.81572L1.0023 7.816L14.6338 7.79526L12.449 5.49078C12.2324 5.26226 12.2419 4.89773 12.4743 4.67745C12.7038 4.45985 13.0712 4.46706 13.2878 4.69558L16.4409 8.02148C16.6573 8.25543 16.6478 8.62 16.4155 8.8403Z" fill="#1F2574"/>\n  </svg>':parseFloat(t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO)>0?'<svg width="15" height="10" viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M17 0.581819V5.19326C17 5.50954 16.742 5.77116 16.4271 5.77116C16.1122 5.77116 15.8543 5.51344 15.8543 5.19326V2.00308L10.1901 7.93042C10.0839 8.03975 9.93972 8.09832 9.78419 8.09832C9.63244 8.09832 9.48828 8.03975 9.37826 7.93042L6.11944 4.64647L0.971201 9.8321C0.86118 9.94143 0.720802 10 0.565271 10C0.413518 10 0.26936 9.94143 0.15934 9.8321C0.0531121 9.72667 0 9.59001 0 9.43381C0 9.22295 0.0872582 9.09018 0.15934 9.01601L5.70966 3.42434C5.81968 3.315 5.96006 3.25643 6.11559 3.25643C6.26734 3.25643 6.4115 3.315 6.52152 3.42434L9.78035 6.70829L15.0158 1.1558H11.8403C11.5254 1.1558 11.2674 0.898078 11.2674 0.5779C11.2674 0.26162 11.5254 0 11.8403 0H16.4233C16.742 0.00390471 17 0.261621 17 0.581819H17Z" fill="#FF8000"/>\n    </svg>':'<svg width="15" height=10 viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n    <path d="M17 9.41818V4.80674C17 4.49046 16.742 4.22884 16.4271 4.22884C16.1122 4.22884 15.8543 4.48656 15.8543 4.80674V7.99692L10.1901 2.06958C10.0839 1.96025 9.93972 1.90168 9.78419 1.90168C9.63244 1.90168 9.48828 1.96025 9.37826 2.06958L6.11944 5.35353L0.971201 0.167904C0.86118 0.0585697 0.720802 0 0.565271 0C0.413518 0 0.26936 0.0585717 0.15934 0.167904C0.0531121 0.273332 0 0.409992 0 0.566192C0 0.777052 0.0872582 0.909822 0.15934 0.983993L5.70966 6.57566C5.81968 6.685 5.96006 6.74357 6.11559 6.74357C6.26734 6.74357 6.4115 6.685 6.52152 6.57566L9.78035 3.29171L15.0158 8.8442H11.8403C11.5254 8.8442 11.2674 9.10192 11.2674 9.4221C11.2674 9.73838 11.5254 10 11.8403 10H16.4233C16.742 9.9961 17 9.73838 17 9.41818H17Z" fill="#003D9D"/>\n    </svg>'))}))}function w(t,e,a){t.METRIC;let i=null;return null!==t.POPULATION_PERCENTAGE&&null!==t.METRIC_TOTAL_PERCENTAGE&&(i=t.METRIC_TOTAL_PERCENTAGE/t.POPULATION_PERCENTAGE),i}l("cagov-chart-re-pop {\n  min-width: 300px; }\n  cagov-chart-re-pop .svg-holder-second {\n    border-top: solid 1px #000;\n    margin-top: 10px;\n    padding-top: 30px; }\n    cagov-chart-re-pop .svg-holder-second svg {\n      width: 100%; }\n  cagov-chart-re-pop .chart-overlaybox-container {\n    top: 23%;\n    left: 20%; }\n  cagov-chart-re-pop .change-from-month-labels {\n    font-size: 0.75em;\n    text-anchor: unset; }\n  cagov-chart-re-pop .withheld-label {\n    font-size: 0.85em; }\n  cagov-chart-re-pop .chart-tooltip--repop {\n    min-width: 100px; }\n");class x extends window.HTMLElement{connectedCallback(){this.chartOptions={subgroups1:["POPULATION_PERCENTAGE","POPULATION_PERCENTAGE_DELTA"],subgroups2:["METRIC_TOTAL_PERCENTAGE","METRIC_TOTAL_DELTA"],dataUrl:t+"/equitydash/cumulative-california.json",state:"California",county:"California",chartColors:["#92C5DE","#FFCF44","#F2F5FC"],selectedMetric:"cases",selectedMetricDescription:"Cases",desktop:{chartSectionOne:{is_single_col:!1,height:700,width:450,margin:{top:20,right:30,bottom:1,left:10}},chartSectionTwo:{is_single_col:!1,height:180,width:450,margin:{top:4,right:30,bottom:0,left:10}}},tablet:{chartSectionOne:{is_single_col:!0,height:700,width:450,margin:{top:20,right:30,bottom:1,left:10}},chartSectionTwo:{is_single_col:!0,height:180,width:450,margin:{top:4,right:30,bottom:0,left:10}}},mobile:{chartSectionOne:{is_single_col:!0,height:700,width:440,margin:{top:20,right:30,bottom:1,left:10}},chartSectionTwo:{is_single_col:!0,height:180,width:440,margin:{top:4,right:30,bottom:0,left:10}}},retina:{chartSectionOne:{is_single_col:!0,height:700,width:440,margin:{top:20,right:30,bottom:1,left:10}},chartSectionTwo:{is_single_col:!0,height:180,width:440,margin:{top:4,right:30,bottom:0,left:10}}}},_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"];window.addEventListener("resize",(()=>{_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.retrieveData(this.chartOptions.dataUrl),this.translationsObj=b(this),this.county=this.chartOptions.state,this.state=this.chartOptions.state,this.selectedMetric=this.chartOptions.selectedMetric,this.selectedMetricDescription=this.chartOptions.selectedMetricDescription,this.innerHTML=function(t){return`<div class="py-2">\n    <div class="bg-white pt-4 pb-0">\n      <div class="mx-auto">\n      <div class="chart-title">${t.title}</div>\n        <p class="small-text chart-description">${t.description}</p>\n        <div class="svg-holder"></div>\n        <div class="svg-holder-second"></div>\n      </div>\n    </div>\n  </div>\x3c!--END BG lightblue--\x3e`}(this.translationsObj),this.updateTranslatedTextStrings(),this.dimensions=this.chartBreakpointValues.chartSectionOne,this.dimensionsSecond=this.chartBreakpointValues.chartSectionTwo,this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.dimensions.width,this.dimensions.height]).append("g").attr("transform","translate("+this.dimensions.margin.left+","+this.dimensions.margin.top+")"),this.svgSecond=d3.select(this.querySelector(".svg-holder-second")).append("svg").attr("viewBox",[0,0,this.dimensionsSecond.width,this.dimensionsSecond.height]).append("g").attr("transform","translate("+this.dimensionsSecond.margin.left+","+this.dimensionsSecond.margin.top+")"),this.color1=d3.scaleOrdinal().domain(this.chartOptions.subgroups1).range([this.chartOptions.chartColors[0],this.chartOptions.chartColors[2]]),this.color2=d3.scaleOrdinal().domain(this.chartOptions.subgroups2).range([this.chartOptions.chartColors[1],this.chartOptions.chartColors[2]]),this.listenForLocations(),this.classList.remove("d-none"),i(this)}updateTranslatedTextStrings(){this.resetTitle(),this.resetDescription(),this.resetTooltip(),this.resetLegend()}getLocation(){if("California"===this.county)return this.state;{let t=this.translationsObj["county-label"];return this.county+" "+t}}getTitle(){let t=this.translationsObj["chartTitle--"+this.selectedMetric.toLowerCase()];return void 0!==t&&(t=t.replace("placeholderForDynamicLocation",this.getLocation())),t}getDescription(){let t=this.translationsObj["chartDescription--"+this.selectedMetric.toLowerCase()];return t=t.replace("placeholderForDynamicLocation",this.getLocation()),t=t.replace("placeholderForDynamicLocation",this.getLocation()),t}legendStrings(){let t="California"===this.county,e="chartLegend1"+(t?"State":"County")+"--"+this.selectedMetric,a="chartLegend2"+(t?"State":"County");return[this.translationsObj[e],this.translationsObj[a]]}getToolTipCaption1(t,e){if("Total"===t.data.APPLIED_SUPPRESSION)return this.translationsObj["data-missing-applied-suppression-total--"+this.selectedMetric.toLowerCase()]||"";if("Population"===t.data.APPLIED_SUPPRESSION)return this.translationsObj["data-missing-applied-suppression-population--"+this.selectedMetric.toLowerCase()]||"";let a=this.translationsObj["chartToolTip1-caption"];const i="chartMetricName--"+e;let s=e;return i in this.translationsObj&&(s=this.translationsObj[i]),a.replace("placeholderForDynamicLocation",this.getLocation()).replace("placeholderForDynamicLocation",this.getLocation()).replace("placeholder_DEMOGRAPHIC_SET_CATEGORY",t.data.DEMOGRAPHIC_SET_CATEGORY).replace("placeholder_METRIC_TOTAL_PERCENTAGE",t.data.METRIC_TOTAL_PERCENTAGE?parseFloat(t.data.METRIC_TOTAL_PERCENTAGE).toFixed(1)+"%":0).replace("placeholder_SelectedMetric",s).replace("placeholder_LegendString",s).replace("placeholder_POPULATION_PERCENTAGE",t.data.POPULATION_PERCENTAGE?parseFloat(t.data.POPULATION_PERCENTAGE).toFixed(1)+"%":0)}getToolTipCaption2(t,e){if("Total"===t.APPLIED_SUPPRESSION)return translationsObj["data-missing-applied-suppression-total"]||"";if("Population"===t.APPLIED_SUPPRESSION)return translationsObj["data-missing-applied-suppression-population"]||"";return this.translationsObj["chartToolTip2-caption"].replace("placeholderForDynamicLocation",this.getLocation()).replace("placeholderForDynamicLocation",this.getLocation()).replace("placeholder_DEMOGRAPHIC_SET_CATEGORY",t.data.DEMOGRAPHIC_SET_CATEGORY).replace("placeholder_METRIC_TOTAL_PERCENTAGE",t.data.METRIC_TOTAL_PERCENTAGE?parseFloat(t.data.METRIC_TOTAL_PERCENTAGE).toFixed(1)+"%":0).replace("placeholder_SelectedMetric",e).replace("placeholder_POPULATION_PERCENTAGE",t.data.POPULATION_PERCENTAGE?parseFloat(t.data.POPULATION_PERCENTAGE).toFixed(1)+"%":0)}setupTooltip(){return d3.select("cagov-chart-re-pop").append("div").attr("class","tooltip-container tooltip-container--re100k").text("an empty tooltip")}getFilterText(){return document.querySelector("cagov-chart-filter-buttons.js-re-smalls").querySelector(".active").textContent}resetTitle(){this.querySelector(".chart-title").innerHTML=this.getTitle()}resetDescription(){this.querySelector(".chart-description").innerHTML=this.getDescription()}resetTooltip(){}resetLegend(){}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(e){this.county=e.detail.county,"deaths"===this.selectedMetric&&(this.selectedMetric="cases"),this.retrieveData(t+"/equitydash/cumulative-"+this.county.toLowerCase().replace(/ /g,"")+".json"),this.resetTitle(),this.resetDescription();let a=e.detail.county.toLowerCase().replace(" ","_");document.location.replace("#location-"+a)}.bind(this),!1),document.querySelector("cagov-chart-filter-buttons.js-re-smalls").addEventListener("filter-selected",function(t){null!=t.detail.filterKey&&(this.selectedMetricDescription=t.detail.clickedFilterText,this.selectedMetric=t.detail.filterKey,this.alldata&&(this.render(),this.resetDescription(),this.resetTitle()))}.bind(this),!1)}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.alldata=t,this.render()}.bind(this))}checkAppliedDataSuppression(t){let e=null,a=t.map((t=>t.DEMOGRAPHIC_SET_CATEGORY)),i={None:0,Total:0,Population:0,CountySuppressed:!1,TotalSuppression:0};return t.map((t=>{i[t.APPLIED_SUPPRESSION]=i[t.APPLIED_SUPPRESSION]+1,"None"!==t.APPLIED_SUPPRESSION&&(i.TotalSuppression=i.TotalSuppression+1)})),a.length===i.TotalSuppression&&(i.CountySuppressed=!0,e="applied-suppression-total"),e}render(){let t=this.alldata.filter((t=>t.METRIC===this.selectedMetric&&"Other"!==t.DEMOGRAPHIC_SET_CATEGORY&&"Unknown"!==t.DEMOGRAPHIC_SET_CATEGORY)),e=this.alldata.filter((t=>t.METRIC===this.selectedMetric&&("Other"===t.DEMOGRAPHIC_SET_CATEGORY||"Unknown"===t.DEMOGRAPHIC_SET_CATEGORY))),a=C();t.forEach((t=>{a.get(t.DEMOGRAPHIC_SET_CATEGORY)&&(t.DEMOGRAPHIC_SET_CATEGORY=a.get(t.DEMOGRAPHIC_SET_CATEGORY)),t.DISPROPORTIONALITY_RATIO=w(t)})),e.forEach((t=>{a.get(t.DEMOGRAPHIC_SET_CATEGORY)&&(t.DEMOGRAPHIC_SET_CATEGORY=a.get(t.DEMOGRAPHIC_SET_CATEGORY)),t.DISPROPORTIONALITY_RATIO=w(t)}));let i=t.filter((t=>null!==t.DISPROPORTIONALITY_RATIO)),s=t.filter((t=>null===t.DISPROPORTIONALITY_RATIO));i.sort((function(t,e){return d3.descending(t.DISPROPORTIONALITY_RATIO,e.DISPROPORTIONALITY_RATIO)})),t=i.concat(s);let n=e.filter((t=>null!==t.DISPROPORTIONALITY_RATIO)),r=e.filter((t=>null===t.DISPROPORTIONALITY_RATIO));n.sort((function(t,e){return d3.ascending(t.DISPROPORTIONALITY_RATIO,e.DISPROPORTIONALITY_RATIO)})),e=n.concat(r),this.appliedSuppressionStatus=this.checkAppliedDataSuppression(t);let l=t.map((t=>t.DEMOGRAPHIC_SET_CATEGORY)),h=e.map((t=>t.DEMOGRAPHIC_SET_CATEGORY)),d=d3.stack().keys(this.chartOptions.subgroups1)(t),p=d3.stack().keys(this.chartOptions.subgroups2)(t),u=d3.stack().keys(this.chartOptions.subgroups2)(e);this.y=d3.scaleBand().domain(l).range([this.dimensions.margin.top,this.dimensions.height-this.dimensions.margin.bottom]).padding([.6]),this.ySecond=d3.scaleBand().domain(h).range([this.dimensionsSecond.margin.top,this.dimensionsSecond.height-this.dimensionsSecond.margin.bottom]).padding([.2]);let g=this.dimensions.is_single_col?60:40,m=d3.scaleLinear().domain([0,d3.max(d,(t=>d3.max(t,(t=>t[1]))))]).range([0,this.dimensions.width-this.dimensions.margin.right-g]),E=d3.scaleLinear().domain([0,d3.max(p,(t=>d3.max(t,(t=>t[1]))))]).range([0,this.dimensions.width-this.dimensions.margin.right-g]),y=this.legendStrings();!function({component:t,svg:e,x1:a,x2:i,y:s,yAxis:n,stackedData1:r,stackedData2:l,color1:h,color2:d,data:p,tooltip:u,legendStrings:g,legendScope:m="",selectedMetric:E,translationsObj:y,appliedSuppressionStatus:T,chartBreakpointValues:v}){e.selectAll("g").remove(),e.selectAll("rect").remove(),e.selectAll("text").remove(),e.append("g").selectAll("g").data(l).enter().append("g").attr("fill",(t=>d(t.key))).selectAll("rect").data((t=>t)).enter().append("rect").attr("x",(t=>i(t[0]))).attr("y",(t=>s(t.data.DEMOGRAPHIC_SET_CATEGORY)+20)).attr("width",(t=>i(t[1])-i(t[0]))).attr("height","10px").attr("tabindex","0").attr("aria-label",((t,e)=>"unused_caption1"));let C=e.append("g").attr("class","svg-first-section").selectAll("g").data(r).enter().append("g").attr("fill",(t=>h(t.key))).selectAll("rect").data((t=>t)).enter();C.append("rect").attr("x",(t=>a(t[0]))).attr("y",(t=>s(t.data.DEMOGRAPHIC_SET_CATEGORY))).attr("width",(t=>a(t[1])-a(t[0]))).attr("height","10px"),C.append("rect").attr("x",(t=>a(t[0]))).attr("y",(t=>s(t.data.DEMOGRAPHIC_SET_CATEGORY)-5)).attr("width",(t=>a(t[1])-a(t[0]))).attr("height","40px").attr("fill","transparent").attr("tabindex","0").attr("aria-label",((e,a)=>{let i=t.getToolTipCaption1(e,E);return i=i.replace(/(<([^>]+)>)/gi," "),i=i.replace(/\s+/g," "),i=i.trim(),i})).on("mouseover focus",(function(e,a){d3.select(this).transition();let i=t.getToolTipCaption1(a,E);u.html(`<div class="chart-tooltip"><div>${i}</div></div>`),u.style("visibility","visible"),u.style("left","90px"),u.style("top",`${e.offsetY+230}px`)})).on("mouseout",(function(t){d3.select(this).transition(),u.style("visibility","hidden")})),e.append("g").call(n);let b=t.dimensions.is_single_col?25:5;e.append("g").attr("class","bars").selectAll(".bars").data(p).join((t=>{t.append("text").attr("class","bars").attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+8)).attr("x",(t=>i(100)+b)).attr("height",s.bandwidth()).text((t=>t.POPULATION_PERCENTAGE?parseFloat(t.POPULATION_PERCENTAGE).toFixed(1)+"%":"0%")).attr("text-anchor","end")})),e.append("g").attr("class","bars").selectAll(".bars").data(p).join((t=>{t.append("text").attr("class",(t=>"bars"+(null===t.METRIC_TOTAL_PERCENTAGE?" bars-unknown":""))).attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+28)).attr("x",(t=>a(100)+b)).attr("height",s.bandwidth()).text((t=>null!==t.METRIC_TOTAL_PERCENTAGE?t.METRIC_TOTAL_PERCENTAGE?parseFloat(t.METRIC_TOTAL_PERCENTAGE).toFixed(1)+"%":"0%":"")).attr("text-anchor","end")})),e.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(p).join((t=>{t.append("text").attr("class","change-from-month-labels").attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+47)).attr("x",(t=>"Population"===t.APPLIED_SUPPRESSION||"Total"===t.APPLIED_SUPPRESSION?i(1):i(1)+20)).attr("height",s.bandwidth()).html((t=>"Population"===t.APPLIED_SUPPRESSION?`<tspan class="withheld-label">${y["data-missing-applied-suppression-population--"+E.toLowerCase()]||""}</tspan>`:"Total"===t.APPLIED_SUPPRESSION?`<tspan class="withheld-label">${y["data-missing-applied-suppression-total--"+E.toLowerCase()]||""}</tspan>`:t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO?`<tspan class="highlight-data">${parseFloat(t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO).toFixed(1)}%</tspan> ${y.chartLineDiff}`:`<tspan class="highlight-data">0%</tspan> ${y.chartLineDiff}`)).attr("text-anchor","end")})),e.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(p).join((t=>{t.append("svg").attr("y",(t=>s(t.DEMOGRAPHIC_SET_CATEGORY)+35)).attr("x",(t=>i(1))).html((t=>"Population"===t.APPLIED_SUPPRESSION||"Total"===t.APPLIED_SUPPRESSION?"":!t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO||Math.abs(t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO)<.05?'<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16.4155 8.8403L13.0689 12.013C12.8394 12.2306 12.4721 12.2234 12.2554 11.9949C12.0388 11.7663 12.0483 11.4018 12.2807 11.1815L14.5958 8.98667L1.0023 8.9417L0.784831 8.9417C0.629791 8.93708 0.495915 8.90016 0.388909 8.7873C0.284502 8.67717 0.227827 8.53225 0.231476 8.37719C0.2349 8.22757 0.297533 8.095 0.410888 7.98753C0.563911 7.84246 0.720296 7.81444 0.823716 7.81572L1.0023 7.816L14.6338 7.79526L12.449 5.49078C12.2324 5.26226 12.2419 4.89773 12.4743 4.67745C12.7038 4.45985 13.0712 4.46706 13.2878 4.69558L16.4409 8.02148C16.6573 8.25543 16.6478 8.62 16.4155 8.8403Z" fill="#1F2574"/>\n</svg>':parseFloat(t.METRIC_VALUE_PERCENTAGE_DELTA_FROM_30_DAYS_AGO)>0?'<svg width="15" height="10" viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 0.581819V5.19326C17 5.50954 16.742 5.77116 16.4271 5.77116C16.1122 5.77116 15.8543 5.51344 15.8543 5.19326V2.00308L10.1901 7.93042C10.0839 8.03975 9.93972 8.09832 9.78419 8.09832C9.63244 8.09832 9.48828 8.03975 9.37826 7.93042L6.11944 4.64647L0.971201 9.8321C0.86118 9.94143 0.720802 10 0.565271 10C0.413518 10 0.26936 9.94143 0.15934 9.8321C0.0531121 9.72667 0 9.59001 0 9.43381C0 9.22295 0.0872582 9.09018 0.15934 9.01601L5.70966 3.42434C5.81968 3.315 5.96006 3.25643 6.11559 3.25643C6.26734 3.25643 6.4115 3.315 6.52152 3.42434L9.78035 6.70829L15.0158 1.1558H11.8403C11.5254 1.1558 11.2674 0.898078 11.2674 0.5779C11.2674 0.26162 11.5254 0 11.8403 0H16.4233C16.742 0.00390471 17 0.261621 17 0.581819H17Z" fill="#FF8000"/>\n  </svg>':'<svg width="15" height=10 viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 9.41818V4.80674C17 4.49046 16.742 4.22884 16.4271 4.22884C16.1122 4.22884 15.8543 4.48656 15.8543 4.80674V7.99692L10.1901 2.06958C10.0839 1.96025 9.93972 1.90168 9.78419 1.90168C9.63244 1.90168 9.48828 1.96025 9.37826 2.06958L6.11944 5.35353L0.971201 0.167904C0.86118 0.0585697 0.720802 0 0.565271 0C0.413518 0 0.26936 0.0585717 0.15934 0.167904C0.0531121 0.273332 0 0.409992 0 0.566192C0 0.777052 0.0872582 0.909822 0.15934 0.983993L5.70966 6.57566C5.81968 6.685 5.96006 6.74357 6.11559 6.74357C6.26734 6.74357 6.4115 6.685 6.52152 6.57566L9.78035 3.29171L15.0158 8.8442H11.8403C11.5254 8.8442 11.2674 9.10192 11.2674 9.4221C11.2674 9.73838 11.5254 10 11.8403 10H16.4233C16.742 9.9961 17 9.73838 17 9.41818H17Z" fill="#003D9D"/>\n  </svg>'))}));const _=v.chartSectionOne.width<400;e.append("rect").attr("x",0).attr("y",-20).attr("width",15).attr("height",15).attr("fill","#92C5DE"),e.append("rect").attr("x",_?0:190).attr("y",_?4:-20).attr("width",15).attr("height",15).attr("fill","#FFCF44"),e.append("text").attr("x",20).attr("y",-12).attr("class","legend-label").attr("dy","0.35em").text("% "+g[1]),e.append("text").attr("x",_?20:210).attr("y",_?12:-12).attr("class","legend-label").attr("dy","0.35em").text("% "+g[0]);let f="chartOverlay-svg-first-section";null!==T?o(e,"cagov-chart-re-pop",f,v,y[T]?y[T]:""):c(e,f)}({component:this,svg:this.svg,x1:m,x2:E,y:this.y,yAxis:t=>t.attr("class","bar-label").attr("transform","translate(4,-32)").call(d3.axisLeft(this.y).tickSize(0)).call((t=>t.selectAll(".domain").remove())),stackedData1:d,stackedData2:p,color1:this.color1,color2:this.color2,data:t,tooltip:this.setupTooltip(),selectedMetric:this.selectedMetric,translationsObj:this.translationsObj,legendStrings:y,appliedSuppressionStatus:this.appliedSuppressionStatus,chartBreakpointValues:this.chartBreakpointValues}),A({component:this,svg:this.svgSecond,x1:m,x2:E,y:this.ySecond,yAxis:t=>t.attr("class","bar-label").attr("transform","translate(4,-44)").call(d3.axisLeft(this.ySecond).tickSize(0)).call((t=>t.selectAll(".domain").remove())),stackedData1:u,stackedData2:null,color1:this.color1,color2:this.color2,data:e,tooltip:this.setupTooltip(),selectedMetric:this.selectedMetric,translationsObj:this.translationsObj,legendStrings:y,appliedSuppressionStatus:this.appliedSuppressionStatus,chartBreakpointValues:this.chartBreakpointValues})}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.alldata=t,this.render()}.bind(this))}}function S(t){const e=t.split("-"),a=+e[0],i=+e[1],s=+e[2];return new Date(a,i-1,s)}function L(t,e={month:"long",day:"numeric",year:"numeric"},a=0){const i=S(t);return 0!=a&&i.setDate(i.getDate()+a),function(t,e={month:"long",day:"numeric",year:"numeric"}){return t.toLocaleString(document.documentElement.lang,e)}(i,e)}window.customElements.define("cagov-chart-re-pop",x);class O{constructor(t,e){let a=e.range();this.needs_anno=t,this.node=document.createElementNS("http://www.w3.org/2000/svg","g"),this.node.setAttribute("pointer-events","none"),this.node.innerHTML=(t?`<rect x="0" width=0.25 y=${a[1]} height=${a[0]-a[1]} fill="#003D9D" stroke=none opacity=0.5></rect>\n        <rect x="-5.5" width="10" y="89.5" height="3.5" fill="white" opacity=0.5></rect>\n        <text class="date" y="62", x="0"></text>`:"")+'<g class="tip">\n      <rect height="38" y="-25"></rect> \n      <text class="label1" x="0"></text>\n      <circle r="3" dx="3" x="-4" transform=translate(-5,130)></circle>\n    </g>\n    '}show(t,e,a,i,s){let n=t.METRIC_VALUE,r=e(S(t.DATE)),l=a(n)+4,o=e.range(),c=(o[0]+o[1])/2,h=(100*n).toFixed(1),d=i?45:-45;const p=this.node;p.removeAttribute("display"),p.setAttribute("text-anchor",r>c?"end":"start"),p.setAttribute("transform",`translate(${r}, 0)`),p.setAttribute("aria-label",h);const u=this.node.querySelector("text.label1");u.setAttribute("x",r>c?0:10),u.innerHTML=`<tspan font-weight="bold">${h}%</tspan>&nbsp;<tspan>${s}</tspan>`,u.setAttribute("transform",`translate(0,${l+d})`);const g=this.node.querySelector(".tip rect"),m=u.getBBox().width+20;g.setAttribute("width",m),g.setAttribute("x",r>c?10-m:0),g.setAttribute("transform",`translate(0,${l+d})`);this.node.querySelector(".tip circle").setAttribute("transform",`translate(0,${l-4})`)}hide(){this.node.setAttribute("display","none")}}l("cagov-chart-d3-lines .tick line {\n  stroke: #ccc;\n  /* F2F5FC */\n  stroke-width: 0.5; }\n\ncagov-chart-d3-lines .tick {\n  font-size: 0.2rem; }\n\ncagov-chart-d3-lines svg text {\n  font-size: 1rem; }\n\ncagov-chart-d3-lines text.label1 {\n  font-size: 0.85rem; }\n\ncagov-chart-d3-lines .tip rect {\n  filter: drop-shadow(0px 5px 2px rgba(0, 0, 0, 0.14));\n  fill: white;\n  height: 38px; }\n");class R extends window.HTMLElement{connectedCallback(){this.translationsObj=this.getTranslations(this),this.innerHTML=(this.translationsObj,'<div class="py-2">\n    <div class="bg-white py-4">\n      <div class="svg-holder">\n      </div>\n    </div>\n  </div>'),this.chartOptions={dataUrl:t+"/equitydash/healthequity-california.json",chartColors:["#000000","#2772B3"],desktop:{width:613,height:355,margin:{top:30,right:20,bottom:40,left:30},legendPosition:{x:300,y:10}},tablet:{width:440,height:355,margin:{top:30,right:20,bottom:40,left:30},legendPosition:{x:160,y:18}},mobile:{width:440,height:600,margin:{top:30,right:20,bottom:40,left:30},legendPosition:{x:160,y:18}},retina:{width:320,height:450,margin:{top:30,right:20,bottom:40,left:30},legendPosition:{x:100,y:18}}},_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"];window.addEventListener("resize",(()=>{_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.textLabels={yAxisLabel:this.translationsObj["y-axis-label"],data1Legend:this.translationsObj["data1-legend"],data1LegendLocal:this.translationsObj["data1-legend-local"],data2Legend:this.translationsObj["data2-legend"],missingDataCaption:this.translationsObj["missing-data-caption"],dataAnomaliesCaption:this.translationsObj["data-anomalies-caption"]},this.svg=d3.create("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]),window.fetch(this.chartOptions.dataUrl).then((t=>t.json())).then((t=>{this.writeChart(t,this.svg,this.textLabels.data1Legend,this.textLabels.data2Legend),this.querySelector(".svg-holder").appendChild(this.svg.node())}));let e=[this.textLabels.data1Legend,this.textLabels.data2Legend];this.legend=this.svg.append("g").attr("class","legend").attr("transform",`translate(${this.chartBreakpointValues.legendPosition.x},${this.chartBreakpointValues.legendPosition.y})`),this.writeLegendColors(this.chartOptions.chartColors,this.legend),this.writeLegendLabels(e,this.legend),this.listenForLocations(),this.classList.remove("d-none"),null!==this.querySelector(".d-none")&&this.querySelector(".d-none").classList.remove("d-none"),i(this)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(e){this.county=e.detail.county;let a=this.textLabels.data1LegendLocal.replace("placeholderForDynamicLocation",this.county),i=this.textLabels.data2Legend;window.fetch(t+"/equitydash/healthequity-"+this.county.toLowerCase().replace(/ /g,"")+".json").then((t=>t.json())).then((t=>{this.writeChart(t,this.svg,a,i)}))}.bind(this),!1)}bisect(t,e){const a=d3.bisector((t=>S(t.DATE))).left,i=Math.min(t.length-1,a(t,e,1)),s=t[i-1],n=t[i];return e-S(s.DATE)>S(n.DATE)-e?n:s}writeChart(t,e,a,i){let s=this;s.dims=void 0!==this.chartBreakpointValues?this.chartBreakpointValues:this.chartOptions.desktop;let n=t.county_positivity_all_nopris,r=t.county_positivity_low_hpi,l=L(r[r.length-1].DATE);document.querySelectorAll('span[data-replacement="d3-lines-report-date"]').forEach((t=>{t.innerHTML=l}));let h=r.filter((t=>null==t.METRIC_VALUE)).length>0,d="San Diego"===n[0].COUNTY,p=h||d,u=[a,this.textLabels.data2Legend];this.rewriteLegend(this.svg,u),e.selectAll(".legend").attr("visibility",p?"hidden":"visible");let g=d3.min(h?n:r,(t=>S(t.DATE)));g.setDate(g.getDate()-1);let m=d3.max(n,(t=>S(t.DATE)));m.setDate(m.getDate()+1);let E={min:g,max:m},y=d3.scaleTime().domain([E.min,E.max]).range([this.chartBreakpointValues.margin.left,this.chartBreakpointValues.width-this.chartBreakpointValues.margin.right]),T=Math.min(1,1.4*d3.max(h?n:r,(t=>t.METRIC_VALUE))),v=d3.scaleLinear().domain([0,T]).range([this.chartBreakpointValues.height-this.chartBreakpointValues.margin.bottom,this.chartBreakpointValues.margin.top]),C=y.range(),b=v.range(),_=C[1]-C[0],f=b[1]-b[0],A=Math.min(10,1+Math.floor(100*T)),w=d3.format(".0%"),x=d3.line().x(((t,e)=>y(S(t.DATE)))).y((t=>v(t.METRIC_VALUE)));e.selectAll(".county_positivity_all_nopris").remove(),e.selectAll(".tick").remove(),e.selectAll(".y-label").remove(),p||e.append("path").datum(n.sort((function(t,e){return t.DATE>e.DATE}))).attr("fill","none").attr("stroke",this.chartOptions.chartColors[0]).attr("stroke-width",3).attr("class","county_positivity_all_nopris").attr("d",x),e.selectAll(".county_positivity_low_hpi").remove(),p||e.append("path").datum(r.sort((function(t,e){return t.DATE>e.DATE}))).attr("fill","none").attr("stroke",this.chartOptions.chartColors[1]).attr("stroke-width",3).attr("class","county_positivity_low_hpi").attr("d",x),e.append("g").call((t=>t.attr("transform","translate(0,"+this.chartBreakpointValues.margin.bottom+")").attr("font-weight","bold").call(d3.axisBottom(y).ticks(d3.timeWeek.every(1)).tickFormat((t=>t.toLocaleString(document.documentElement.lang,{month:"short",day:"numeric"}))).tickSize(-f)).call((t=>t.select(".domain").remove())))),e.append("g").call((t=>t.attr("transform","translate("+this.chartBreakpointValues.margin.left+", 0)").attr("font-weight","bold").call(d3.axisLeft(v).ticks(A).tickFormat(w).tickSize(-_)).call((t=>t.select(".domain").remove())))),e.append("g").call((t=>t.append("text").attr("transform","translate(0 ,"+(this.chartBreakpointValues.margin.top-10)+")").style("text-anchor","left").attr("font-weight","bold").text(s.textLabels.yAxisLabel).attr("class","y-label")));let R="chartOverlay-d3-lines";if(h?o(e,"cagov-chart-d3-lines",R,this.chartBreakpointValues,this.textLabels.missingDataCaption):d?o(e,"cagov-chart-d3-lines",R,this.chartBreakpointValues,this.textLabels.dataAnomaliesCaption):c(e,R),e.on("mousemove",null),e.on("mouseleave touchend",null),!p){const t=new O(!0,v),s=new O(!1,v);e.on("mousemove",(e=>{var l=d3.pointer(e);let o=this.doMath(n,r,y,v,l);t.show(this.bisect(n,y.invert(l[0])),y,v,o,a),p||s.show(this.bisect(r,y.invert(l[0])),y,v,!o,i)})).on("mouseleave touchend",(e=>{t.hide(),p||s.hide()})),e.append((()=>t.node)),p||e.append((()=>s.node))}}rewriteLines(t,e,a,i){t.selectAll(".barshere rect").data(e).transition().duration(300).attr("x",((t,e)=>a(e))).attr("y",(t=>i(t.CASE_RATE_PER_100K))).attr("height",(t=>i(0)-i(t.CASE_RATE_PER_100K)))}writeLegendColors(t,e){e.selectAll("rect").data(t).enter().append("rect").attr("x",(function(t,e){return 0})).attr("y",(function(t,e){return 20*e-10})).attr("width",20).attr("height",3).attr("fill",(function(t,e){return t}))}writeLegendLabels(t,e){e.selectAll("text").data(t).enter().append("text").text((function(t){return t})).attr("x",(function(t,e){return 25})).attr("y",(function(t,e){return 20*e-10})).attr("text-anchor","start").attr("font-weight","bold").attr("dominant-baseline","hanging")}rewriteLegend(t,e){t.selectAll(".legend text").data(e).text((t=>t))}getTranslations(){return b(this)}doMath(t,e,a,i,s){let n=this.bisect(t,a.invert(s[0])),r=this.bisect(e,a.invert(s[0]));return i(n.METRIC_VALUE)+4>i(r.METRIC_VALUE)+4}}window.customElements.define("cagov-chart-d3-lines",R);l("cagov-chart-equity-data-completeness .chart-tooltip--missingness {\n  min-width: 300px; }\n\ncagov-chart-equity-data-completeness .bar-label .tick text {\n  text-transform: capitalize; }\n");class P extends window.HTMLElement{connectedCallback(){this.translationsObj=this.getTranslations(this),this.updateDate="",this.innerHTML=function(t){const e="special-note"in t?"":'style="display:none;"',a="data-source"in t?t["data-source"]:"";return`<div class="py-2">\n    <div class="container">\n      <div class="col-lg-12 bg-white py-4">\n\n        <div class="row">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n            <div class="chart-title">${t.title}</div>\n            <div class="svg-holder">\n            </div>\n          </div>\n        </div>\n\n        <div class="row">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n\n          <div class="mt-2">\n            ${a}\n          </div>\n\n            <div class="wp-block-cgb-block-chart-drawer js-qa-exclude"><cagov-accordion class="chart-drawer">\n            <div class="card"><button class="card-header accordion-alpha" type="button" aria-expanded="false"><div class="plus-munus"><cagov-plus></cagov-plus><cagov-minus></cagov-minus></div>\n            <div class="accordion-title js-qa-exclude">Chart information</div></button><div class="card-container" aria-hidden="true"><div class="card-body">\n\n              <p class="small-text">${t.footnote}</p>\n\n            </div></div></div></cagov-accordion></div>\n  \n          </div>\n        </div>\n\n\n        <div class="row" ${e}>\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n            <div class="special-note mt-1 mb-1"><p>${t["special-note"]}</p></div>\n          </div>\n        </div>\n      </div>\x3c!--END col-12--\x3e\n    </div>\x3c!--END CONTAINER--\x3e\n  </div>`}(this.translationsObj),this.chartOptions={subgroups:["NOT_MISSING","MISSING"],selectedMetric:"race_ethnicity",dataUrl:t+"/equitydash/missingness-california.json",state:"California",county:"California",displayOrder:["tests","cases","deaths"],backgroundFill:"#F2F5FC",chartColors:["#92C5DE","#FFCF44"],desktop:{fontSize:14,height:214,width:613,margin:{top:40,right:0,bottom:20,left:0},heightMultiplier:100,labelOffsets:[-52,-52,-57]},tablet:{fontSize:14,height:214,width:440,margin:{top:40,right:0,bottom:20,left:0},heightMultiplier:100,labelOffsets:[-52,-52,-57]},mobile:{fontSize:12,height:600,width:440,margin:{top:40,right:0,bottom:20,left:0},heightMultiplier:100,labelOffsets:[-52,-52,-57]},retina:{fontSize:12,height:600,width:320,margin:{top:40,right:0,bottom:20,left:0},heightMultiplier:100,labelOffsets:[-52,-52,-57]}},_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"];window.addEventListener("resize",(()=>{_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.metricFilter=document.querySelector("cagov-chart-filter-buttons.js-missingness-smalls"),this.svg=d3.select(this.querySelector(".svg-holder")).append("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).append("g").attr("transform","translate("+this.chartBreakpointValues.margin.left+","+this.chartBreakpointValues.margin.top+")"),this.color=d3.scaleOrdinal().domain(this.chartOptions.subgroups).range(this.chartOptions.chartColors),this.dataUrl=this.chartOptions.dataUrl,this.county=this.chartOptions.county,this.state=this.chartOptions.state,this.selectedMetric=this.chartOptions.selectedMetric,this.retrieveData(this.dataUrl),this.listenForLocations(),this.classList.remove("d-none"),null!==this.querySelector(".d-none")&&this.querySelector(".d-none").classList.remove("d-none"),i(this)}listenForLocations(){document.querySelector("cagov-county-search").addEventListener("county-selected",function(e){this.county=e.detail.county,this.dataUrl=t+"/equitydash/missingness-"+this.county.toLowerCase().replace(/ /g,"")+".json",this.retrieveData(this.dataUrl),this.resetTitle()}.bind(this),!1),this.metricFilter.addEventListener("filter-selected",function(t){this.selectedMetricDescription=t.detail.clickedFilterText,this.selectedMetric=t.detail.filterKey,this.retrieveData(this.dataUrl),this.resetDescription(),this.resetTitle()}.bind(this),!1)}resetTitle(){this.querySelector(".chart-title").innerHTML=this.translationsObj["tab-label"]?this.translationsObj["tab-label"]:null,this.querySelector('.chart-title span[data-replace="metric-filter"]').innerHTML=this.getFilterText().toLowerCase(),this.querySelector('.chart-title span[data-replace="location"]').innerHTML=this.getLocation()}resetUpdateDate(){this.querySelectorAll('span[data-replacement="data-completeness-report-date"]').forEach((t=>{t.innerHTML=this.updateDate}))}getFilterText(){return this.metricFilter.querySelector(".active").textContent}getLocation(){return"California"===this.county?this.state:this.county}resetDescription(){}formatDataSet(t){let e=[],a={};void 0!==t.cases&&(a=t.cases,a.METRIC="cases",e.push(a));let i={};void 0!==t.deaths&&(i=t.deaths,i.METRIC="deaths",e.push(i));let s={};return void 0!==t.tests&&(s=t.tests,s.METRIC="tests",e.push(t.tests)),e.forEach((t=>{this.formatDataObject(t)})),e.sort((function(t,e){return d3.descending(t.MISSING,e.MISSING)})),e}formatDataObject(t){0===t.TOTAL&&0===t.MISSING||1===t.TOTAL&&0===t.MISSING?t.MISSING=0:0!==t.TOTAL&&null!==t.TOTAL||1!==t.MISSING?(t.MISSING=t.MISSING/t.TOTAL,isNaN(t.MISSING)&&(t.MISSING=1)):t.MISSING=1,0===t.TOTAL&&0===t.NOT_MISSING||1===t.TOTAL&&0===t.NOT_MISSING?t.NOT_MISSING=0:0!==t.TOTAL&&null!==t.TOTAL||1!==t.NOT_MISSING?(t.NOT_MISSING=t.NOT_MISSING/t.TOTAL,isNaN(t.NOT_MISSING)&&(t.NOT_MISSING=0)):t.NOT_MISSING=1}getDomains(t){let e=t.map((t=>t.METRIC)),a=this.chartOptions.displayOrder,i=[];return a.map((t=>{e.indexOf(t)>=0&&i.push(t)})),i}getTranslations(){let t=b(this);return t.chartTitle=({metricFilter:e="race_ethnicity",location:a="California"})=>t["tab-label"],t.chartTooltip=({metric:e="tests",highlightData:a=0,complete:i=!0,suppression:s=!1})=>{let n=this.getLocation(),r=this.getFilterText().toLowerCase(),l=t["chart-tooltip-complete"];return i||(l=t["chart-tooltip-missing"]),l=l.replace('<span data-replace="metric">tests</span>',`<span data-replace="metric">${e}</span>`),l=l.replace('<span data-replace="highlight-data"></span>',`<span data-replace="highlight-data">${a}</span>`),l=l.replace('<span data-replace="location">California</span>',`<span data-replace="location">${n}</span>`),l=l.replace('<span data-replace="data-type">race and ethnicity</span>',`<span data-replace="data-type">${r}</span>`),s&&(l=t["data-missing-applied-suppression-total"]),`<div class="chart-tooltip"><div>${l}</div></div>`},t}drawSvg(t){let e=d3.stack().keys(this.chartOptions.subgroups)(t),a=this.getDomains(t),i=this.chartBreakpointValues.heightMultiplier*a.length;d3.select(this.querySelector(".svg-holder svg")).attr("viewBox",[0,0,this.chartBreakpointValues.width,i]),this.x=d3.scaleLinear().domain([0,d3.max(e,(t=>d3.max(t,(t=>t[1]))))]).range([0,this.chartBreakpointValues.width]),this.y=d3.scaleBand().domain(a).range([this.chartBreakpointValues.margin.top,i-this.chartBreakpointValues.margin.bottom]);let s=this.chartBreakpointValues.labelOffsets,n=a.length<=s.length?s[a.length-1]:this.chartBreakpointValues.labelOffsets[0];this.yAxis=t=>t.attr("class","bar-label").attr("transform","translate(5,"+n+")").call(d3.axisLeft(this.y).tickSize(0).tickFormat((t=>this.translationsObj.displayOrder[t]))).call((t=>t.selectAll(".domain").remove())),this.tooltip=d3.select("cagov-chart-equity-data-completeness").append("div").attr("class","tooltip-container tooltip-container--missingness").text(this.translationsObj["empty-tooltip"]),function(t,e,a,i,s,n,r,l,o){t.selectAll("g").remove(),t.selectAll("rect").remove(),t.selectAll("text").remove(),t.append("g").selectAll("g").data(s).enter().append("g").attr("fill","#F2F5FC").selectAll("rect").attr("width","10px").data((t=>t)).enter().append("rect").attr("x",(t=>e(t[0]))).attr("y",(t=>a(t.data.METRIC))).attr("width",(t=>e(1)-e(0))).attr("height","10px");let c=t.append("g").selectAll("g").data(s).enter().append("g").attr("fill",(t=>n(t.key))).selectAll("rect").attr("width","40px").data((t=>t)).enter();c.append("rect").attr("x",(t=>e(t[0]))).attr("y",(t=>a(t.data.METRIC))).attr("width",(t=>e(t[1])-e(t[0]))).attr("height","10px"),c.append("rect").attr("x",(t=>e(t[0]))).attr("y",(t=>a(t.data.METRIC)-10)).attr("width",(t=>e(t[1])-e(t[0]))).attr("height","30px").attr("fill","transparent").attr("tabindex","0").attr("aria-label",((t,e)=>{let a=t.data.NOT_MISSING?parseFloat(100*t.data.NOT_MISSING).toFixed(1)+"%":0,i=t.data.MISSING?parseFloat(100*t.data.MISSING).toFixed(1)+"%":0,s="";return s=0==t[0]?o.chartTooltip({metric:t.data.METRIC,highlightData:a,complete:!0}):o.chartTooltip({metric:t.data.METRIC,highlightData:i,complete:!1}),s=s.replace(/(<([^>]+)>)/gi," "),s=s.replace(/\s+/g," "),s=s.trim(),s})).on("mouseover focus",(function(t,e){d3.select(this).transition(),l.html((()=>{if(null===e.data.PERCENT_COMPLETE)return"";{let t=e.data.NOT_MISSING?parseFloat(100*e.data.NOT_MISSING).toFixed(1)+"%":0,a=e.data.MISSING?parseFloat(100*e.data.MISSING).toFixed(1)+"%":0;return 0==e[0]?o.chartTooltip({metric:e.data.METRIC,highlightData:t,complete:!0}):o.chartTooltip({metric:e.data.METRIC,highlightData:a,complete:!1})}})),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),l.style("visibility","visible"),l.style("left","90px"),l.style("top",`${t.offsetY+120}px`)})).on("mouseout",(function(t){d3.select(this).transition(),l.style("visibility","hidden")})),t.append("g").attr("class","more-than-labels").selectAll(".more-than-labels").data(r).join((t=>{t.append("text").attr("class","more-than-labels").attr("y",(t=>a(t.METRIC)+25)).attr("x",(t=>null===t.PERCENT_COMPLETE?e(0)+72:e(0)+19)).attr("height",a.bandwidth()).html((t=>null===t.PERCENT_COMPLETE?`<tspan>${o["data-missing-applied-suppression-total"]||""}</tspan>`:0==parseFloat(t.PERCENT_COMPLETE_30_DAYS_DIFF/t.PERCENT_COMPLETE_30_DAYS_PRIOR*100).toFixed(1)?`<tspan class="highlight-data">0%</tspan>  ${o["percent-change-previous-month"]}`:`<tspan class="highlight-data">${0!=t.PERCENT_COMPLETE_30_DAYS_PRIOR?parseFloat(100*t.PERCENT_COMPLETE_30_DAYS_DIFF).toFixed(1):"0"}%</tspan> ${o["percent-change-previous-month"]}`)).attr("text-anchor","start")})),t.append("g").call(i),t.append("g").attr("class","more-than-labels").selectAll(".more-than-labels").data(r).join((t=>{t.append("svg").attr("y",(t=>a(t.METRIC)+15)).attr("x",(t=>e(0))).html((t=>null===t.PERCENT_COMPLETE?"":parseFloat(t.PERCENT_COMPLETE_30_DAYS_DIFF/t.PERCENT_COMPLETE_30_DAYS_PRIOR*100)>0?'<svg width="15" height="10" viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 0.581819V5.19326C17 5.50954 16.742 5.77116 16.4271 5.77116C16.1122 5.77116 15.8543 5.51344 15.8543 5.19326V2.00308L10.1901 7.93042C10.0839 8.03975 9.93972 8.09832 9.78419 8.09832C9.63244 8.09832 9.48828 8.03975 9.37826 7.93042L6.11944 4.64647L0.971201 9.8321C0.86118 9.94143 0.720802 10 0.565271 10C0.413518 10 0.26936 9.94143 0.15934 9.8321C0.0531121 9.72667 0 9.59001 0 9.43381C0 9.22295 0.0872582 9.09018 0.15934 9.01601L5.70966 3.42434C5.81968 3.315 5.96006 3.25643 6.11559 3.25643C6.26734 3.25643 6.4115 3.315 6.52152 3.42434L9.78035 6.70829L15.0158 1.1558H11.8403C11.5254 1.1558 11.2674 0.898078 11.2674 0.5779C11.2674 0.26162 11.5254 0 11.8403 0H16.4233C16.742 0.00390471 17 0.261621 17 0.581819H17Z" fill="#003D9D"/>\n  </svg>':0==parseFloat(t.perc_total_diff_30_day_prev/t.PERCENT_COMPLETE_30_DAYS_PRIOR*100).toFixed(1)?'<svg width="15" height=10 viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 9.41818V4.80674C17 4.49046 16.742 4.22884 16.4271 4.22884C16.1122 4.22884 15.8543 4.48656 15.8543 4.80674V7.99692L10.1901 2.06958C10.0839 1.96025 9.93972 1.90168 9.78419 1.90168C9.63244 1.90168 9.48828 1.96025 9.37826 2.06958L6.11944 5.35353L0.971201 0.167904C0.86118 0.0585697 0.720802 0 0.565271 0C0.413518 0 0.26936 0.0585717 0.15934 0.167904C0.0531121 0.273332 0 0.409992 0 0.566192C0 0.777052 0.0872582 0.909822 0.15934 0.983993L5.70966 6.57566C5.81968 6.685 5.96006 6.74357 6.11559 6.74357C6.26734 6.74357 6.4115 6.685 6.52152 6.57566L9.78035 3.29171L15.0158 8.8442H11.8403C11.5254 8.8442 11.2674 9.10192 11.2674 9.4221C11.2674 9.73838 11.5254 10 11.8403 10H16.4233C16.742 9.9961 17 9.73838 17 9.41818H17Z" fill="none"/>\n  </svg>':'<svg width="15" height=10 viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 9.41818V4.80674C17 4.49046 16.742 4.22884 16.4271 4.22884C16.1122 4.22884 15.8543 4.48656 15.8543 4.80674V7.99692L10.1901 2.06958C10.0839 1.96025 9.93972 1.90168 9.78419 1.90168C9.63244 1.90168 9.48828 1.96025 9.37826 2.06958L6.11944 5.35353L0.971201 0.167904C0.86118 0.0585697 0.720802 0 0.565271 0C0.413518 0 0.26936 0.0585717 0.15934 0.167904C0.0531121 0.273332 0 0.409992 0 0.566192C0 0.777052 0.0872582 0.909822 0.15934 0.983993L5.70966 6.57566C5.81968 6.685 5.96006 6.74357 6.11559 6.74357C6.26734 6.74357 6.4115 6.685 6.52152 6.57566L9.78035 3.29171L15.0158 8.8442H11.8403C11.5254 8.8442 11.2674 9.10192 11.2674 9.4221C11.2674 9.73838 11.5254 10 11.8403 10H16.4233C16.742 9.9961 17 9.73838 17 9.41818H17Z" fill="#FF8000"/>\n  </svg>'))})),t.append("g").attr("class","change-from-month-labels").selectAll(".change-from-month-labels").data(r).join((t=>{t.append("text").attr("y",(t=>a(t.METRIC)-12)).attr("x",(t=>e(1))).attr("height",a.bandwidth()).html((t=>{if(null===t.PERCENT_COMPLETE)return null;{let e=parseFloat(100*t.NOT_MISSING).toFixed(1),a=parseFloat(100*t.MISSING).toFixed(1);return`<tspan class="highlight-data">${e}%</tspan> ${o.reported} (<tspan class="highlight-data">${a}%</tspan> ${o.missing})`}})).attr("text-anchor","end")})),t.append("rect").attr("x",0).attr("y",-20).attr("width",15).attr("height",15).attr("class","legend-label").attr("fill","#92C5DE"),t.append("rect").attr("x",135).attr("y",-20).attr("width",15).attr("height",15).attr("fill","#FFCF44"),t.append("text").attr("x",20).attr("y",-12).attr("dy","0.35em").attr("class","legend-label").text(o["data-reported"]),t.append("text").attr("x",155).attr("y",-12).attr("dy","0.35em").attr("class","legend-label").text(o["data-missing"])}(this.svg,this.x,this.y,this.yAxis,e,this.color,t,this.tooltip,this.translationsObj)}render(){_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"],this.resetTitle();let t=this.formatDataSet(this.alldata[this.selectedMetric]);if(this.drawSvg(t),this.selectedMetric in this.alldata&&"cases"in this.alldata[this.selectedMetric]){const t=S(this.alldata[this.selectedMetric].cases.REPORT_DATE);let e=0;t.getDay()<2&&(e=2-t.getDay()),this.updateDate=L(this.alldata[this.selectedMetric].cases.REPORT_DATE,{month:"long",day:"numeric",year:"numeric"},e)}else this.updateDate="Unknown";this.resetUpdateDate()}retrieveData(t){window.fetch(t).then((t=>t.json())).then(function(t){this.alldata=t,this.render()}.bind(this))}}window.customElements.define("cagov-chart-equity-data-completeness",P);l("cagov-chart-d3-bar h2 {\n  margin-top: 3rem; }\n\ncagov-chart-d3-bar .chart-title {\n  max-width: 633px;\n  margin: 50px auto 20px;\n  border-bottom: solid 1px; }\n\ncagov-chart-d3-bar .svg-holder {\n  max-width: 633px; }\n\ncagov-chart-d3-bar .bar-chart-label.label {\n  font-size: 1rem; }\n\ncagov-chart-d3-bar .bar-label tspan {\n  font-weight: 100;\n  font-size: 0.85rem; }\n\ncagov-chart-d3-bar .bar-label tspan.bold {\n  font-weight: bold; }\n\ncagov-chart-d3-bar .tick text {\n  font-size: 0.75rem;\n  font-weight: 600; }\n\n@media (max-width: 768px) {\n  cagov-chart-d3-bar .chart-title {\n    margin: 50px 20px 20px 20px; }\n  cagov-chart-d3-bar .tick text {\n    font-size: 0.65rem !important;\n    font-weight: 500; }\n  cagov-chart-d3-bar .xaxis-label {\n    font-size: 0.75rem !important; }\n  cagov-chart-d3-bar .label.bar-chart-label {\n    font-size: 0.75rem !important; } }\n\n@media (max-width: 520px) {\n  cagov-chart-d3-bar .tick text {\n    font-size: 0.65rem !important;\n    font-weight: 500; }\n  cagov-chart-d3-bar .bar-label tspan {\n    font-size: 0.6rem !important; }\n  cagov-chart-d3-bar .xaxis-label {\n    font-size: 0.75rem !important;\n    font-weight: 600; }\n  cagov-chart-d3-bar .label.bar-chart-label {\n    font-size: 0.75rem !important; } }\n");let I=new Map;function D(t){return t.replace(" - ","")}function M(t,e,a,i,s){return t=>t.attr("transform",`translate(0,${a-(i.bottom-5)})`).call(d3.axisBottom(s).tickFormat((t=>I.get(e[t].SOCIAL_TIER)?D(I.get(e[t].SOCIAL_TIER)):D(e[t].SOCIAL_TIER))).tickSize(0)).call((t=>t.select(".domain").remove()))}function k(t,e,a){e.selectAll("g.x-label").remove(),e.append("g").attr("class","x-label").append("text").attr("transform","translate("+t.chartBreakpointValues.width/2+" ,"+(t.chartBreakpointValues.height-10)+")").attr("class","xaxis-label").style("text-anchor","middle").text(a)}function N(t,e,a,i,s){t.append("g").selectAll(".bar-label").data(e).join((t=>{t.append("svg").attr("x",((t,e)=>a(e)+a.bandwidth()/10)).attr("y",(t=>i(t.CASE_RATE_PER_100K)-20)).html((t=>parseFloat(t.RATE_DIFF_30_DAYS)>0?`<svg class="sparkline" width="${s.width}" height="${s.height}" viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M17 0.581819V5.19326C17 5.50954 16.742 5.77116 16.4271 5.77116C16.1122 5.77116 15.8543 5.51344 15.8543 5.19326V2.00308L10.1901 7.93042C10.0839 8.03975 9.93972 8.09832 9.78419 8.09832C9.63244 8.09832 9.48828 8.03975 9.37826 7.93042L6.11944 4.64647L0.971201 9.8321C0.86118 9.94143 0.720802 10 0.565271 10C0.413518 10 0.26936 9.94143 0.15934 9.8321C0.0531121 9.72667 0 9.59001 0 9.43381C0 9.22295 0.0872582 9.09018 0.15934 9.01601L5.70966 3.42434C5.81968 3.315 5.96006 3.25643 6.11559 3.25643C6.26734 3.25643 6.4115 3.315 6.52152 3.42434L9.78035 6.70829L15.0158 1.1558H11.8403C11.5254 1.1558 11.2674 0.898078 11.2674 0.5779C11.2674 0.26162 11.5254 0 11.8403 0H16.4233C16.742 0.00390471 17 0.261621 17 0.581819H17Z" fill="#003D9D"/>\n              </svg>`:`<svg class="sparkline" width="${s.width}" height="${s.height}" viewBox="0 0 17 10" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M17 9.41818V4.80674C17 4.49046 16.742 4.22884 16.4271 4.22884C16.1122 4.22884 15.8543 4.48656 15.8543 4.80674V7.99692L10.1901 2.06958C10.0839 1.96025 9.93972 1.90168 9.78419 1.90168C9.63244 1.90168 9.48828 1.96025 9.37826 2.06958L6.11944 5.35353L0.971201 0.167904C0.86118 0.0585697 0.720802 0 0.565271 0C0.413518 0 0.26936 0.0585717 0.15934 0.167904C0.0531121 0.273332 0 0.409992 0 0.566192C0 0.777052 0.0872582 0.909822 0.15934 0.983993L5.70966 6.57566C5.81968 6.685 5.96006 6.74357 6.11559 6.74357C6.26734 6.74357 6.4115 6.685 6.52152 6.57566L9.78035 3.29171L15.0158 8.8442H11.8403C11.5254 8.8442 11.2674 9.10192 11.2674 9.4221C11.2674 9.73838 11.5254 10 11.8403 10H16.4233C16.742 9.9961 17 9.73838 17 9.41818H17Z" fill="#FF8000"/>\n              </svg>`))}))}function F(t,e,a){null!==t.querySelector(".bar-chart-yline-full")&&t.querySelector(".bar-chart-yline-full").remove(),null!==t.querySelector(".bar-chart-label")&&t.querySelector(".bar-chart-label").remove();let i=e(t.yDValue);e(a[2].CASE_RATE_PER_100K),e(a[3].CASE_RATE_PER_100K),t.chartBreakpointValues.width,t.chartBreakpointValues.margin.right;t.svg.append("path").attr("d",d3.line()([[t.chartBreakpointValues.margin.left,i],[t.chartBreakpointValues.width-t.chartBreakpointValues.margin.right,i]])).attr("stroke","#1F2574").attr("opacity",.5).style("stroke-dasharray","1,1").attr("class","label bar-chart-yline bar-chart-yline-full")}I.set("below $40K","0 - $40K"),I.set("above $120K","$120K+");class G extends window.HTMLElement{connectedCallback(){this.chartOptions={desktop:{is_mobile:!1,width:613,height:500,margin:{top:88,right:0,bottom:50,left:10},sparkline:{width:15,height:20},legend:{y:2}},tablet:{is_mobile:!1,width:500,height:450,margin:{top:88,right:0,bottom:40,left:10},sparkline:{width:15,height:20},legend:{y:2}},mobile:{is_mobile:!0,width:440,height:400,margin:{top:88,right:0,bottom:40,left:10},sparkline:{width:15,height:20},legend:{y:2}},retina:{is_mobile:!0,width:440,height:300,margin:{top:40,right:0,bottom:40,left:10},sparkline:{width:15,height:20},legend:{y:2}}},_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"];function e(t,e){return parseInt(t.SORT)-parseInt(e.SORT)}window.addEventListener("resize",(()=>{_(),this.screenDisplayType=window.charts?window.charts.displayType:"desktop",this.chartBreakpointValues=this.chartOptions[this.screenDisplayType?this.screenDisplayType:"desktop"]})),this.translationsObj=b(this),this.svg=d3.create("svg").attr("viewBox",[0,0,this.chartBreakpointValues.width,this.chartBreakpointValues.height]).attr("class","equity-bar-chart"),Promise.all([window.fetch(t+"/equitydash/social-data-income.json"),window.fetch(t+"/equitydash/social-data-crowding.json"),window.fetch(t+"/equitydash/social-data-insurance.json")]).then((function(t){return Promise.all(t.map((function(t){return t.json()})))})).then(function(t){let a=t[0],s=t[1],n=t[2];a.sort(e).reverse(),s.sort(e).reverse(),n.sort(e).reverse();let r=L(a[0].DATE,{month:"long",day:"numeric",year:"numeric"},1),l=d3.scaleLinear().domain([0,d3.max(a,(t=>t.CASE_RATE_PER_100K))]).nice().range([this.chartBreakpointValues.height-this.chartBreakpointValues.margin.bottom,this.chartBreakpointValues.margin.top]),o=d3.scaleBand().domain(d3.range(a.length)).range([this.chartBreakpointValues.margin.left,this.chartBreakpointValues.width-this.chartBreakpointValues.margin.right]).padding(this.chartBreakpointValues.is_mobile?.02:.1);this.innerHTML=function(t){let e="data-source"in t?t["data-source"]:"";return`<div class="py-2 bg-lightblue full-bleed px-4">\n    <div class="container">\n    <div class="row">\n    <div class="container col-lg-10 mx-auto">\n    <h2 class="text-center" id="factors">${t.sectionTitle}</h2>\n    <p>${t.sectionDescription}</p>\n    <div class="col-lg-12 bg-white px-3 py-4">\n        <div class="d-flex flex-column flex-md-row justify-content-center mt-3">\n          <div class="large-tabs">\n              <button class="large-tab active js-toggle-group income">${t.chartButtonIncome}</button>\n              <button class="large-tab js-toggle-group housing">${t.chartButtonHousing}</button>\n              <button class="large-tab js-toggle-group healthcare">${t.chartButtonHealthcare}</button>\n          </div>\n        </div>\n        <div class="row">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto px-0">\n              <div class="chart-title">${t.chartTitleIncome}</div>\n              <div class="svg-holder">\n                <div class="tooltip-container">an empty tooltip</div>\n              </div>\n            </div>\n        </div>\n        <div class="row d-flex justify-content-md-center">\n          <div class="col-lg-9 col-md-9 col-sm-12 mx-auto">\n\n            <div class="mt-4">\n              ${e}\n            </div>\n  \n            <div class="wp-block-cgb-block-chart-drawer js-qa-exclude"><cagov-accordion class="chart-drawer">\n            <div class="card"><button class="card-header accordion-alpha" type="button" aria-expanded="false"><div class="plus-munus"><cagov-plus></cagov-plus><cagov-minus></cagov-minus></div>\n            <div class="accordion-title js-qa-exclude">Chart information</div></button><div class="card-container" aria-hidden="true"><div class="card-body">\n          \n              <p class="small-text">${t.footnote}</p>\n  \n            </div></div></div>\n            </cagov-accordion></div>\n                \n          </div>\n        </div>\n    </div>\x3c!--END col-12--\x3e\n  </div>\x3c!--END CONTAINER--\x3e\n  </div> \x3c!-- row --\x3e\n  </div> \x3c!-- container --\x3e\n</div>\x3c!--END BG lightblue--\x3e`}(this.translationsObj),this.querySelectorAll('span[data-replacement="d3-bar-report-date"]').forEach((t=>{t.innerHTML=r})),this.tooltip=this.querySelector(".tooltip-container"),function(t,e,a,i,s,n,r){e.append("g").attr("fill","#92C5DE").attr("class","barshere").selectAll("rect").data(a).enter().append("rect").attr("x",((t,e)=>i(e))).attr("y",(t=>s(t.CASE_RATE_PER_100K))).attr("height",(t=>s(0)-s(t.CASE_RATE_PER_100K))).attr("width",i.bandwidth()).attr("id",((t,e)=>"barid-"+e)).attr("tabindex","0").attr("aria-label",((e,a)=>`${t.ariaLabel(e)}`)).on("mouseover focus",(function(e,a,s){if(d3.select(this).style("fill","#003D9D"),null!==r){r.style.top="50%";let e=this.id.replace("barid-",""),s=i(e)/n,l=document.querySelector(".svg-holder .equity-bar-chart").getBoundingClientRect().width,o=parseInt(s*l)-70;r.style.left=parseInt(o)+"px",r.innerHTML=`<div class="chart-tooltip chart-tooltip-desc">${t.tooltipCaption(a)}</div>`,r.style.visibility="visible"}})).on("mouseout blur",(function(t){d3.select(this).style("fill","#92C5DE"),null!==r&&(r.style.visibility="hidden")}))}(this,this.svg,a,o,l,this.chartBreakpointValues.width,this.tooltip),function(t,e,a,i,s,n){e.append("g").attr("class","bar-label-group").selectAll(".bar-label").data(a).join((t=>{t.append("text").attr("class","bar-label").attr("x",((t,e)=>i(e)+i.bandwidth()/2)).attr("y",(t=>s(t.CASE_RATE_PER_100K)-5)).attr("width",i.bandwidth()/4).html((t=>`<tspan class="bold" dx="-1.25em" dy="-1.2em">${t.CASE_RATE_PER_100K.toFixed(1)}</tspan>\n            <tspan dx="-1.5em" dy="1.2em">${parseFloat(t.RATE_DIFF_30_DAYS).toFixed(1)}%</tspan>`)).attr("text-anchor","middle")})),N(e,a,i,s,n)}(0,this.svg,a,o,l,this.chartBreakpointValues.sparkline);let c=M(0,a,this.chartBreakpointValues.height,this.chartBreakpointValues.margin,o);k(this,this.svg,this.translationsObj.xAxisTitleIncome),this.svg.append("g").attr("class","xaxis").call(c);let h=a[0].STATE_CASE_RATE_PER_100K;this.yDValue=h,F(this,l,a),function(t,e,a,i,s){let n=e.append("g").attr("class","legend");n.selectAll("rect").data(a).enter().append("rect").attr("x",30).attr("y",0).attr("width",15).attr("height",15).attr("fill","#92C5DE"),n.selectAll("text").data(a).enter().append("text").text(a[0]).attr("class","legend-label").attr("x",50).attr("y",s.y).attr("text-anchor","start").attr("dominant-baseline","hanging");let r=t.chartBreakpointValues.width/2;n.append("line").attr("x1",r).attr("y1",7.5).attr("x2",r+15).attr("y2",7.5).attr("stroke","#1F2574").attr("opacity",.5).style("stroke-dasharray","1, 1").attr("class","label bar-chart-yline"),n.append("text").text(`${t.translationsObj.statewideCaseRate} ${T(t.yDValue,{format:"number",min_decimals:1})}`).attr("class","legend-label").attr("x",r+20).attr("y",s.y).attr("text-anchor","start").attr("dominant-baseline","hanging")}(this,this.svg,[this.translationsObj.casesPer100KPeople],this.chartBreakpointValues.width,this.chartBreakpointValues.legend),this.querySelector(".svg-holder").appendChild(this.svg.node()),this.applyListeners(this.svg,o,l,this.chartBreakpointValues.height,this.chartBreakpointValues.margin,c,a,s,n,this.chartBreakpointValues),this.classList.remove("d-none"),document.dispatchEvent(new window.CustomEvent("setup-sd-tab-tracking")),i(this)}.bind(this))}ariaLabel(t){return this.translationsObj.ariaBarLabel.replace("placeholderCaseRate",T(t.CASE_RATE_PER_100K,{format:"number",min_decimals:1})).replace("placeholderRateDiff30",parseFloat(t.RATE_DIFF_30_DAYS).toFixed(1)+"%")}tooltipCaption(t){return this.translationsObj.tooltipCaption.replace("placeholderCaseRate",T(t.CASE_RATE_PER_100K,{format:"number",min_decimals:1})).replace("placeholderRateDiff30",parseFloat(t.RATE_DIFF_30_DAYS).toFixed(1)+"%")}applyListeners(t,e,a,i,s,n,r,l,o,c){let h=this.querySelectorAll(".js-toggle-group"),d=this,p=[{nom:"income",data:r,tranHTML:d.translationsObj.chartTitleIncome,xAxisLabel:d.translationsObj.xAxisTitleIncome},{nom:"healthcare",data:o,tranHTML:d.translationsObj.chartTitleHealthcare,xAxisLabel:d.translationsObj.xAxisTitleHealthcare},{nom:"housing",data:l,tranHTML:d.translationsObj.chartTitleHousing,xAxisLabel:d.translationsObj.xAxisTitleHousing}];h.forEach((i=>{i.addEventListener("click",(function(s){s.preventDefault(),p.forEach((i=>{if(this.classList.contains(i.nom)){const s=new window.CustomEvent("tab-select",{detail:{tab_selected:i.nom}});window.dispatchEvent(s),function(i,s){a=d3.scaleLinear().domain([0,d3.max(s,(t=>t.CASE_RATE_PER_100K))]).nice().range([c.height-c.margin.bottom,c.margin.top]),function(t,e,a,i,s){e.selectAll(".barshere rect").data(a).transition().duration(300).attr("x",((t,e)=>i(e))).attr("y",(t=>s(t.CASE_RATE_PER_100K))).attr("height",(t=>s(0)-s(t.CASE_RATE_PER_100K))).attr("aria-label",((e,a)=>`${t.ariaLabel(e)}`))}(i,t,s,e,a),function(t,e,a,i,s,n){e.selectAll("text.bar-label").data(a).attr("x",((t,e)=>i(e)+i.bandwidth()/2)).attr("y",(t=>s(t.CASE_RATE_PER_100K)-5)).attr("width",i.bandwidth()/4).html((t=>`<tspan class="bold" dx="-1.25em" dy="-1.2em">${T(t.CASE_RATE_PER_100K,{format:"number"})}</tspan>\n      <tspan dx="-1.5em" dy="1.2em">${parseFloat(t.RATE_DIFF_30_DAYS).toFixed(1)}%</tspan>`)).attr("text-anchor","middle"),e.selectAll(".sparkline").remove(),N(e,a,i,s,n)}(0,t,s,e,a,c.sparkline),n=M(0,s,c.height,c.margin,e),t.selectAll(".xaxis").call(n),F(i,a,s)}(d,i.data),d.querySelector(".chart-title").innerHTML=i.tranHTML,k(d,d.svg,i.xAxisLabel)}})),h.forEach((t=>{t.classList.remove("active")})),i.classList.add("active")}))}))}}window.customElements.define("cagov-chart-d3-bar",G);l("");class H extends window.HTMLElement{connectedCallback(){let t="";this.querySelectorAll("a").forEach((function(e,a){var i,s;t+=(i=e.getAttribute("href"),s=e.innerText,'\n<article class="faq-item trigger">    \n<a class="faq-item-link cwdsarrow-parent" href="'+i+'">\n<h4 class="faq-item-headline">'+s+'</h4>\n<cwds-arrow data-class-prefix="faq" data-class-list="cwdsarrow-size-sm cwdsarrow-idle-orange cwdsarrow-hover-darkblue cwdsarrow-focus-darkblue"></cwds-arrow>\n</a>\n</article>\n')})),this.innerHTML=t}}window.customElements.define("learn-more-links",H);
