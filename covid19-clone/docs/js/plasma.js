class t{constructor(t){let e={label:"Unknown data",value:"Unknown data"};"string"==typeof t?e={label:t,value:t}:Array.isArray(t)?e={label:t[0],value:t[1]}:"object"==typeof t&&("label"in t||"value"in t)&&(e=t),this.label=e.label||e.value,this.value=e.value,"userData"in e&&(this.userData=e.userData)}get length(){return this.label.length}toString(){return`${this.label}`}valueOf(){return this.toString()}}class e{constructor(t,s){e.all=[];const i=this;e.count=(e.count||0)+1,this.count=e.count,this.isOpened=!1,this.input=e.query(t),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-owns",`awesomplete_list_${this.count}`),this.input.setAttribute("role","combobox"),this.options=s||{},this.configure({minChars:2,maxItems:10,autoFirst:!1,data:e.DATA,filter:e.FILTER_CONTAINS,sort:!1!==s.sort&&e.SORT_BYLENGTH,container:e.CONTAINER,item:e.ITEM,replace:e.REPLACE,tabSelect:!1},s),this.index=-1,this.container=this.container(t),this.ul=e.create("ul",{hidden:"hidden",role:"listbox",id:`awesomplete_list_${this.count}`,inside:this.container}),this.status=e.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-atomic":!0,inside:this.container,textContent:0!==this.minChars?`Type ${this.minChars} or more characters for results.`:"Begin typing for results."}),this.events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown(t){const e=t.keyCode;i.opened&&(13===e&&i.selected?(t.preventDefault(),t.stopImmediatePropagation(),i.select()):9===e&&i.selected&&i.tabSelect?i.select():27===e?i.close({reason:"esc"}):38!==e&&40!==e||(t.preventDefault(),i[38===e?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown(t){t.preventDefault()},click(t){let e=t.target;if(e!==this){for(;e&&!/li/i.test(e.nodeName);)e=e.parentNode;e&&0===t.button&&(t.preventDefault(),i.select(e,t.target))}}}},e.bind(this.input,this.events.input),e.bind(this.input.form,this.events.form),e.bind(this.ul,this.events.ul),this.input.hasAttribute("list")?(this.list=`#${this.input.getAttribute("list")}`,this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||s.list||[],e.all.push(this)}configure(t,e){Object.keys(t).forEach((s=>{const i=t[s],n=this.input.getAttribute(`data-${s.toLowerCase()}`);this[s]="number"==typeof i?parseInt(n,10):!1===i?null!==n:i instanceof Function?null:n,this[s]||0===this[s]||(this[s]=s in e?e[s]:i)}))}set list(t){if(Array.isArray(t))this.dataList=t;else if("string"==typeof t&&t.indexOf(",")>-1)this.dataList=t.split(/\s*,\s*/);else{const s=e.query(t);if(s&&s.children){const t=[],e=e=>{if(!e.disabled){const s=e.textContent.trim(),i=e.value||s,n=e.label||s;""!==i&&t.push({label:n,value:i})}};Array.prototype.slice.apply(s.children).forEach(e),this.dataList=t}}document.activeElement===this.input&&this.evaluate()}get list(){return this.dataList}get selected(){return this.index>-1}get opened(){return this.isOpened}close(t){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,this.status.setAttribute("hidden",""),e.fire(this.input,"awesomplete-close",t||{}))}open(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.status.removeAttribute("hidden"),this.autoFirst&&-1===this.index&&this.goto(0),e.fire(this.input,"awesomplete-open")}destroy(){if(e.unbind(this.input,this.events.input),e.unbind(this.input.form,this.events.form),!this.options.container){const{parentNode:t}=this.container;t.insertBefore(this.input,this.container),t.removeChild(this.container)}this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");const t=e.all.indexOf(this);-1!==t&&e.all.splice(t,1)}next(){const t=this.ul.children.length;let e=0;e=this.index<t-1?this.index+1:t?0:-1,this.goto(e)}previous(){const t=this.ul.children.length,e=this.index-1;this.goto(this.selected&&-1!==e?e:t-1)}goto(t){const s=this.ul.children;if(this.selected&&s[this.index].setAttribute("aria-selected","false"),this.index=t,t>-1&&s.length>0){s[t].setAttribute("aria-selected","true"),this.status.textContent=`${s[t].textContent}, list item ${t+1} of ${s.length}`,this.input.setAttribute("aria-activedescendant",`${this.ul.id}_item_${this.index}`),this.ul.scrollTop=s[t].offsetTop-this.ul.clientHeight+s[t].clientHeight;const i=this.suggestions[this.index];e.fire(this.input,"awesomplete-highlight",{selectedIndex:this.index,selectedText:`${i}`,selectedSuggestion:i})}}select(t,s){let i=t;if(t?this.index=e.siblingIndex(t):i=this.ul.children[this.index],i){const t=this.index,n=this.suggestions[t];e.fire(this.input,"awesomplete-select",{selectedIndex:t,selectedText:`${n}`,selectedSuggestion:n,origin:s||i})&&(this.replace(n),this.close({reason:"select"}),e.fire(this.input,"awesomplete-selectcomplete",{selectedIndex:t,selectedText:`${n}`,selectedSuggestion:n}))}}evaluate(){const e=this,{value:s}=this.input;if(s.length>=this.minChars&&this.dataList&&this.dataList.length>0){this.index=-1,this.ul.innerHTML="";const i=i=>new t(e.data(i,s)),n=t=>e.filter(t,s);this.suggestions=this.dataList.map(i).filter(n),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems);const a=(t,i)=>{e.ul.appendChild(e.item(t,s,i))};this.suggestions.forEach(a),0===this.ul.children.length?(this.status.textContent="No results found",this.close({reason:"nomatches"})):(this.open(),this.status.textContent=`${this.ul.children.length} results found`)}else this.close({reason:"nomatches"}),this.status.textContent="No results found"}static FILTER_CONTAINS(t,s){return RegExp(e.regExpEscape(s.trim()),"i").test(t)}static FILTER_STARTSWITH(t,s){return RegExp(`^${e.regExpEscape(s.trim())}`,"i").test(t)}static SORT_BYLENGTH(t,e){return t.length!==e.length?t.length-e.length:t<e?-1:1}static CONTAINER(t){return e.create("div",{className:"awesomplete",around:t})}static ITEM(t,s,i){const n=""===s.trim()?t:`${t}`.replace(RegExp(e.regExpEscape(s.trim()),"gi"),"<mark>$&</mark>");return e.create("li",{innerHTML:n,"aria-selected":"false",id:`awesomplete_list_${this.count}_item_${i}`})}static REPLACE(t){this.input.value=t.value||t.label}static DATA(t){return t}static query(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}static queryAll(t,e){return Array.prototype.slice.call((e||document).querySelectorAll(t))}static create(t,s){const i=document.createElement(t);return Object.keys(s).forEach((t=>{const n=s[t];if("inside"===t)e.query(n).appendChild(i);else if("around"===t){const t=e.query(n);t.parentNode.insertBefore(i,t),i.appendChild(t),null!=t.getAttribute("autofocus")&&t.focus()}else t in i?i[t]=n:i.setAttribute(t,n)})),i}static bind(t,e){if(t){const s=s=>{const i=e[s];s.split(/\s+/).forEach((e=>{t.addEventListener(e,i)}))};Object.keys(e).forEach(s)}}static unbind(t,e){if(t){const s=s=>{const i=e[s];s.split(/\s+/).forEach((e=>{t.removeEventListener(e,i)}))};Object.keys(e).forEach(s)}}static fire(t,e,s){const i=document.createEvent("HTMLEvents"),n=t=>{i[t]=s[t]};return i.initEvent(e,!0,!0),"object"==typeof s&&Object.keys(s).forEach(n),t.dispatchEvent(i)}static regExpEscape(t){return t.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")}static siblingIndex(t){let e=0,s=t;for(;s;)s=s.previousElementSibling,s&&(e+=1);return e}}class s extends window.HTMLElement{connectedCallback(){const t=this.dataset.searchApi;let s="Please enter your county or zip code",i="Find health plan",n="Results list";this.dataset.buttonLabel&&(i=this.dataset.buttonLabel),this.dataset.label&&(s=this.dataset.label),this.dataset.listLabel&&(n=this.dataset.listLabel);let a=function(t,e){return`<form class="form-inline form-inline-left js-cagov-lookup">\n  <div class="form-group">\n    <label for="location-query"\n      >${t}:</label\n    >\n    <div class="awesomplete">\n      <div class="awesomplete">\n        <input\n          aria-expanded="false"\n          aria-owns="awesomplete_list_1"\n          autocomplete="off"\n          class="city-search form-control"\n          data-list=""\n          data-multiple=""\n          id="location-query"\n          role="combobox"\n          type="text"\n        />\n        <span\n          class="visually-hidden"\n          role="status"\n          aria-live="assertive"\n          aria-atomic="true"\n          >Type 2 or more characters for results.</span\n        >\n      </div>\n      <span\n        class="visually-hidden"\n        aria-atomic="true"\n        aria-live="assertive"\n        role="status"\n        >Type 2 or more characters for results.</span\n      >\n    </div>\n    <button class="btn btn-primary" type="submit">${e}</button>\n    <div class="invalid-feedback">\n      Please enter a county or zip code in California.\n    </div>\n  </div>\n  </form>`}(s,i);this.innerHTML=a;const o="input[data-multiple]";let l=this;const r={autoFirst:!0,listLabel:n,filter:function(t,s){return e.FILTER_CONTAINS(t,s.match(/[^,]*$/)[0])},item:function(t,s){return document.querySelector(".invalid-feedback").style.display="none",document.querySelector(".city-search").classList.remove("is-invalid"),e.ITEM(t,s.match(/[^,]*$/)[0])},replace:function(t){let e=this.input.value.match(/^.+,\s*|/)[0]+t;this.input.value=e,l.dispatchEvent(new CustomEvent("showResults",{detail:e}))}},c=new e(o,r);document.querySelector(o).addEventListener("keyup",(e=>{const s=[13,9,27,38,40];if(e.target.value.length>=2&&-1===s.indexOf(e.keyCode)){let s=e.target.value;window.lookup=s;const i=`${t}${s}`;window.fetch(i).then((t=>t.json())).then((t=>{c.list=t.match.map((t=>t))})).catch((()=>{}))}})),document.querySelector(".js-cagov-lookup").addEventListener("submit",(t=>{t.preventDefault(),document.querySelector(".invalid-feedback").style.display="none",document.querySelector(".city-search").classList.remove("is-invalid");let e=this.querySelector("input").value;this.dispatchEvent(new CustomEvent("showResults",{detail:e}))}))}}function i(t,e,s){-1===t.toLowerCase().indexOf("county")&&(t+=" County");let i=`Showing plasma donation locations in ${t}.`;s&&(i=`${e} is in ${t}, showing plasma donation locations in ${t}.`),window.fetch("https://api.alpha.ca.gov/PlasmaDonate/"+t.replace(" County","")).then((t=>t.json())).then((t=>{let e='There does not appear to be a donation center in this county. You could either type in a neighboring county into the search or view more current listings at <a href="http://www.aabb.org/tm/donation/Pages/Blood-Bank-Locator.aspx">http://www.aabb.org/tm/donation/Pages/Blood-Bank-Locator.aspx</a>.';t.length>0&&t[0].Name&&(e=`\n        <h3>${i}</h3>\n        <div class="pt-5 js-provider-list">\n          ${t.map((t=>`\n              <div class="card">\n                <div class="card-header card-header-multi">\n                  <span class="bold">${t.Name}</span>\n                </div>\n                <div class="card-body">\n                  <div class="card-text">\n\n                    <p>\n                      ${""!=t.Address1?`${t.Address1}<br>`:""}\n                      ${t.Address2?`${t.Address2}<br>`:""}\n                      ${""!=t.CityStateZip?`${t.CityStateZip}`:""}\n                    </p>\n                    ${t.Contact?`<p><a href="tel:${t.Contact}">${t.Contact}</a></p>`:""}                   \n                    ${t.Website?`<p><a href="${t.Website}" class="action-link mr-3">Visit website</a></p>`:""}\n                  </div>\n                </div>\n              </div>\n            `)).join(" ")}\n        </div>\n      `),document.querySelector(".js-plasma-providers").innerHTML=e})).catch((t=>{n()}))}function n(){document.querySelector(".invalid-feedback").style.display="block"}window.customElements.define("cwds-lookup",s),document.querySelector("cwds-lookup")&&document.querySelector("cwds-lookup").addEventListener("showResults",(t=>{!function(t){let e=!1;if(t.match(/^\d+$/)){e=!0;let s=`https://api.alpha.ca.gov/countyfromzip/${t}`;window.fetch(s).then((t=>t.json())).then((s=>{i(s[0].county,t,e)})).catch((()=>{n()}))}else i(t,t,e)}(t.detail)}));
